!function(e){"use strict";function t(e,t){return(Math.abs(e.r-t.r)+Math.abs(e.g-t.g)+Math.abs(e.b-t.b))/3}var n=1,r={red:255,green:0,blue:255,alpha:255},i={flat:function(e,t){return{r:r.red,g:r.green,b:r.blue,a:r.alpha}},movement:function(e,t){return{r:(t.r*(r.red/255)+r.red)/2,g:(t.g*(r.green/255)+r.green)/2,b:(t.b*(r.blue/255)+r.blue)/2,a:t.a}},flatDifferenceIntensity:function(e,n){return{r:r.red,g:r.green,b:r.blue,a:t(e,n)}},movementDifferenceIntensity:function(e,n){var i=t(e,n)/255*.8;return{r:(1-i)*n.r*(r.red/255)+i*r.red,g:(1-i)*n.g*(r.green/255)+i*r.green,b:(1-i)*n.b*(r.blue/255)+i*r.blue,a:n.a}}},a=i.flat,o=1200,h=/^https?:\/\//,u="undefined"!=typeof window?window.document:{},f=new RegExp("^https?://"+u.domain);e.resemble=function(e){function t(){var e,t=A.length;for(e=0;t>e;e++)"function"==typeof A[e]&&A[e](E)}function r(e,t,n){var r,i;for(r=0;e>r;r++)for(i=0;t>i;i++)n(r,i)}function i(e,n,i){var a=0,o=0,h=0,u=0,f=0;r(i,n,function(t,r){var i=4*(t*n+r),s=e[i],g=e[i+1],l=e[i+2],d=c(s,g,l);a++,o+=s/255*100,h+=g/255*100,u+=l/255*100,f+=d/255*100}),E.red=Math.floor(o/a),E.green=Math.floor(h/a),E.blue=Math.floor(u/a),E.brightness=Math.floor(f/a),t()}function s(e,t){var n,r=new Image;h.test(e)&&!f.test(e)&&r.setAttribute("crossorigin","anonymous"),r.onload=function(){var e,n=u.createElement("canvas"),i=r.width,a=r.height;n.width=i,n.height=a,n.getContext("2d").drawImage(r,0,0,i,a),e=n.getContext("2d").getImageData(0,0,i,a),N.push(e),t(e,i,a)},"string"==typeof e?(r.src=e,r.complete&&r.onload()):"undefined"!=typeof e.data&&"number"==typeof e.width&&"number"==typeof e.height?(N.push(e),t(e,e.width,e.height)):(n=new FileReader,n.onload=function(e){r.src=e.target.result},n.readAsDataURL(e))}function g(e,t,n){var r=Math.abs(e-t);return"undefined"==typeof e?!1:"undefined"==typeof t?!1:e===t?!0:r<U[n]?!0:!1}function l(e,t){var n=g(e.a,t.a,"alpha"),r=g(e.brightness,t.brightness,"minBrightness");return r&&n}function c(e,t,n){return.3*e+.59*t+.11*n}function d(e,t){var n=e.r===t.r,r=e.g===t.g,i=e.b===t.b;return n&&r&&i}function m(e,t){var n=g(e.r,t.r,"red"),r=g(e.g,t.g,"green"),i=g(e.b,t.b,"blue"),a=g(e.a,t.a,"alpha");return n&&r&&i&&a}function b(e,t){return Math.abs(e.brightness-t.brightness)>U.maxBrightness}function p(e,t,n){e/=255,t/=255,n/=255;var r,i,a=Math.max(e,t,n),o=Math.min(e,t,n);if(a==o)r=0;else{switch(i=a-o,a){case e:r=(t-n)/i+(n>t?6:0);break;case t:r=(n-e)/i+2;break;case n:r=(e-t)/i+4}r/=6}return r}function v(e,t,n,r,i,a){var o,h,u,f,s=1,g=0,l=0,c=0;for(B(e),u=-1*s;s>=u;u++)for(f=-1*s;s>=f;f++)if(0===u&&0===f);else{if(o=4*((r+f)*a+(i+u)),h=M(t,o,n),null===h)continue;if(D(h),B(h),b(e,h)&&g++,d(e,h)&&c++,Math.abs(h.h-e.h)>.3&&l++,l>1||g>1)return!0}return 2>c?!0:!1}function w(e,t,n,r){var i=a(n,r);e[t]=i.r,e[t+1]=i.g,e[t+2]=i.b,e[t+3]=i.a}function y(e,t,r){e[t]=r.r,e[t+1]=r.g,e[t+2]=r.b,e[t+3]=r.a*n}function x(e,t,r){e[t]=r.brightness,e[t+1]=r.brightness,e[t+2]=r.brightness,e[t+3]=r.a*n}function M(e,t,n){var r,i,a,o,h;return r=e[t],"undefined"!=typeof r?(i=e[t+1],a=e[t+2],h=e[t+3],o={r:r,g:i,b:a,a:h}):null}function D(e){e.brightness=c(e.r,e.g,e.b)}function B(e){e.h=p(e.r,e.g,e.b)}function I(e,t,n,i){var a=u.createElement("canvas"),h=e.data,f=t.data;a.width=n,a.height=i;var s,g=a.getContext("2d"),c=g.createImageData(n,i),d=c.data,b=0,p={top:i,left:n,bottom:0,right:0},B=function(e,t){p.left=Math.min(e,p.left),p.right=Math.max(e,p.right),p.top=Math.min(t,p.top),p.bottom=Math.max(t,p.bottom)},I=Date.now();o&&k&&(n>o||i>o)&&(s=6),r(i,n,function(e,t){if(!s||e%s!==0&&t%s!==0){var r=4*(e*n+t),i=M(h,r,1),a=M(f,r,2);if(null!==i&&null!==a)return F?(D(i),D(a),void(l(i,a)?x(d,r,a):(w(d,r,i,a),b++,B(t,e)))):void(m(i,a)?y(d,r,i,a):k&&(D(i),D(a),v(i,h,1,e,t,n)||v(a,f,2,e,t,n))&&l(i,a)?x(d,r,a):(w(d,r,i,a),b++,B(t,e)))}}),E.misMatchPercentage=(b/(i*n)*100).toFixed(2),E.diffBounds=p,E.analysisTime=Date.now()-I,E.getImageDataUrl=function(e){var t=0;return e&&(t=C(e,g,a)),g.putImageData(c,0,t),a.toDataURL("image/png")}}function C(e,t,n){var r=2;t.font="12px sans-serif";var i=t.measureText(e).width+2*r,a=22;return i>n.width&&(n.width=i),n.height+=a,t.fillStyle="#666",t.fillRect(0,0,n.width,a-4),t.fillStyle="#fff",t.fillRect(0,a-4,n.width,4),t.fillStyle="#fff",t.textBaseline="top",t.font="12px sans-serif",t.fillText(e,r,1),a}function T(e,t,n){var r,i;return e.height<n||e.width<t?(r=u.createElement("canvas"),r.width=t,r.height=n,i=r.getContext("2d"),i.putImageData(e,0,0),i.getImageData(0,0,t,n)):e}function R(e,n){function r(){var e,n;2===N.length&&(e=N[0].width>N[1].width?N[0].width:N[1].width,n=N[0].height>N[1].height?N[0].height:N[1].height,N[0].width===N[1].width&&N[0].height===N[1].height?E.isSameDimensions=!0:E.isSameDimensions=!1,E.dimensionDifference={width:N[0].width-N[1].width,height:N[0].height-N[1].height},I(T(N[0],e,n),T(N[1],e,n),e,n),t())}N=[],s(e,r),s(n,r)}function S(t){var n,r="function"==typeof t;r||(n=t);var i={ignoreNothing:function(){return U.red=16,U.green=16,U.blue=16,U.alpha=16,U.minBrightness=16,U.maxBrightness=240,k=!1,F=!1,r&&t(),i},ignoreAntialiasing:function(){return U.red=32,U.green=32,U.blue=32,U.alpha=32,U.minBrightness=64,U.maxBrightness=96,k=!0,F=!1,r&&t(),i},ignoreColors:function(){return U.alpha=16,U.minBrightness=16,U.maxBrightness=240,k=!1,F=!0,r&&t(),i},repaint:function(){return r&&t(),i},onComplete:function(t){A.push(t);var r=function(){R(e,n)};return r(),S(r)}};return i}var E={},N=[],A=[],U={red:16,green:16,blue:16,alpha:16,minBrightness:16,maxBrightness:240},k=!1,F=!1;return{onComplete:function(t){A.push(t),s(e,function(e,t,n){i(e.data,t,n)})},compareTo:function(e){return S(e)}}},e.resemble.outputSettings=function(e){var t,h;if(e.errorColor)for(t in e.errorColor)r[t]=e.errorColor[t]===h?r[t]:e.errorColor[t];return e.errorType&&i[e.errorType]&&(a=i[e.errorType]),n=isNaN(Number(e.transparency))?n:e.transparency,e.largeImageThreshold!==h&&(o=e.largeImageThreshold),this}}(this);
