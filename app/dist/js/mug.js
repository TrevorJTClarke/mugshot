var MUG=angular.module("mugshot",[]);MUG.controller("MainCtrl",["$rootScope","$scope","Config","$http",function(n,e,r,t){}]),MUG.directive("fadeIn",[function(){return{restrict:"A",link:function(n,e,r){var t=parseInt(r.fadeIn)||10;e.addClass("fade-in"),setTimeout(function(){e.css("opacity","1")},t)}}}]),MUG.directive("msgCenter",["$rootScope","$timeout","$compile",function(n,e,r){return{scope:{},link:function(t,i,o,a){function s(n){var i=+new Date,o=n.msg,a=n.icon?n.icon:v,s=l.replace("BODY",o).replace("ICON",a),p=r(s)(t);p[0].id=i,g=i,m.append(p);var h=m.find("#"+i);c(h,n.type),n.callback&&h.find(".msg-action").addClass("show"),e(function(){h.addClass("add")},20),d=e(function(){u(h)},f)}function u(n){if(!n&&g)n=m.find("#"+g);else if(!n)return;n.removeClass("add"),n.addClass("remove"),e(function(){angular.element(n).remove()},300)}function c(n,e){n.removeClass("msg-info"),n.removeClass("msg-warn"),e&&n.addClass("msg-"+e)}var d,l='<div class="msg" ng-click="action()"><div class="msg-icn"><i class="iw i-ICON"></i></div><div class="msg-cont">BODY</div><div class="msg-action"><i class="ib i-r-arrow"></i></div></div>',m=angular.element(i),f=5e3,g="",v="info";t.body="",t.callback=null,t.icon=v,t.action=function(){var n=m.find("#"+this.id);t.callback(),u(n)},n.$on("MSGCENTER:FIRE",function(n,e){e.msg&&(window.clearTimeout(d),u(),e.dur&&(f=1e3*e.dur),e.callback&&(t.callback=e.callback),s(e))})}}}]),MUG.directive("timeAgo",["timeAgoService","nowTimeService",function(n,e){return{restrict:"EA",link:function(r,t,i){var o;i.$observe("fromTime",function(e){o=n.parse(e)}),r.$watch(function(){return e.getTime()-o},function(e){angular.element(t).text(n.inWords(e))})}}}]),MUG.factory("nowTime",["$timeout",function(n){var e=Date.now(),r=function(){n(function(){e=Date.now(),r()},1e3)};return r(),{getTime:function(){return e}}}]),MUG.factory("timeAgo",function(){function n(n){var e=n.toString().slice(0,13);return 13==e.length?parseInt(e):n}var e={};return e.settings={refreshMillis:6e4,allowFuture:!1,strings:{prefixAgo:null,prefixFromNow:null,suffixAgo:"ago",suffixFromNow:"from now",seconds:"less than a minute",minute:"about a minute",minutes:"%d minutes",hour:"about an hour",hours:"%d hours",day:"a day",days:"%d days",month:"about a month",months:"%d months",year:"about a year",years:"%d years",numbers:[]}},e.inWords=function(n){function r(e,r){var i=angular.isFunction(e)?e(r,n):e,o=t.numbers&&t.numbers[r]||r;return i.replace(/%d/i,o)}var t=e.settings.strings,i=t.prefixAgo,o=t.suffixAgo;e.settings.allowFuture&&0>n&&(i=t.prefixFromNow,o=t.suffixFromNow);var a=Math.abs(n)/1e3,s=a/60,u=s/60,c=u/24,d=c/365,l=45>a&&r(t.seconds,Math.round(a))||90>a&&r(t.minute,1)||45>s&&r(t.minutes,Math.round(s))||90>s&&r(t.hour,1)||24>u&&r(t.hours,Math.round(u))||42>u&&r(t.day,1)||30>c&&r(t.days,Math.round(c))||45>c&&r(t.month,1)||365>c&&r(t.months,Math.round(c/30))||1.5>d&&r(t.year,1)||r(t.years,Math.round(d)),m=void 0===t.wordSeparator?" ":t.wordSeparator;return[i,l,o].join(m).trim()},e.parse=function(e){if(angular.isNumber(e)){e+="";var r=n(e);return parseInt(r,10)}var t=(e||"").trim();return t=t.replace(/\.\d+/,""),t=t.replace(/-/,"/").replace(/-/,"/"),t=t.replace(/T/," ").replace(/Z/," UTC"),t=t.replace(/([\+\-]\d\d)\:?(\d\d)/," $1$2"),new Date(t)},e}),MUG.filter("timeAgo",["nowTime","timeAgo",function(n,e){return function(r){var t=e.parse(r),i=n.getTime()-t;return e.inWords(i)}}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsIm1haW5jdHJsLmpzIiwiZmFkZWluLmpzIiwibXNnY2VudGVyLmpzIiwidGltZWFnby5qcyIsIm5vd3RpbWUuanMiLCJ0aW1lLWFnby5qcyJdLCJuYW1lcyI6WyJNVUciLCJhbmd1bGFyIiwibW9kdWxlIiwiY29udHJvbGxlciIsIiRyb290U2NvcGUiLCIkc2NvcGUiLCJDb25maWciLCIkaHR0cCIsImRpcmVjdGl2ZSIsInJlc3RyaWN0IiwibGluayIsInNjb3BlIiwiZWxlbSIsImF0dHJzIiwib2Zmc2V0IiwicGFyc2VJbnQiLCJmYWRlSW4iLCJhZGRDbGFzcyIsInNldFRpbWVvdXQiLCJjc3MiLCIkdGltZW91dCIsIiRjb21waWxlIiwiZWwiLCJjdHJsIiwic2hvd01lc3NhZ2UiLCJkYXRhIiwiX2lkIiwiRGF0ZSIsIm5ld0JvZHkiLCJtc2ciLCJuZXdJY24iLCJpY29uIiwiZGVmYXVsdEljb24iLCJ0ZW1wbGF0ZSIsIm1zZ1RlbXBsYXRlIiwicmVwbGFjZSIsIm5ld01lc3NhZ2UiLCJpZCIsInByZXZpb3VzSWQiLCJfZWwiLCJhcHBlbmQiLCJtc2dFbCIsImZpbmQiLCJjaGFuZ2VUeXBlIiwidHlwZSIsImNhbGxiYWNrIiwidGltZXIiLCJjbGVhckVsIiwiZHVyYXRpb24iLCJyZW1vdmVDbGFzcyIsImVsZW1lbnQiLCJyZW1vdmUiLCJib2R5IiwiYWN0aW9uIiwiYWN0aW9uRWwiLCJ0aGlzIiwiJG9uIiwiZSIsIndpbmRvdyIsImNsZWFyVGltZW91dCIsImR1ciIsInRpbWVBZ28iLCJub3dUaW1lIiwiZnJvbVRpbWUiLCIkb2JzZXJ2ZSIsInZhbHVlIiwicGFyc2UiLCIkd2F0Y2giLCJnZXRUaW1lIiwidGV4dCIsImluV29yZHMiLCJmYWN0b3J5Iiwibm93IiwidXBkYXRlVGltZSIsInRyaW1EaWdpdHMiLCJudW0iLCJtIiwidG9TdHJpbmciLCJzbGljZSIsImxlbmd0aCIsInNlcnZpY2UiLCJzZXR0aW5ncyIsInJlZnJlc2hNaWxsaXMiLCJhbGxvd0Z1dHVyZSIsInN0cmluZ3MiLCJwcmVmaXhBZ28iLCJwcmVmaXhGcm9tTm93Iiwic3VmZml4QWdvIiwic3VmZml4RnJvbU5vdyIsInNlY29uZHMiLCJtaW51dGUiLCJtaW51dGVzIiwiaG91ciIsImhvdXJzIiwiZGF5IiwiZGF5cyIsIm1vbnRoIiwibW9udGhzIiwieWVhciIsInllYXJzIiwibnVtYmVycyIsImRpc3RhbmNlTWlsbGlzIiwic3Vic3RpdHV0ZSIsInN0cmluZ09yRnVuY3Rpb24iLCJudW1iZXIiLCJzdHJpbmciLCJpc0Z1bmN0aW9uIiwiJGwiLCJwcmVmaXgiLCJzdWZmaXgiLCJNYXRoIiwiYWJzIiwid29yZHMiLCJyb3VuZCIsInNlcGFyYXRvciIsInVuZGVmaW5lZCIsIndvcmRTZXBhcmF0b3IiLCJqb2luIiwidHJpbSIsImlzbzg2MDEiLCJpc051bWJlciIsIm9yaWdpbmFsVGltZXN0YW1wIiwicyIsImZpbHRlciIsImRpZmYiXSwibWFwcGluZ3MiOiJBQUFBLEdBQUFBLEtBQUFDLFFBQUFDLE9BQUEsYUNBQUYsS0FBQUcsV0FBQSxZQUNBLGFBQUEsU0FBQSxTQUFBLFFBQ0EsU0FBQUMsRUFBQUMsRUFBQUMsRUFBQUMsT0NFQVAsSUFBQVEsVUFBQSxVQUFBLFdBQ0EsT0FDQUMsU0FBQSxJQUNBQyxLQUFBLFNBQUFDLEVBQUFDLEVBQUFDLEdBQ0EsR0FBQUMsR0FBQUMsU0FBQUYsRUFBQUcsU0FBQSxFQUNBSixHQUFBSyxTQUFBLFdBRUFDLFdBQUEsV0FDQU4sRUFBQU8sSUFBQSxVQUFBLE1BQ0FMLFFDTUFkLElBQUFRLFVBQUEsYUFDQSxhQUFBLFdBQUEsV0FDQSxTQUFBSixFQUFBZ0IsRUFBQUMsR0FDQSxPQUNBVixTQUNBRCxLQUFBLFNBQUFDLEVBQUFXLEVBQUFULEVBQUFVLEdBc0JBLFFBQUFDLEdBQUFDLEdBQ0EsR0FBQUMsSUFBQSxHQUFBQyxNQUNBQyxFQUFBSCxFQUFBSSxJQUNBQyxFQUFBTCxFQUFBLEtBQUFBLEVBQUFNLEtBQUFDLEVBRUFDLEVBQUFDLEVB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LFNBQUFxRCxHQUNBLEdBQUF0SCxRQUFBdUgsU0FBQUQsR0FBQSxDQUNBQSxHQUFBLEVBRUEsSUFBQUUsR0FBQS9DLEVBQUE2QyxFQUNBLE9BQUF4RyxVQUFBMEcsRUFBQSxJQUVBLEdBQUFDLElBQUFILEdBQUEsSUFBQUQsTUFLQSxPQUpBSSxHQUFBQSxFQUFBdkYsUUFBQSxRQUFBLElBQ0F1RixFQUFBQSxFQUFBdkYsUUFBQSxJQUFBLEtBQUFBLFFBQUEsSUFBQSxLQUNBdUYsRUFBQUEsRUFBQXZGLFFBQUEsSUFBQSxLQUFBQSxRQUFBLElBQUEsUUFDQXVGLEVBQUFBLEVBQUF2RixRQUFBLHdCQUFBLFNBQ0EsR0FBQVIsTUFBQStGLElBR0ExQyxJRXRGQWhGLElBQUEySCxPQUFBLFdBQ0EsVUFBQSxVQUNBLFNBQUE3RCxFQUFBRCxHQUNBLE1BQUEsVUFBQUksR0FDQSxHQUFBRixHQUFBRixFQUFBSyxNQUFBRCxHQUNBMkQsRUFBQTlELEVBQUFNLFVBQUFMLENBQ0EsT0FBQUYsR0FBQVMsUUFBQXNEIiwiZmlsZSI6Im11Zy5qcyIsInNvdXJjZXNDb250ZW50IjpbInZhciBNVUcgPSBhbmd1bGFyLm1vZHVsZShcIm11Z3Nob3RcIiwgW10pO1xuIiwiTVVHLmNvbnRyb2xsZXIoJ01haW5DdHJsJyxcblsnJHJvb3RTY29wZScsICckc2NvcGUnLCAnQ29uZmlnJywgJyRodHRwJyxcbmZ1bmN0aW9uICgkcm9vdFNjb3BlLCAkc2NvcGUsIENvbmZpZywgJGh0dHApIHtcbiAgXG59XSk7XG4iLCIvKipcbiAqIGZhZGVJblxuICogQSBkaXJlY3RpdmUgZm9yIGFuaW1hdGluZyBpbiBlbGVtZW50c1xuICovXG5NVUcuZGlyZWN0aXZlKCdmYWRlSW4nLCBbIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICByZXN0cmljdDogJ0EnLFxuICAgICAgICBsaW5rOiBmdW5jdGlvbiAoc2NvcGUsIGVsZW0sIGF0dHJzKSB7XG4gICAgICAgICAgICB2YXIgb2Zmc2V0ID0gcGFyc2VJbnQoYXR0cnMuZmFkZUluKSB8fCAxMDtcbiAgICAgICAgICAgIGVsZW0uYWRkQ2xhc3MoJ2ZhZGUtaW4nKTtcblxuICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgZWxlbS5jc3MoXCJvcGFjaXR5XCIsIFwiMVwiKTtcbiAgICAgICAgICAgIH0sIG9mZnNldCk7XG4gICAgICAgIH1cbiAgICB9O1xufV0pO1xuIiwiLyoqXG4gKiBtc2dDZW50ZXJcbiAqIGEgZGlyZWN0aXZlIGZvciBoYW5kbGluZyBhbGwgbWVzc2FnZSByZWxheSBmb3IgYSB1c2VyXG4gKlxuICogVVNFOlxuICogJHJvb3RTY29wZS4kYnJvYWRjYXN0KCdNU0dDRU5URVI6RklSRScsIHsgbXNnOiBcIkhleSB0aGVyZSwgSW0gYSBtZXNzYWdlISFcIiwgZHVyOiA1LCB0eXBlOiBcImluZm9cIiwgaWNvbjogXCJpbmZvXCIsIGNhbGxiYWNrOiBmdW5jdGlvbigpe30gfSk7XG4gKlxuICogVFlQRVM6XG4gKiAtIERFRkFVTFQsIHNob3dzIGdyZWVuIG1lc3NhZ2UsIHVzZWQgZm9yIHN1Y2Nlc3NcbiAqIC0gV2FybmluZzogXCJ3YXJuXCIgLSBzaG93cyBvcmFuZ2UgbWVzc2FnZSwgdXNlZCBmb3IgZXJyb3JzIG9yIHdhcm5pbmdzXG4gKiAtIEluZm86IFwiaW5mb1wiIC0gc2hvd3MgZGFyayBibHVlIG1lc3NhZ2UsIHVzZWQgZm9yIGdlbmVyYWwgdGhpbmdzXG4gKlxuICogT1BUSU9OUzpcbiAqIC0gbXNnOiB0aGUgY29udGVudHMgb2YgdGhlIG1lc3NhZ2UsIChUT0RPOiBjYW4gYmUgaHRtbCBvciBzaW1wbGUgdGV4dClcbiAqIC0gY2FsbGJhY2s6IGEgZnVuY3Rpb24gdG8gZmlyZSBvbiBhY3Rpb24gdGFrZW4gb24gbWVzc2FnZVxuICogLSBkdXI6IHRoZSB0aW1lb3V0IG9mIHRoZSBtZXNzYWdlXG4gKiAtIHR5cGU6IHNlZSBhYm92ZSB0eXBlc1xuICogLSBpY29uOiBkZWZhdWx0IGlzIGdsb2JlLCBjYW4gYmUgc2V0IHRvIEFOWSBpLXNwcml0ZXMgKHNwcml0ZXMubGVzcylcbiAqL1xuTVVHLmRpcmVjdGl2ZSgnbXNnQ2VudGVyJyxcblsgXCIkcm9vdFNjb3BlXCIsIFwiJHRpbWVvdXRcIiwgXCIkY29tcGlsZVwiLFxuZnVuY3Rpb24gKCRyb290U2NvcGUsICR0aW1lb3V0LCAkY29tcGlsZSkge1xuICByZXR1cm4ge1xuICAgIHNjb3BlOiB7fSxcbiAgICBsaW5rOiBmdW5jdGlvbiAoc2NvcGUsIGVsLCBhdHRycywgY3RybCkge1xuICAgICAgdmFyIG1zZ1RlbXBsYXRlID0gJzxkaXYgY2xhc3M9XCJtc2dcIiBuZy1jbGljaz1cImFjdGlvbigpXCI+JytcbiAgICAgICAgICAnPGRpdiBjbGFzcz1cIm1zZy1pY25cIj48aSBjbGFzcz1cIml3IGktSUNPTlwiPjwvaT48L2Rpdj4nK1xuICAgICAgICAgICc8ZGl2IGNsYXNzPVwibXNnLWNvbnRcIj5CT0RZPC9kaXY+JytcbiAgICAgICAgICAnPGRpdiBjbGFzcz1cIm1zZy1hY3Rpb25cIj48aSBjbGFzcz1cImliIGktci1hcnJvd1wiPjwvaT48L2Rpdj4nK1xuICAgICAgICAnPC9kaXY+JztcblxuICAgICAgdmFyIF9lbCA9IGFuZ3VsYXIuZWxlbWVudChlbCk7XG4gICAgICB2YXIgdGltZXI7XG4gICAgICB2YXIgZHVyYXRpb24gPSA1MDAwO1xuICAgICAgdmFyIHByZXZpb3VzSWQgPSBcIlwiO1xuICAgICAgdmFyIGRlZmF1bHRJY29uID0gXCJpbmZvXCI7XG5cbiAgICAgIHNjb3BlLmJvZHkgPSBcIlwiO1xuICAgICAgc2NvcGUuY2FsbGJhY2sgPSBudWxsO1xuICAgICAgc2NvcGUuaWNvbiA9IGRlZmF1bHRJY29uO1xuICAgICAgc2NvcGUuYWN0aW9uID0gZnVuY3Rpb24oKXtcbiAgICAgICAgdmFyIGFjdGlvbkVsID0gX2VsLmZpbmQoXCIjXCIgKyB0aGlzLmlkKTtcbiAgICAgICAgc2NvcGUuY2FsbGJhY2soKTtcbiAgICAgICAgY2xlYXJFbCggYWN0aW9uRWwgKTtcbiAgICAgIH07XG5cbiAgICAgIGZ1bmN0aW9uIHNob3dNZXNzYWdlICggZGF0YSApe1xuICAgICAgICB2YXIgX2lkID0gKCtuZXcgRGF0ZSgpKTtcbiAgICAgICAgdmFyIG5ld0JvZHkgPSBkYXRhLm1zZztcbiAgICAgICAgdmFyIG5ld0ljbiA9IChkYXRhLmljb24pPyBkYXRhLmljb24gOiBkZWZhdWx0SWNvbjtcblxuICAgICAgICB2YXIgdGVtcGxhdGUgPSBtc2dUZW1wbGF0ZS5yZXBsYWNlKFwiQk9EWVwiLCBuZXdCb2R5KS5yZXBsYWNlKFwiSUNPTlwiLCBuZXdJY24pO1xuICAgICAgICB2YXIgbmV3TWVzc2FnZSA9ICRjb21waWxlKHRlbXBsYXRlKShzY29wZSk7XG5cbiAgICAgICAgLy8gc2V0IGEgdW5pcXVlIGlkXG4gICAgICAgIG5ld01lc3NhZ2VbMF0uaWQgPSBfaWQ7XG4gICAgICAgIHByZXZpb3VzSWQgPSBfaWQ7XG5cbiAgICAgICAgLy8gdGhyb3cgaW50byBkb20sIHRoZW4gc2hvdyBpbiB2aWV3LCBzdGFydCB0aW1lclxuICAgICAgICBfZWwuYXBwZW5kKCBuZXdNZXNzYWdlICk7XG5cbiAgICAgICAgLy8gcmVtZW1iZXIgdGhlIG5ldyBlbCBmb3IgbGF0ZXJcbiAgICAgICAgdmFyIG1zZ0VsID0gX2VsLmZpbmQoXCIjXCIgKyBfaWQpO1xuICAgICAgICBjaGFuZ2VUeXBlKCBtc2dFbCwgZGF0YS50eXBlICk7XG5cbiAgICAgICAgaWYoZGF0YS5jYWxsYmFjayl7XG4gICAgICAgICAgbXNnRWwuZmluZChcIi5tc2ctYWN0aW9uXCIpLmFkZENsYXNzKFwic2hvd1wiKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIHNob3dcbiAgICAgICAgJHRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgbXNnRWwuYWRkQ2xhc3MoJ2FkZCcpO1xuICAgICAgICB9LCAyMCk7XG5cbiAgICAgICAgdGltZXIgPSAkdGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGNsZWFyRWwoIG1zZ0VsICk7XG4gICAgICAgIH0sIGR1cmF0aW9uKTtcbiAgICAgIH1cblxuICAgICAgZnVuY3Rpb24gY2xlYXJFbCAoIGVsZW0gKSB7XG4gICAgICAgIGlmKCFlbGVtICYmIHByZXZpb3VzSWQpe1xuICAgICAgICAgIGVsZW0gPSBfZWwuZmluZChcIiNcIiArIHByZXZpb3VzSWQpO1xuICAgICAgICB9IGVsc2UgaWYoIWVsZW0pIHsgcmV0dXJuOyB9XG5cbiAgICAgICAgZWxlbS5yZW1vdmVDbGFzcygnYWRkJyk7XG4gICAgICAgIGVsZW0uYWRkQ2xhc3MoJ3JlbW92ZScpO1xuICAgICAgICAkdGltZW91dChmdW5jdGlvbigpe1xuICAgICAgICAgIGFuZ3VsYXIuZWxlbWVudChlbGVtKS5yZW1vdmUoKTtcbiAgICAgICAgfSwgMzAwKTtcbiAgICAgIH1cblxuICAgICAgLy8gc2V0IHRoZSB0eXBlIGJ5IGEgY2xhc3NcbiAgICAgIGZ1bmN0aW9uIGNoYW5nZVR5cGUgKCBlbGVtLCB0eXBlICkge1xuICAgICAgICBlbGVtLnJlbW92ZUNsYXNzKCdtc2ctaW5mbycpO1xuICAgICAgICBlbGVtLnJlbW92ZUNsYXNzKCdtc2ctd2FybicpO1xuXG4gICAgICAgIGlmKHR5cGUpe1xuICAgICAgICAgIGVsZW0uYWRkQ2xhc3MoJ21zZy0nICsgdHlwZSk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgJHJvb3RTY29wZS4kb24oJ01TR0NFTlRFUjpGSVJFJywgZnVuY3Rpb24oZSwgZGF0YSl7XG4gICAgICAgIGlmKCFkYXRhLm1zZyl7IHJldHVybjsgfVxuICAgICAgICB3aW5kb3cuY2xlYXJUaW1lb3V0KHRpbWVyKTtcbiAgICAgICAgY2xlYXJFbCgpO1xuXG4gICAgICAgIGlmKGRhdGEuZHVyKXtcbiAgICAgICAgICBkdXJhdGlvbiA9IGRhdGEuZHVyICogMTAwMDtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmKGRhdGEuY2FsbGJhY2spe1xuICAgICAgICAgIHNjb3BlLmNhbGxiYWNrID0gZGF0YS5jYWxsYmFjaztcbiAgICAgICAgfVxuXG4gICAgICAgIHNob3dNZXNzYWdlKCBkYXRhICk7XG4gICAgICB9KTtcbiAgICB9XG4gIH07XG59XSk7XG4iLCJNVUcuZmFjdG9yeSgndGltZUFnbycsIGZ1bmN0aW9uICgpIHtcbiAgdmFyIHNlcnZpY2UgPSB7fTtcblxuICBzZXJ2aWNlLnNldHRpbmdzID0ge1xuICAgIHJlZnJlc2hNaWxsaXM6IDYwMDAwLFxuICAgIGFsbG93RnV0dXJlOiBmYWxzZSxcbiAgICBzdHJpbmdzOiB7XG4gICAgICBwcmVmaXhBZ286IG51bGwsXG4gICAgICBwcmVmaXhGcm9tTm93OiBudWxsLFxuICAgICAgc3VmZml4QWdvOiAnYWdvJyxcbiAgICAgIHN1ZmZpeEZyb21Ob3c6ICdmcm9tIG5vdycsXG4gICAgICBzZWNvbmRzOiAnbGVzcyB0aGFuIGEgbWludXRlJyxcbiAgICAgIG1pbnV0ZTogJ2Fib3V0IGEgbWludXRlJyxcbiAgICAgIG1pbnV0ZXM6ICclZCBtaW51dGVzJyxcbiAgICAgIGhvdXI6ICdhYm91dCBhbiBob3VyJyxcbiAgICAgIGhvdXJzOiAnJWQgaG91cnMnLFxuICAgICAgZGF5OiAnYSBkYXknLFxuICAgICAgZGF5czogJyVkIGRheXMnLFxuICAgICAgbW9udGg6ICdhYm91dCBhIG1vbnRoJyxcbiAgICAgIG1vbnRoczogJyVkIG1vbnRocycsXG4gICAgICB5ZWFyOiAnYWJvdXQgYSB5ZWFyJyxcbiAgICAgIHllYXJzOiAnJWQgeWVhcnMnLFxuICAgICAgbnVtYmVyczogW11cbiAgICB9XG4gIH07XG5cbiAgZnVuY3Rpb24gdHJpbURpZ2l0cyAoIG51bSApIHtcbiAgICAgIHZhciBtID0gbnVtLnRvU3RyaW5nKCkuc2xpY2UoMCwxMyk7XG4gICAgICByZXR1cm4gKG0ubGVuZ3RoID09IDEzKT8gcGFyc2VJbnQobSkgOiBudW07XG4gIH1cblxuICBzZXJ2aWNlLmluV29yZHMgPSBmdW5jdGlvbiAoZGlzdGFuY2VNaWxsaXMpIHtcbiAgICB2YXIgJGwgPSBzZXJ2aWNlLnNldHRpbmdzLnN0cmluZ3M7XG4gICAgdmFyIHByZWZpeCA9ICRsLnByZWZpeEFnbztcbiAgICB2YXIgc3VmZml4ID0gJGwuc3VmZml4QWdvO1xuICAgIGlmIChzZXJ2aWNlLnNldHRpbmdzLmFsbG93RnV0dXJlKSB7XG4gICAgICBpZiAoZGlzdGFuY2VNaWxsaXMgPCAwKSB7XG4gICAgICAgIHByZWZpeCA9ICRsLnByZWZpeEZyb21Ob3c7XG4gICAgICAgIHN1ZmZpeCA9ICRsLnN1ZmZpeEZyb21Ob3c7XG4gICAgICB9XG4gICAgfVxuXG4gICAgdmFyIHNlY29uZHMgPSBNYXRoLmFicyhkaXN0YW5jZU1pbGxpcykgLyAxMDAwO1xuICAgIHZhciBtaW51dGVzID0gc2Vjb25kcyAvIDYwO1xuICAgIHZhciBob3VycyA9IG1pbnV0ZXMgLyA2MDtcbiAgICB2YXIgZGF5cyA9IGhvdXJzIC8gMjQ7XG4gICAgdmFyIHllYXJzID0gZGF5cyAvIDM2NTtcblxuICAgIGZ1bmN0aW9uIHN1YnN0aXR1dGUoc3RyaW5nT3JGdW5jdGlvbiwgbnVtYmVyKSB7XG4gICAgICB2YXIgc3RyaW5nID0gYW5ndWxhci5pc0Z1bmN0aW9uKHN0cmluZ09yRnVuY3Rpb24pID9cbiAgICAgIHN0cmluZ09yRnVuY3Rpb24obnVtYmVyLCBkaXN0YW5jZU1pbGxpcykgOiBzdHJpbmdPckZ1bmN0aW9uO1xuICAgICAgdmFyIHZhbHVlID0gKCRsLm51bWJlcnMgJiYgJGwubnVtYmVyc1tudW1iZXJdKSB8fCBudW1iZXI7XG4gICAgICByZXR1cm4gc3RyaW5nLnJlcGxhY2UoLyVkL2ksIHZhbHVlKTtcbiAgICB9XG5cbiAgICB2YXIgd29yZHMgPSBzZWNvbmRzIDwgNDUgJiYgc3Vic3RpdHV0ZSgkbC5zZWNvbmRzLCBNYXRoLnJvdW5kKHNlY29uZHMpKSB8fFxuICAgICAgICBzZWNvbmRzIDwgOTAgJiYgc3Vic3RpdHV0ZSgkbC5taW51dGUsIDEpIHx8XG4gICAgICAgIG1pbnV0ZXMgPCA0NSAmJiBzdWJzdGl0dXRlKCRsLm1pbnV0ZXMsIE1hdGgucm91bmQobWludXRlcykpIHx8XG4gICAgICAgIG1pbnV0ZXMgPCA5MCAmJiBzdWJzdGl0dXRlKCRsLmhvdXIsIDEpIHx8XG4gICAgICAgIGhvdXJzIDwgMjQgJiYgc3Vic3RpdHV0ZSgkbC5ob3VycywgTWF0aC5yb3VuZChob3VycykpIHx8XG4gICAgICAgIGhvdXJzIDwgNDIgJiYgc3Vic3RpdHV0ZSgkbC5kYXksIDEpIHx8XG4gICAgICAgIGRheXMgPCAzMCAmJiBzdWJzdGl0dXRlKCRsLmRheXMsIE1hdGgucm91bmQoZGF5cykpIHx8XG4gICAgICAgIGRheXMgPCA0NSAmJiBzdWJzdGl0dXRlKCRsLm1vbnRoLCAxKSB8fFxuICAgICAgICBkYXlzIDwgMzY1ICYmIHN1YnN0aXR1dGUoJGwubW9udGhzLCBNYXRoLnJvdW5kKGRheXMgLyAzMCkpIHx8XG4gICAgICAgIHllYXJzIDwgMS41ICYmIHN1YnN0aXR1dGUoJGwueWVhciwgMSkgfHxcbiAgICAgICAgc3Vic3RpdHV0ZSgkbC55ZWFycywgTWF0aC5yb3VuZCh5ZWFycykpO1xuXG4gICAgdmFyIHNlcGFyYXRvciA9ICRsLndvcmRTZXBhcmF0b3IgPT09IHVuZGVmaW5lZCA/ICcgJyA6ICRsLndvcmRTZXBhcmF0b3I7XG4gICAgcmV0dXJuIFtwcmVmaXgsIHdvcmRzLCBzdWZmaXhdLmpvaW4oc2VwYXJhdG9yKS50cmltKCk7XG4gIH07XG5cbiAgc2VydmljZS5wYXJzZSA9IGZ1bmN0aW9uIChpc284NjAxKSB7XG4gICAgaWYgKGFuZ3VsYXIuaXNOdW1iZXIoaXNvODYwMSkpIHtcbiAgICAgIGlzbzg2MDEgPSBpc284NjAxICsgXCJcIjtcbiAgICAgIC8vIGZvcm1hdCBmb3IgY29ycmVjdCBsZW5ndGhcbiAgICAgIHZhciBvcmlnaW5hbFRpbWVzdGFtcCA9IHRyaW1EaWdpdHMoIGlzbzg2MDEgKTtcbiAgICAgIHJldHVybiBwYXJzZUludChvcmlnaW5hbFRpbWVzdGFtcCwgMTApO1xuICAgIH1cbiAgICB2YXIgcyA9IChpc284NjAxIHx8ICcnKS50cmltKCk7XG4gICAgcyA9IHMucmVwbGFjZSgvXFwuXFxkKy8sICcnKTsgLy8gcmVtb3ZlIG1pbGxpc2Vjb25kc1xuICAgIHMgPSBzLnJlcGxhY2UoLy0vLCAnLycpLnJlcGxhY2UoLy0vLCAnLycpO1xuICAgIHMgPSBzLnJlcGxhY2UoL1QvLCAnICcpLnJlcGxhY2UoL1ovLCAnIFVUQycpO1xuICAgIHMgPSBzLnJlcGxhY2UoLyhbXFwrXFwtXVxcZFxcZClcXDo/KFxcZFxcZCkvLCAnICQxJDInKTsgLy8gLTA0OjAwIC0+IC0wNDAwXG4gICAgcmV0dXJuIG5ldyBEYXRlKHMpO1xuICB9O1xuXG4gIHJldHVybiBzZXJ2aWNlO1xufSk7XG4iLCJNVUcuZmFjdG9yeSgnbm93VGltZScsXG5bJyR0aW1lb3V0JyxcbmZ1bmN0aW9uICgkdGltZW91dCkge1xuICB2YXIgbm93VGltZSA9IERhdGUubm93KCk7XG4gIHZhciB1cGRhdGVUaW1lID0gZnVuY3Rpb24oKSB7XG4gICAgJHRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICBub3dUaW1lID0gRGF0ZS5ub3coKTtcbiAgICAgIHVwZGF0ZVRpbWUoKTtcbiAgICB9LCAxMDAwKTtcbiAgfTtcbiAgdXBkYXRlVGltZSgpO1xuICByZXR1cm4ge1xuICAgIGdldFRpbWU6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIG5vd1RpbWU7XG4gICAgfVxuICB9O1xufV0pO1xuIiwiTVVHLmZpbHRlcigndGltZUFnbycsXG5bJ25vd1RpbWUnLCAndGltZUFnbycsXG5mdW5jdGlvbiAobm93VGltZSwgdGltZUFnbykge1xuICByZXR1cm4gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgdmFyIGZyb21UaW1lID0gdGltZUFnby5wYXJzZSh2YWx1ZSk7XG4gICAgdmFyIGRpZmYgPSBub3dUaW1lLmdldFRpbWUoKSAtIGZyb21UaW1lO1xuICAgIHJldHVybiB0aW1lQWdvLmluV29yZHMoZGlmZik7XG4gIH07XG59XSk7XG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=