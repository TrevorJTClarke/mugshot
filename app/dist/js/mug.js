var MUG=angular.module("mugshot",["ui.router","mugtemplates"]);MUG.directive("alert",["$rootScope","$timeout","$compile","$templateCache",function(e,t,r,n){return{restrict:"E",replace:!0,template:'<div class="alert-parent"></div>',scope:{},link:function(o,i,c,a){function s(n){var o=+new Date,i=(n.title,n.icon?n.icon:null,e.$new(!0));i.alert={},i.alert.id=o,i.alert.icon=n.icon?n.icon:null,i.alert.type=n.type?n.type:"info",i.alert.title=n.title,i.alert.action=n.callback?function(){this.id;n.callback(),u(this)}:null;var c=r(p)(i);c[0].id=o,m=o,f.append(c),c.addClass(v),t(function(){c.addClass(h)},20),l=t(function(){u(c)},d)}function u(e){if(!e&&m)e=angular.element(document.getElementById(m));else{if(!e)return;e&&(e=angular.element(e))}e.removeClass(h),t(function(){e.remove()},300)}var l,p=n.get("alert.html"),f=angular.element(i),d=5e3,m="",v="alert-active",h="alert-visible";e.$on("ALERT:FIRE",function(e,t){t.title&&(window.clearTimeout(l),u(),t.dur&&(d=1e3*t.dur),s(t))})}}}]),MUG.directive("fadeIn",[function(){return{restrict:"A",link:function(e,t,r){var n=parseInt(r.fadeIn)||10;t.addClass("fade-in"),setTimeout(function(){t.css("opacity","1")},n)}}}]),MUG.directive("modal",["$timeout","$compile","$rootScope",function(e,t,r){return{restrict:"E",replace:!0,templateUrl:"modal.html",scope:{},link:function(e,t,n){function o(t){var n=t.remoteSource?t.remoteSource:t.source;e.compareItem.a=t.remoteSource?n:"screens/reference/"+r.project.id+"/"+n.replace(r.project.currentBatch+".png",r.project.currentReference+".png"),e.compareItem.b=t.remoteSource?n:"screens/compare/"+r.project.id+"/"+n,e.compareItem.c=t.remoteSource?n:"screens/compare/"+r.project.id+"/"+n.replace(".png","_diff.png")}var i="modal-open",c="modal-visible";e.project=angular.copy(r.project),e.activeOption="sides",e.opacityRange={},e.currentIndex=0,e.activeItem={},e.compareItem={a:"",b:"",c:""},e.viewer={items:[]},e.opacityRange={amount:.8,inverse:.2,percent:"80%"},e.$watch("opacityRange.amount",function(t,r){t!==r&&(e.opacityRange.inverse=(1-t).toFixed(2),e.opacityRange.percent=Math.round(100*t)+"%")}),e.optionMode=function(t){e.activeOption=t},r.$on("MODAL:CLOSE",function(t,r){e.close()}),r.$on("MODAL:OPEN",function(n,a){a&&a.type&&(e.currentIndex=0,e.project=angular.copy(r.project),"preview"===a.type&&(e.activeItem=a.item,e.viewer=a.project||{},e.viewer.items=null,e.compareItem.a=e.activeItem.remoteSource?e.activeItem.remoteSource:"screens/"+e.activeItem.type+"/"+r.project.id+"/"+e.activeItem.source),"batch"===a.type&&a.items.length>0&&(e.activeItem=a.items[e.currentIndex],e.viewer=a.project||{},e.viewer.items=a.items,o(e.activeItem)),t.addClass(i),setTimeout(function(){t.addClass(c)},30))}),e.close=function(){t.removeClass(c),setTimeout(function(){t.removeClass(i)},230)},e.modalActionNav=function(t){if(!(e.viewer.items.length<1)){var r,n=e.viewer.items.length-1;r="right"===t?e.currentIndex===n?0:e.currentIndex+1:0===e.currentIndex?n:e.currentIndex-1,e.activeItem=e.viewer.items[r],e.currentIndex=r,o(e.activeItem)}},e.goToIndex=function(t){e.currentIndex!==t&&(e.activeItem=e.viewer.items[t],e.currentIndex=t,o(e.activeItem))}}}}]),MUG.directive("msgCenter",["$rootScope","$timeout","$compile",function(e,t,r){return{scope:{},link:function(n,o,i,c){function a(e){var o=+new Date,i=e.msg,c=e.icon?e.icon:v,a=p.replace("BODY",i).replace("ICON",c),h=r(a)(n);h[0].id=o,m=o,f.append(h);var g=f.find("#"+o);u(g,e.type),e.callback&&g.find(".msg-action").addClass("show"),t(function(){g.addClass("add")},20),l=t(function(){s(g)},d)}function s(e){if(!e&&m)e=f.find("#"+m);else if(!e)return;e.removeClass("add"),e.addClass("remove"),t(function(){angular.element(e).remove()},300)}function u(e,t){e.removeClass("msg-info"),e.removeClass("msg-warn"),t&&e.addClass("msg-"+t)}var l,p='<div class="msg" ng-click="action()"><div class="msg-icn"><i class="iw i-ICON"></i></div><div class="msg-cont">BODY</div><div class="msg-action"><i class="ib i-r-arrow"></i></div></div>',f=angular.element(o),d=5e3,m="",v="info";n.body="",n.callback=null,n.icon=v,n.action=function(){var e=f.find("#"+this.id);n.callback(),s(e)},e.$on("MSGCENTER:FIRE",function(e,t){t.msg&&(window.clearTimeout(l),s(),t.dur&&(d=1e3*t.dur),t.callback&&(n.callback=t.callback),a(t))})}}}]);var P=require("./vendor/core/preloader");MUG.directive("preloader",["$rootScope","$timeout",function(e,t){return{replace:!0,restrict:"E",scope:{},template:'<div class="preloader"></div>',link:function(r,n,o,i){function c(e,t){if(t&&t.msg){l=t.msg;var r;switch(l){case"Opening Browser Session":r=0;break;case"Capturing Screens":r=1}l!==p&&s&&s.animate&&s.animate(r,30,function(){p=l})}}function a(){u.addClass(f)}var s,u,l,p,f="loading";t(function(){s=new P.Browser,s.init(),u=document.querySelector(".preloader"),u.appendChild(s.instance),s.drawBrowser()},30),e.$on("PRELOADER:UPDATE",c),e.$on("PRELOADER:OFF",a)}}}]),MUG.directive("timeAgo",["timeAgoService","nowTimeService",function(e,t){return{restrict:"EA",link:function(r,n,o){var i;o.$observe("fromTime",function(t){i=e.parse(t)}),r.$watch(function(){return t.getTime()-i},function(t){angular.element(n).text(e.inWords(t))})}}}]);var fs=require("fs"),async=require("async");MUG.factory("Compare",["$q","Config",function(e,t){function r(e,t){fs.readFile(o+e,"base64",t)}function n(n,o){var c=e.defer(),a={};return resemble.outputSettings(t.Compare),async.map([n,o],r,function(e,t){var r=i+t[0],n=i+t[1];e&&c.reject(e),resemble(r).compareTo(n).ignoreColors().onComplete(function(e){a.report=e,a.src=e.getImageDataUrl(),c.resolve(a)})}),c.promise}var o=__dirname+"/",i="data:image/png;base64,",c=["passed","warning","failed"];return{runSingle:n,getStatus:function(e){var t=parseFloat(e.misMatchPercentage);return.1>t?e.isSameDimensions===!1?c[1]:c[0]:t>.1&&2>t?c[1]:c[2]}}}]),MUG.factory("nowTime",["$timeout",function(e){var t=Date.now(),r=function(){e(function(){t=Date.now(),r()},1e3)};return r(),{getTime:function(){return t}}}]);var fs=require("fs"),path=require("path"),AWS=require("./vendor/core/aws");MUG.factory("Projects",["$q",function(e){function t(e){return"number"==typeof e&&e===parseInt(e,10)&&(e=Array(e+1).join("x")),e.replace(/x/g,function(){var e=Math.round(61*Math.random())+48;return e=e>57?e+7>90?e+13:e+7:e,String.fromCharCode(e)})}function r(e){e=e||0;var r=t(12);return{id:r,title:"Project "+(parseInt(e,10)+1),timestamp:+new Date,totals:{success:null,warning:null,error:null,views:0}}}function n(e){t(12);return{batchHistory:{},currentBatch:null,currentReference:null,id:e.id,title:e.title,timestamp:e.timestamp,viewports:[],selectors:[],cookies:[],meta:{url:null,readyEvent:null,delay:null,misMatchThreshold:null}}}function o(e,t){var r;try{r=fs.readFileSync(e,"utf8")}catch(n){if("ENOENT"===n.code)return t||{};throw n}return JSON.parse(r)}function i(e){try{var t=fs.readdirSync(e)}catch(r){return}if(t.length>0)for(var n=0;n<t.length;n++){var o=path.join(e,t[n]);fs.statSync(o).isFile()?fs.unlinkSync(o):rmDir(o)}}function c(t,r){var n=e.defer();return fs.writeFile(t,JSON.stringify(r),function(e){return e?void n.reject(e):void n.resolve()}),n.promise}function a(t){var r=e.defer();return fs.unlink(t,function(e){return e?void r.reject(e):void r.resolve()}),r.promise}var s=__dirname+"/projects.json",u=__dirname+"/projects/";return{get:function(e,t){return o(__dirname+e,t)},getAll:function(){return o(s,[])},getById:function(e){return o(u+e+".json")},getTypeById:function(e,t){var r=t?"_"+t:"";return o(u+e+r+".json",[])},validate:function(e){var t=e.cookies,r=e.viewports,n=e.selectors,o=e.title,i=e.meta.url,c=!0;return!r||!n||!o||!i||r.length<1||n.length<1?!1:(r&&r.map(function(e,t){e.width&&e.height&&e.name||(c=!1)}),n&&n.map(function(e,t){e.query&&e.type||(c=!1)}),t&&t.map(function(e,t){e.name&&e.path&&e.value||(c=!1)}),c)},createNew:function(){var t=e.defer(),o=JSON.parse(fs.readFileSync(s,"utf8")),i=r(o.length),c=n(i);return o.unshift(i),fs.writeFile(s,JSON.stringify(o),function(e){return e?void t.reject(e):void fs.writeFile(u+i.id+".json",JSON.stringify(c),function(e){return e?void t.reject(e):void fs.writeFile(u+i.id+"_history.json",JSON.stringify([]),function(e){return e?void t.reject(e):void t.resolve(i)})})}),t.promise},save:function(t){var r=e.defer(),n=JSON.parse(fs.readFileSync(s,"utf8"));return n.map(function(e,r){e.id===t.id&&(n[r].title=t.title,n[r].timestamp=+new Date)}),fs.writeFile(u+t.id+".json",JSON.stringify(t),function(e){return e?void r.reject(e):void fs.writeFile(s,JSON.stringify(n),function(e){return e?void r.reject(e):void r.resolve(t)})}),r.promise},remove:function(t){var r=e.defer(),n=JSON.parse(fs.readFileSync(s,"utf8"));return n.map(function(e,r){e.id===t&&n.splice(r,1)}),fs.unlink(u+t+".json",function(e){return e?void r.reject(e):void fs.unlink(u+t+"_history.json",function(e){return e?void r.reject(e):void fs.writeFile(s,JSON.stringify(n),function(e){return e?void r.reject(e):void r.resolve()})})}),r.promise},clearHistory:function(t){var r=e.defer(),n=o(s,[]);return t.currentBatch=null,t.currentReference=null,t.batchHistory={},n.map(function(e,r){e.id===t.id&&(n[r].totals.success=0,n[r].totals.warning=0,n[r].totals.error=0,n[r].totals.views=0)}),this.cleanImageFiles(t),fs.writeFile(u+t.id+"_history.json",JSON.stringify([]),function(e){return e?void r.reject(e):void fs.writeFile(u+t.id+".json",JSON.stringify(t),function(e){return e?void r.reject(e):void fs.writeFile(s,JSON.stringify(n),function(e){return e?void r.reject(e):void r.resolve()})})}),r.promise},sync:function(t){if(t){for(var r=this,n=e.defer(),o=this.getById(t),i=this.getTypeById(t,"history"),c=[],a=0;a<i.length;a++){var s=i[a];if(s.source&&-1===s.source.search("amazon")){var u=s.source,l=s.type,p=__dirname+"/screens/"+l+"/"+o.id+"/"+u;c.push({key:l+"/"+u,path:p})}}return AWS.init().upload(c,o.id).then(function(e){r.cleanAfterSync(o,e).then(n.resolve,n.reject)},function(e){n.reject(e)}),n.promise}},cleanAfterSync:function(t,r){var n=e.defer(),i=o(u+t.id+"_history.json",[]),s=[],l=[];t.updatedAt=+new Date;for(var p=0;p<r.length;p++){var f=r[p],d=f.split("/"),m=d[d.length-2],v=d[d.length-1];i.map(function(e,n){if(e.source===v&&"compare"===m){var o=__dirname+"/screens/"+m+"/"+t.id+"/"+v,c=a(o),s=a(o.replace(".","_diff."));delete i[n].source,i[n].remoteSource=r[p],l.push(c),l.push(s)}})}var h=__dirname+"/projects/"+t.id+".json",g=h.replace(".json","_history.json"),y=c(h,t),j=c(g,i);l.unshift(y),l.unshift(j),s.push({key:t.id,path:h}),s.push({key:t.id+"_history",path:g});var w=AWS.init().upload(s,t.id);return l.unshift(w),e.all(l).then(n.resolve,n.reject),n.promise},cleanImageFiles:function(e){var t=__dirname+"/screens/BASE/"+e.id,r=t.replace("BASE","compare"),n=t.replace("BASE","reference");i(r),i(n)}}}]),MUG.factory("timeAgo",function(){function e(e){var t=e.toString().slice(0,13);return 13==t.length?parseInt(t):e}var t={};return t.settings={refreshMillis:6e4,allowFuture:!1,strings:{prefixAgo:null,prefixFromNow:null,suffixAgo:"ago",suffixFromNow:"from now",seconds:"less than a minute",minute:"about a minute",minutes:"%d minutes",hour:"about an hour",hours:"%d hours",day:"a day",days:"%d days",month:"about a month",months:"%d months",year:"about a year",years:"%d years",numbers:[]}},t.inWords=function(e){function r(t,r){var o=angular.isFunction(t)?t(r,e):t,i=n.numbers&&n.numbers[r]||r;return o.replace(/%d/i,i)}var n=t.settings.strings,o=n.prefixAgo,i=n.suffixAgo;t.settings.allowFuture&&0>e&&(o=n.prefixFromNow,i=n.suffixFromNow);var c=Math.abs(e)/1e3,a=c/60,s=a/60,u=s/24,l=u/365,p=45>c&&r(n.seconds,Math.round(c))||90>c&&r(n.minute,1)||45>a&&r(n.minutes,Math.round(a))||90>a&&r(n.hour,1)||24>s&&r(n.hours,Math.round(s))||42>s&&r(n.day,1)||30>u&&r(n.days,Math.round(u))||45>u&&r(n.month,1)||365>u&&r(n.months,Math.round(u/30))||1.5>l&&r(n.year,1)||r(n.years,Math.round(l)),f=void 0===n.wordSeparator?" ":n.wordSeparator;return[o,p,i].join(f).trim()},t.parse=function(t){if(angular.isNumber(t)){t+="";var r=e(t);return parseInt(r,10)}var n=(t||"").trim();return n=n.replace(/\.\d+/,""),n=n.replace(/-/,"/").replace(/-/,"/"),n=n.replace(/T/," ").replace(/Z/," UTC"),n=n.replace(/([\+\-]\d\d)\:?(\d\d)/," $1$2"),new Date(n)},t}),MUG.filter("timeAgo",["nowTime","timeAgo",function(e,t){return function(r){var n=t.parse(r),o=e.getTime()-n;return t.inWords(o)}}]);var ipc=require("ipc");MUG.controller("MainCtrl",["$rootScope","$scope","$state","Config","Projects",function(e,t,r,n,o){e.currentProjectId="",t.createNewProject=function(){o.createNew().then(function(t){e.$broadcast("SIDEPANEL:NEWPROJECT",t),r.go("projects.settings",{id:t.id})},function(e){console.log("err",e)})},ipc.on("NAVIGATE:TO",function(e){e&&e.location&&(console.log("NAVIGATE:TO",e),r.go(e.location))}),e.SafeApply=function(e,t){e.$$phase||e.$root.$$phase?"undefined"!=typeof t&&t():e.$apply(t)}}]);var fs=require("fs"),AWS=require("./vendor/core/aws");MUG.controller("PreferencesCtrl",["$rootScope","$scope","$state",function(e,t,r){t.awsConfig={bucket:"",accessKeyId:"",secretAccessKey:""},t.awsConfig=AWS.getConfig(),t.save=function(){AWS.setConfig(t.awsConfig)}}]),MUG.controller("ProjectCtrl",["$rootScope","$scope","$stateParams","Projects",function(e,t,r,n){e.project=n.getById(r.id)}]),MUG.controller("ProjectHistoryCtrl",["$rootScope","$scope","$stateParams","Projects",function(e,t,r,n){t.activeFilter="All",t.activeFilterQuery="",t.historyItems=n.getTypeById(r.id,"history"),t.changeFilter=function(e){t.activeFilter=e,t.activeFilterQuery="All"==e?"":e},t.previewItem=function(t){e.$emit("MODAL:OPEN",{type:"preview",item:t,project:e.project})}}]);var ipc=require("ipc");MUG.controller("ProjectRunnerCtrl",["$rootScope","$scope","$timeout","$stateParams","Projects",function(e,t,r,n,o){function i(e){function r(e){if(e.status){var r=0;switch(e.status){case"warning":r=1;break;case"failed":r=2}n[r].items.unshift(e),t.activeData[n[r].type]=t.activeData[n[r].type]+1}}if(!e||e.length<1)return t.hasReference=!1,[];t.activeData={},t.activeData.success=0,t.activeData.warning=0,t.activeData.error=0;var n=[{type:"success",items:[]},{type:"warning",items:[]},{type:"error",items:[]}];return e.map(function(e,n){e.batch===t.currentBatch&&r(e)}),t.hasReference=!0,n}function c(){if(null!==e.project.currentBatch){var r=o.getTypeById(e.project.id,"history");t.batchItems=i(r),t.runningType=e.project.currentReference>=e.project.currentBatch?"reference":"compare"}}function a(){var t=o.validate(e.project);return t||e.$broadcast("ALERT:FIRE",{title:"Please finish configuring settings!",dur:5,type:"error",icon:"stop"}),t}function s(){t.hasSettings=a(),t.hasReference=null!==e.project.currentReference,"reference"===t.runningType?t.hasCompare=!1:(t.hasCompare=null!==e.project.currentBatch&&0!==e.project.currentBatch,t.hasCompare=e.project.currentReference<=e.project.currentBatch)}function u(){e.project=o.getById(e.project.id),t.currentBatch=e.project.currentBatch,t.activeData=e.project&&e.project.batchHistory?e.project.batchHistory[t.currentBatch]:null,e.$emit("SIDEPANEL:UPDATE",e.project)}function l(){void 0===typeof e.project.meta.autoSyncAws||e.project.meta.autoSyncAws!==!0||v||(e.$broadcast("ALERT:FIRE",{title:"Sync Starting",dur:3,type:"info"}),v=!0,o.sync(e.project.id).then(function(t){v=!1,e.$broadcast("ALERT:FIRE",{title:"Sync Complete",dur:3,type:"success",icon:"check"})},function(t){console.log("syncNow err",t),v=!1,e.$broadcast("ALERT:FIRE",{title:"Sync Failed",dur:5,type:"error",icon:"stope"})}))}function p(r){r&&r.msg&&r.percent&&(t.progress.percent=parseInt(r.percent,10),t.progress.title=r.msg?r.msg:t.progress.title,e.$emit("PRELOADER:UPDATE",r))}function f(){r(function(){u(),c(),s(),l(),t.processing=!1},3)}function d(e){console.log("RUNNER:FAILED reason",e),t.processing=!1}var m=[{type:"success",items:[]},{type:"warning",items:[]},{type:"error",items:[]}];t.processing=!1,t.hasSettings=!1,t.hasReference=!1,t.hasCompare=!1,t.runningType="reference",t.batchItems=m,t.activeData={},t.currentBatch=e.project.currentBatch||0,t.progress={percent:0,title:"Starting"};var v=!1;u(),c(),s(),t.previewBatch=function(t){e.$emit("MODAL:OPEN",{type:"batch",items:t,project:e.project})},t.newCompare=function(){var r=a();r&&(t.runningType="compare",t.processing=!0,setTimeout(function(){e.$emit("PRELOADER:ON")},10),ipc.send("RUNNER:FIRE",{type:"compare",projectId:e.project.id}))},t.newReference=function(){var r=a();r&&(t.processing=!0,t.runningType="reference",t.hasCompare=!1,setTimeout(function(){e.$emit("PRELOADER:ON")},10),ipc.send("RUNNER:FIRE",{type:"reference",projectId:e.project.id}))},ipc.on("RUNNER:PROGRESS",p),ipc.on("RUNNER:COMPLETE",f),ipc.on("RUNNER:FAILED",d)}]);var fs=require("fs");MUG.controller("ProjectSettingsCtrl",["$rootScope","$scope","$state","Projects",function(e,t,r,n){function o(t,r){e.project[t].push(r)}function i(){var e=n.get("/config/aws.json",{});return e&&e.bucket&&e.accessKeyId&&e.secretAccessKey?!0:!1}var c;t.syncing=!1,t.selectorTypes=["container","hide","remove"],t.hasChanges=!1,t.hasAwsSettings=!1,t.master={},angular.copy(e.project,t.master),t.hasAwsSettings=i(),t.$watch("project",function(e,r){e!=r&&(t.hasChanges=!0,t.save())},!0),t.save=function(){c&&window.clearTimeout(c),c=setTimeout(function(){n.save(e.project).then(function(r){e.$emit("SIDEPANEL:UPDATE",r),angular.copy(e.project,t.master),t.hasChanges=!1},function(e){console.log("err",e)})},200)},t.syncNow=function(){t.syncing=!0,e.$broadcast("ALERT:FIRE",{title:"Sync Starting",dur:5,type:"info"}),n.sync(e.project.id).then(function(r){t.syncing=!1,e.$broadcast("ALERT:FIRE",{title:"Sync Complete",dur:5,type:"success",icon:"check"})},function(r){t.syncing=!1,console.log("syncNow err",r),e.$broadcast("ALERT:FIRE",{title:"Sync Failed",dur:5,type:"error",icon:"stope"})})},t.cancelSave=function(){var r=confirm("Are you sure you want to clear all your changes?");r&&(angular.copy(t.master,e.project),t.hasChanges=!1)},t.deleteProject=function(){var o=confirm("Are you sure you want to delete this project?");if(o){var i=e.project.id;n.remove(i).then(function(n){e.$emit("SIDEPANEL:REMOVE",{id:i}),r.go("main"),e.project={},t.hasChanges=!1,e.$broadcast("ALERT:FIRE",{title:"Project Removed Successfully",dur:5,type:"success"})},function(n){console.log("err",n),e.$emit("SIDEPANEL:REMOVE",{id:i}),r.go("main"),e.project={},t.hasChanges=!1})}},t.addViewport=function(){var e={active:!0,name:null,width:null,height:null};o("viewports",e)},t.addSelector=function(){var e={active:!0,type:"container",query:null};o("selectors",e)},t.addCookie=function(){var e={active:!0,name:null,value:null,path:null};o("cookies",e)},t.activateType=function(r,n){e.project[r][n].active=e.project[r][n].active===!0||"true"===e.project[r][n].active?!1:!0,t.save()},t.deleteTypeItem=function(r,n){e.project[r].splice(n,1),t.save()},t.clearHistory=function(){n.clearHistory(e.project).then(function(t){e.$broadcast("ALERT:FIRE",{title:"Cleared All History!",dur:5,type:"success",icon:"history"})},function(t){e.$broadcast("ALERT:FIRE",{title:"Error Occurred! Please try again.",dur:5,type:"error",icon:"stop"})})}}]);var fs=require("fs");MUG.controller("SidePanelCtrl",["$rootScope","$scope","$state","Projects",function(e,t,r,n){t.projects=[],t.projects=n.getAll(),e.$on("SIDEPANEL:NEWPROJECT",function(e,r){r&&r.id&&t.projects.unshift(r)}),e.$on("SIDEPANEL:UPDATE",function(e,r){r&&r.id&&t.projects.map(function(e,n){e.id===r.id&&(t.projects[n].title=r.title,t.projects[n].timestamp=r.timestamp,r.batchHistory[r.currentBatch]&&(r.batchHistory[r.currentBatch].success&&(t.projects[n].totals.success=r.batchHistory[r.currentBatch].success),r.batchHistory[r.currentBatch].warning&&(t.projects[n].totals.warning=r.batchHistory[r.currentBatch].warning),r.batchHistory[r.currentBatch].error&&(t.projects[n].totals.error=r.batchHistory[r.currentBatch].error),r.batchHistory[r.currentBatch].views&&(t.projects[n].totals.views=r.batchHistory[r.currentBatch].views)))})}),e.$on("SIDEPANEL:REMOVE",function(e,r){r&&r.id&&t.projects.map(function(e,n){e.id===r.id&&t.projects.splice(n,1)})}),t.goToProject=function(t){var n="runner";r.go("projects."+n,{id:t}),e.currentProjectId=t}}]),MUG.constant("Config",{ENV:"STAGE",STAGE:{},PROD:{},Compare:{errorColor:{red:255,green:0,blue:255},errorType:"flat",transparency:1,largeImageThreshold:0}}),MUG.config(["$stateProvider","$urlRouterProvider",function(e,t){e.state("main",{url:"/",templateUrl:"main.html"}).state("preferences",{url:"/preferences",templateUrl:"preferences.html",controller:"PreferencesCtrl"}).state("projects",{url:"/projects/:id",templateUrl:"projects.html",controller:"ProjectCtrl"}).state("projects.settings",{url:"/settings",templateUrl:"projects.settings.html",controller:"ProjectSettingsCtrl"}).state("projects.runner",{url:"/runner",templateUrl:"projects.runner.html",controller:"ProjectRunnerCtrl"}).state("projects.history",{url:"/history",templateUrl:"projects.history.html",controller:"ProjectHistoryCtrl"}),t.otherwise("/")}]),MUG.run(["$rootScope","$http",function(e,t){var r=t.defaults.headers.common;r["Content-Type"]="application/json",e.$on("$stateChangeError",function(e,t,r,n,o,i){console.log("$stateChangeError",i)})}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsImFsZXJ0LmpzIiwiZmFkZWluLmpzIiwibW9kYWwuanMiLCJtc2djZW50ZXIuanMiLCJwcmVsb2FkZXIuanMiLCJ0aW1lYWdvLmpzIiwiY29tcGFyZS5qcyIsIm5vd3RpbWUuanMiLCJwcm9qZWN0cy5qcyIsInRpbWUtYWdvLmpzIiwibWFpbmN0cmwuanMiLCJwcmVmZXJlbmNlc2N0cmwuanMiLCJwcm9qZWN0Y3RybC5qcyIsInByb2plY3RoaXN0b3J5Y3RybC5qcyIsInByb2plY3RydW5uZXJjdHJsLmpzIiwicHJvamVjdHNldHRpbmdzY3RybC5qcyIsInNpZGVwYW5lbGN0cmwuanMiLCJjb25maWcuanMiLCJyb3V0ZXMuanMiLCJpbml0LmpzIl0sIm5hbWVzIjpbIk1VRyIsImFuZ3VsYXIiLCJtb2R1bGUiLCJkaXJlY3RpdmUiLCIkcm9vdFNjb3BlIiwiJHRpbWVvdXQiLCIkY29tcGlsZSIsIiR0ZW1wbGF0ZUNhY2hlIiwicmVzdHJpY3QiLCJyZXBsYWNlIiwidGVtcGxhdGUiLCJzY29wZSIsImxpbmsiLCJlbCIsImF0dHJzIiwiY3RybCIsInNob3dNZXNzYWdlIiwiZGF0YSIsIl9pZCIsIkRhdGUiLCIkdG1wU2NvcGUiLCJ0aXRsZSIsImljb24iLCIkbmV3IiwiYWxlcnQiLCJpZCIsInR5cGUiLCJhY3Rpb24iLCJjYWxsYmFjayIsInRoaXMiLCJjbGVhckVsIiwiYWxlcnRFbCIsImFsZXJ0VGVtcGxhdGUiLCJwcmV2aW91c0lkIiwiX2VsIiwiYXBwZW5kIiwiYWRkQ2xhc3MiLCJhbGVydEFjdGl2ZSIsImFsZXJ0VmlzaWJsZSIsInRpbWVyIiwiZHVyYXRpb24iLCJlbGVtIiwiZWxlbWVudCIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJyZW1vdmVDbGFzcyIsInJlbW92ZSIsImdldCIsIiRvbiIsImUiLCJ3aW5kb3ciLCJjbGVhclRpbWVvdXQiLCJkdXIiLCJvZmZzZXQiLCJwYXJzZUludCIsImZhZGVJbiIsInNldFRpbWVvdXQiLCJjc3MiLCJ0ZW1wbGF0ZVVybCIsIiRzY29wZSIsIiRlbGVtZW50IiwiJGF0dHIiLCJzZXRBY3RpdmVJdGVtIiwiaW1hZ2VTcmMiLCJyZW1vdGVTb3VyY2UiLCJzb3VyY2UiLCJjb21wYXJlSXRlbSIsImEiLCJwcm9qZWN0IiwiY3VycmVudEJhdGNoIiwiY3VycmVudFJlZmVyZW5jZSIsImIiLCJjIiwibW9kYWxBY3RpdmUiLCJtb2RhbFZpc2libGUiLCJjb3B5IiwiYWN0aXZlT3B0aW9uIiwib3BhY2l0eVJhbmdlIiwiY3VycmVudEluZGV4IiwiYWN0aXZlSXRlbSIsInZpZXdlciIsIml0ZW1zIiwiYW1vdW50IiwiaW52ZXJzZSIsInBlcmNlbnQiLCIkd2F0Y2giLCJudiIsIm92IiwidG9GaXhlZCIsIk1hdGgiLCJyb3VuZCIsIm9wdGlvbk1vZGUiLCJhcmdzIiwiY2xvc2UiLCJpdGVtIiwibGVuZ3RoIiwibW9kYWxBY3Rpb25OYXYiLCJuZXh0SWR4IiwidG90YWwiLCJnb1RvSW5kZXgiLCJpZHgiLCJuZXdCb2R5IiwibXNnIiwibmV3SWNuIiwiZGVmYXVsdEljb24iLCJtc2dUZW1wbGF0ZSIsIm5ld01lc3NhZ2UiLCJtc2dFbCIsImZpbmQiLCJjaGFuZ2VUeXBlIiwiYm9keSIsImFjdGlvbkVsIiwiUCIsInJlcXVpcmUiLCJ1cGRhdGVQcmVsb2FkZXIiLCJwcmV2aW91c1RpdGxlIiwiQiIsImFuaW1hdGUiLCJyZXNldFByZWxvYWRlciIsImxvYWRpbmciLCJCcm93c2VyIiwiaW5pdCIsInF1ZXJ5U2VsZWN0b3IiLCJhcHBlbmRDaGlsZCIsImluc3RhbmNlIiwiZHJhd0Jyb3dzZXIiLCJ0aW1lQWdvIiwibm93VGltZSIsImZyb21UaW1lIiwiJG9ic2VydmUiLCJ2YWx1ZSIsInBhcnNlIiwiZ2V0VGltZSIsInRleHQiLCJpbldvcmRzIiwiZnMiLCJhc3luYyIsImZhY3RvcnkiLCIkcSIsIkNvbmZpZyIsInJlYWRBc3luYyIsImZpbGUiLCJyZWFkRmlsZSIsImZpbGVEaXJQcmVmaXgiLCJjb21wYXJlU2luZ2xlIiwiZGZkIiwiZGVmZXIiLCJvdXRwdXQiLCJyZXNlbWJsZSIsIm91dHB1dFNldHRpbmdzIiwiQ29tcGFyZSIsIm1hcCIsImVyciIsInJlc3VsdHMiLCJhRGF0YSIsImltYWdlUHJlZml4IiwiYkRhdGEiLCJyZWplY3QiLCJjb21wYXJlVG8iLCJpZ25vcmVDb2xvcnMiLCJvbkNvbXBsZXRlIiwiZGlmZkRhdGEiLCJyZXBvcnQiLCJzcmMiLCJnZXRJbWFnZURhdGFVcmwiLCJyZXNvbHZlIiwicHJvbWlzZSIsIl9fZGlybmFtZSIsInN0YXR1c1R5cGVzIiwicnVuU2luZ2xlIiwiZ2V0U3RhdHVzIiwibWlzTWF0Y2hWYWx1ZSIsInBhcnNlRmxvYXQiLCJtaXNNYXRjaFBlcmNlbnRhZ2UiLCJpc1NhbWVEaW1lbnNpb25zIiwibm93IiwidXBkYXRlVGltZSIsInBhdGgiLCJBV1MiLCJjcmVhdGVVVUlEIiwicyIsIkFycmF5Iiwiam9pbiIsIm4iLCJyYW5kb20iLCJTdHJpbmciLCJmcm9tQ2hhckNvZGUiLCJjcmVhdGVEdW1teVByb2plY3QiLCJwcm9qZWN0SWQiLCJ0aW1lc3RhbXAiLCJ0b3RhbHMiLCJzdWNjZXNzIiwid2FybmluZyIsImVycm9yIiwidmlld3MiLCJjcmVhdGVEdW1teVByb2plY3RGaWxlIiwib3B0aW9ucyIsImJhdGNoSGlzdG9yeSIsInZpZXdwb3J0cyIsInNlbGVjdG9ycyIsImNvb2tpZXMiLCJtZXRhIiwidXJsIiwicmVhZHlFdmVudCIsImRlbGF5IiwibWlzTWF0Y2hUaHJlc2hvbGQiLCJnZXRKc29uRmlsZSIsInJlYWRGaWxlU3luYyIsImNvZGUiLCJKU09OIiwicmVtb3ZlQWxsSW5EaXJlY3RvcnkiLCJkaXJQYXRoIiwiZmlsZXMiLCJyZWFkZGlyU3luYyIsImkiLCJmaWxlUGF0aCIsInN0YXRTeW5jIiwiaXNGaWxlIiwidW5saW5rU3luYyIsInJtRGlyIiwicHJvbWlzZVdyaXRlIiwiX3EiLCJ3cml0ZUZpbGUiLCJzdHJpbmdpZnkiLCJwcm9taXNlUmVtb3ZlIiwiX3oiLCJ1bmxpbmsiLCJwcm9qZWN0c1BhdGgiLCJwcm9qZWN0RmlsZXNQYXRoIiwiZ2V0QWxsIiwiZ2V0QnlJZCIsImdldFR5cGVCeUlkIiwiYWRkaXRpb24iLCJ2YWxpZGF0ZSIsImJvb2wiLCJvYmoiLCJ3aWR0aCIsImhlaWdodCIsIm5hbWUiLCJxdWVyeSIsImNyZWF0ZU5ldyIsImFsbFByb2plY3RzIiwibmV3UHJvamVjdERhdGEiLCJuZXdQcm9qZWN0RmlsZSIsInVuc2hpZnQiLCJzYXZlIiwicHJvamVjdERhdGEiLCJzcGxpY2UiLCJjbGVhckhpc3RvcnkiLCJtYWluUHJvamVjdHMiLCJjbGVhbkltYWdlRmlsZXMiLCJzeW5jIiwiX3RoaXMiLCJkIiwicHJvamVjdEZpbGVzIiwicmVhZHlGaWxlcyIsInRtcEZpbGUiLCJzZWFyY2giLCJwdXNoIiwia2V5IiwidXBsb2FkIiwidGhlbiIsInJlcyIsImNsZWFuQWZ0ZXJTeW5jIiwibmV3UmVmcyIsImRmZGQiLCJoaXN0b3J5RGF0YSIsInVwZGF0ZWRSZW1vdGVGaWxlcyIsInF1ZXVlUHJvbWlzZXMiLCJ1cGRhdGVkQXQiLCJ0bXBTcmMiLCJ0bXBSZWYiLCJzcGxpdCIsInRtcFR5cGUiLCJ0bXBBbGlhcyIsInJlbVJlZlBhdGgiLCJyZW1SZWYiLCJyZW1SZWZEaWZmIiwicHJvamVjdEZpbGUiLCJwcm9qZWN0SGlzdG9yeUZpbGUiLCJwcm9qZWN0V3JpdGUiLCJwcm9qZWN0SGlzdG9yeVdyaXRlIiwiYXdzVXBsb2FkIiwiYWxsIiwiYmFzZSIsImNvbXBzIiwicmVmcyIsInRyaW1EaWdpdHMiLCJudW0iLCJtIiwidG9TdHJpbmciLCJzbGljZSIsInNlcnZpY2UiLCJzZXR0aW5ncyIsInJlZnJlc2hNaWxsaXMiLCJhbGxvd0Z1dHVyZSIsInN0cmluZ3MiLCJwcmVmaXhBZ28iLCJwcmVmaXhGcm9tTm93Iiwic3VmZml4QWdvIiwic3VmZml4RnJvbU5vdyIsInNlY29uZHMiLCJtaW51dGUiLCJtaW51dGVzIiwiaG91ciIsImhvdXJzIiwiZGF5IiwiZGF5cyIsIm1vbnRoIiwibW9udGhzIiwieWVhciIsInllYXJzIiwibnVtYmVycyIsImRpc3RhbmNlTWlsbGlzIiwic3Vic3RpdHV0ZSIsInN0cmluZ09yRnVuY3Rpb24iLCJudW1iZXIiLCJzdHJpbmciLCJpc0Z1bmN0aW9uIiwiJGwiLCJwcmVmaXgiLCJzdWZmaXgiLCJhYnMiLCJ3b3JkcyIsInNlcGFyYXRvciIsInVuZGVmaW5lZCIsIndvcmRTZXBhcmF0b3IiLCJ0cmltIiwiaXNvODYwMSIsImlzTnVtYmVyIiwib3JpZ2luYWxUaW1lc3RhbXAiLCJmaWx0ZXIiLCJkaWZmIiwiaXBjIiwiY29udHJvbGxlciIsIiRzdGF0ZSIsIlByb2plY3RzIiwiY3VycmVudFByb2plY3RJZCIsImNyZWF0ZU5ld1Byb2plY3QiLCIkYnJvYWRjYXN0IiwiZ28iLCJjb25zb2xlIiwibG9nIiwib24iLCJsb2NhdGlvbiIsIlNhZmVBcHBseSIsImZuIiwiJCRwaGFzZSIsIiRyb290IiwiJGFwcGx5IiwiYXdzQ29uZmlnIiwiYnVja2V0IiwiYWNjZXNzS2V5SWQiLCJzZWNyZXRBY2Nlc3NLZXkiLCJnZXRDb25maWciLCJzZXRDb25maWciLCIkc3RhdGVQYXJhbXMiLCJhY3RpdmVGaWx0ZXIiLCJhY3RpdmVGaWx0ZXJRdWVyeSIsImhpc3RvcnlJdGVtcyIsImNoYW5nZUZpbHRlciIsInByZXZpZXdJdGVtIiwiJGVtaXQiLCJwcm9jZXNzQmF0Y2giLCJhbGxEYXRhIiwicGxhY2VJdGVtIiwic3RhdHVzIiwidGFyZ2V0IiwiZm9ybWF0dGVkIiwiYWN0aXZlRGF0YSIsImhhc1JlZmVyZW5jZSIsImJhdGNoIiwic2V0dXBDdXJyZW50QmF0Y2giLCJiYXRjaEl0ZW1zIiwicnVubmluZ1R5cGUiLCJ2YWxpZGF0ZVByb2plY3QiLCJpc1ZhbGlkIiwiY2hlY2tTdGF0ZSIsImhhc1NldHRpbmdzIiwiaGFzQ29tcGFyZSIsImdyYWJMYXRlc3REYXRhIiwic3luY1Byb2plY3QiLCJhdXRvU3luY0F3cyIsInN5bmNpbmciLCJydW5uZXJFdmVudHMiLCJwcm9ncmVzcyIsInJ1bm5lckNvbXBsZXRlIiwicHJvY2Vzc2luZyIsInJ1bm5lckZhaWxlZCIsInJlYXNvbiIsImRlZmF1bHRGb3JtYXQiLCJwcmV2aWV3QmF0Y2giLCJuZXdDb21wYXJlIiwidmFsaWQiLCJzZW5kIiwibmV3UmVmZXJlbmNlIiwiYWRkTmV3VHlwZSIsImNoZWNrQXdzU2V0dGluZ3MiLCJzYXZlVGltZXIiLCJzZWxlY3RvclR5cGVzIiwiaGFzQ2hhbmdlcyIsImhhc0F3c1NldHRpbmdzIiwibWFzdGVyIiwiblYiLCJvViIsInN5bmNOb3ciLCJjYW5jZWxTYXZlIiwic3VyZSIsImNvbmZpcm0iLCJkZWxldGVQcm9qZWN0IiwicHJvamVjdElEIiwiYWRkVmlld3BvcnQiLCJuZXdWaWV3cG9ydCIsImFjdGl2ZSIsImFkZFNlbGVjdG9yIiwibmV3U2VsZWN0b3IiLCJhZGRDb29raWUiLCJuZXdDb29raWUiLCJhY3RpdmF0ZVR5cGUiLCJkZWxldGVUeXBlSXRlbSIsInByb2plY3RzIiwiZ29Ub1Byb2plY3QiLCJjb25zdGFudCIsIkVOViIsIlNUQUdFIiwiUFJPRCIsImVycm9yQ29sb3IiLCJyZWQiLCJncmVlbiIsImJsdWUiLCJlcnJvclR5cGUiLCJ0cmFuc3BhcmVuY3kiLCJsYXJnZUltYWdlVGhyZXNob2xkIiwiY29uZmlnIiwiJHN0YXRlUHJvdmlkZXIiLCIkdXJsUm91dGVyUHJvdmlkZXIiLCJzdGF0ZSIsIm90aGVyd2lzZSIsInJ1biIsIiRodHRwIiwiJGNvbW1vbiIsImRlZmF1bHRzIiwiaGVhZGVycyIsImNvbW1vbiIsImV2ZW50IiwidG9TdGF0ZSIsInRvUGFyYW1zIiwiZnJvbVN0YXRlIiwiZnJvbVBhcmFtcyJdLCJtYXBwaW5ncyI6IkFBQUEsR0FBQUEsS0FBQUMsUUFBQUMsT0FBQSxXQUFBLFlBQUEsZ0JDbUJBRixLQUFBRyxVQUFBLFNBQ0EsYUFBQSxXQUFBLFdBQUEsaUJBQ0EsU0FBQUMsRUFBQUMsRUFBQUMsRUFBQUMsR0FDQSxPQUNBQyxTQUFBLElBQ0FDLFNBQUEs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QUEsT0FDQUMsYUFBQSxFQUNBQyxvQkFBQSxLQ2pCQWhiLElBQUFpYixRQUNBLGlCQUFBLHFCQUNBLFNBQUFDLEVBQUFDLEdBU0FELEVBS0FFLE1BQUEsUUFDQTFPLElBQUEsSUFDQWhKLFlBQUEsY0FFQTBYLE1BQUEsZUFDQTFPLElBQUEsZUFDQWhKLFlBQUEsbUJBQ0FvUixXQUFBLG9CQU1Bc0csTUFBQSxZQUNBMU8sSUFBQSxnQkFDQWhKLFlBQUEsZ0JBQ0FvUixXQUFBLGdCQUVBc0csTUFBQSxxQkFDQTFPLElBQUEsWUFDQWhKLFlBQUEseUJBQ0FvUixXQUFBLHdCQUVBc0csTUFBQSxtQkFDQTFPLElBQUEsVUFDQWhKLFlBQUEsdUJBQ0FvUixXQUFBLHNCQUVBc0csTUFBQSxvQkFDQTFPLElBQUEsV0FDQWhKLFlBQUEsd0JBQ0FvUixXQUFBLHVCQXNCQXFHLEVBQUFFLFVBQUEsUUNyRUFyYixJQUFBc2IsS0FBQSxhQUFBLFFBQ0EsU0FBQWxiLEVBQUFtYixHQUdBLEdBQUFDLEdBQUFELEVBQUFFLFNBQUFDLFFBQUFDLE1BQ0FILEdBQUEsZ0JBQUEsbUJBRUFwYixFQUFBNEMsSUFBQSxvQkFBQSxTQUFBNFksRUFBQUMsRUFBQUMsRUFBQUMsRUFBQUMsRUFBQS9QLEdBQ0FvSixRQUFBQyxJQUFBLG9CQUFBckoiLCJmaWxlIjoibXVnLmpzIiwic291cmNlc0NvbnRlbnQiOlsidmFyIE1VRyA9IGFuZ3VsYXIubW9kdWxlKCdtdWdzaG90JywgWyd1aS5yb3V0ZXInLCAnbXVndGVtcGxhdGVzJ10pO1xuIiwiLyoqXG4gKiBhbGVydFxuICogYSBkaXJlY3RpdmUgZm9yIGhhbmRsaW5nIGFsbCBhbGVydHMgYW5kIG5vdGljZXMgZm9yIGEgdXNlclxuICpcbiAqIFVTRTpcbiAqIDxhbGVydD48L2FsZXJ0PlxuICpcbiAqICRyb290U2NvcGUuJGJyb2FkY2FzdCgnQUxFUlQ6RklSRScsIHsgdGl0bGU6IFwiSGV5IHRoZXJlLCBJbSBhIG1lc3NhZ2UhIVwiLCBkdXI6IDUsIHR5cGU6IFwiaW5mb1wiLCBpY29uOiBcImluZm9cIiwgY2FsbGJhY2s6IGZ1bmN0aW9uKCl7fSB9KTtcbiAqXG4gKiBUWVBFUzpcbiAqIC0gaW5mbywgc3VjY2Vzcywgd2FybmluZywgZXJyb3JcbiAqXG4gKiBPUFRJT05TOlxuICogLSB0aXRsZTogdGhlIGNvbnRlbnRzIG9mIHRoZSBtZXNzYWdlLCAoVE9ETzogY2FuIGJlIGh0bWwgb3Igc2ltcGxlIHRleHQpXG4gKiAtIGNhbGxiYWNrOiBhIGZ1bmN0aW9uIHRvIGZpcmUgb24gYWN0aW9uIHRha2VuIG9uIG1lc3NhZ2VcbiAqIC0gZHVyOiB0aGUgdGltZW91dCBvZiB0aGUgbWVzc2FnZSwgaW4gc2Vjb25kc1xuICogLSB0eXBlOiBzZWUgYWJvdmUgdHlwZXNcbiAqIC0gaWNvbjogbm8gZGVmYXVsdCwgc2VlIGh0dHBzOi8vb2N0aWNvbnMuZ2l0aHViLmNvbS8gZm9yIG9wdGlvbnNcbiAqL1xuTVVHLmRpcmVjdGl2ZSgnYWxlcnQnLFxuWyckcm9vdFNjb3BlJywgJyR0aW1lb3V0JywgJyRjb21waWxlJywgJyR0ZW1wbGF0ZUNhY2hlJyxcbmZ1bmN0aW9uKCRyb290U2NvcGUsICR0aW1lb3V0LCAkY29tcGlsZSwgJHRlbXBsYXRlQ2FjaGUpIHtcbiAgcmV0dXJuIHtcbiAgICByZXN0cmljdDogJ0UnLFxuICAgIHJlcGxhY2U6IHRydWUsXG4gICAgdGVtcGxhdGU6ICc8ZGl2IGNsYXNzPVwiYWxlcnQtcGFyZW50XCI+PC9kaXY+JyxcbiAgICBzY29wZToge30sXG4gICAgbGluazogZnVuY3Rpb24oc2NvcGUsIGVsLCBhdHRycywgY3RybCkge1xuICAgICAgdmFyIGFsZXJ0VGVtcGxhdGUgPSAkdGVtcGxhdGVDYWNoZS5nZXQoJ2FsZXJ0Lmh0bWwnKTtcbiAgICAgIHZhciBfZWwgPSBhbmd1bGFyLmVsZW1lbnQoZWwpO1xuICAgICAgdmFyIHRpbWVyO1xuICAgICAgdmFyIGR1cmF0aW9uID0gNTAwMDtcbiAgICAgIHZhciBwcmV2aW91c0lkID0gJyc7XG4gICAgICB2YXIgYWxlcnRBY3RpdmUgPSAnYWxlcnQtYWN0aXZlJztcbiAgICAgIHZhciBhbGVydFZpc2libGUgPSAnYWxlcnQtdmlzaWJsZSc7XG5cbiAgICAgIGZ1bmN0aW9uIHNob3dNZXNzYWdlKGRhdGEpIHtcbiAgICAgICAgdmFyIF9pZCA9ICgrbmV3IERhdGUoKSk7XG4gICAgICAgIHZhciBuZXdCb2R5ID0gZGF0YS50aXRsZTtcbiAgICAgICAgdmFyIG5ld0ljbiA9IChkYXRhLmljb24pID8gZGF0YS5pY29uIDogbnVsbDtcbiAgICAgICAgdmFyICR0bXBTY29wZSA9ICRyb290U2NvcGUuJG5ldyh0cnVlKTtcblxuICAgICAgICAvLyBzZXR1cCBzaW1wbGUgc2NvcGUgZm9yIG9ubHkgdGhpcyBhbGVydCBpdGVtXG4gICAgICAgICR0bXBTY29wZS5hbGVydCA9IHt9O1xuICAgICAgICAkdG1wU2NvcGUuYWxlcnQuaWQgPSBfaWQ7XG4gICAgICAgICR0bXBTY29wZS5hbGVydC5pY29uID0gKGRhdGEuaWNvbikgPyBkYXRhLmljb24gOiBudWxsO1xuICAgICAgICAkdG1wU2NvcGUuYWxlcnQudHlwZSA9IChkYXRhLnR5cGUpID8gZGF0YS50eXBlIDogJ2luZm8nO1xuICAgICAgICAkdG1wU2NvcGUuYWxlcnQudGl0bGUgPSBkYXRhLnRpdGxlO1xuICAgICAgICAkdG1wU2NvcGUuYWxlcnQuYWN0aW9uID0gKCFkYXRhLmNhbGxiYWNrKSA/IG51bGwgOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICB2YXIgYWN0aW9uRWwgPSB0aGlzLmlkO1xuICAgICAgICAgIGRhdGEuY2FsbGJhY2soKTtcbiAgICAgICAgICBjbGVhckVsKHRoaXMpO1xuICAgICAgICB9O1xuXG4gICAgICAgIHZhciBhbGVydEVsID0gJGNvbXBpbGUoYWxlcnRUZW1wbGF0ZSkoJHRtcFNjb3BlKTtcblxuICAgICAgICAvLyBzZXQgYSB1bmlxdWUgaWRcbiAgICAgICAgYWxlcnRFbFswXS5pZCA9IF9pZDtcbiAgICAgICAgcHJldmlvdXNJZCA9IF9pZDtcblxuICAgICAgICAvLyB0aHJvdyBpbnRvIGRvbSwgdGhlbiBzaG93IGluIHZpZXcsIHN0YXJ0IHRpbWVyXG4gICAgICAgIF9lbC5hcHBlbmQoYWxlcnRFbCk7XG4gICAgICAgIGFsZXJ0RWwuYWRkQ2xhc3MoYWxlcnRBY3RpdmUpO1xuXG4gICAgICAgIC8vIHNob3dcbiAgICAgICAgJHRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgYWxlcnRFbC5hZGRDbGFzcyhhbGVydFZpc2libGUpO1xuICAgICAgICB9LCAyMCk7XG5cbiAgICAgICAgdGltZXIgPSAkdGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgICBjbGVhckVsKGFsZXJ0RWwpO1xuICAgICAgICB9LCBkdXJhdGlvbik7XG4gICAgICB9XG5cbiAgICAgIGZ1bmN0aW9uIGNsZWFyRWwoZWxlbSkge1xuICAgICAgICBpZiAoIWVsZW0gJiYgcHJldmlvdXNJZCkge1xuICAgICAgICAgIGVsZW0gPSBhbmd1bGFyLmVsZW1lbnQoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQocHJldmlvdXNJZCkpO1xuICAgICAgICB9IGVsc2UgaWYgKCFlbGVtKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9IGVsc2UgaWYgKGVsZW0pIHtcbiAgICAgICAgICBlbGVtID0gYW5ndWxhci5lbGVtZW50KGVsZW0pO1xuICAgICAgICB9XG5cbiAgICAgICAgZWxlbS5yZW1vdmVDbGFzcyhhbGVydFZpc2libGUpO1xuICAgICAgICAkdGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgICBlbGVtLnJlbW92ZSgpO1xuICAgICAgICB9LCAzMDApO1xuICAgICAgfVxuXG4gICAgICAkcm9vdFNjb3BlLiRvbignQUxFUlQ6RklSRScsIGZ1bmN0aW9uKGUsIGRhdGEpIHtcbiAgICAgICAgaWYgKCFkYXRhLnRpdGxlKSB7IHJldHVybjsgfVxuXG4gICAgICAgIHdpbmRvdy5jbGVhclRpbWVvdXQodGltZXIpO1xuICAgICAgICBjbGVhckVsKCk7XG5cbiAgICAgICAgaWYgKGRhdGEuZHVyKSB7XG4gICAgICAgICAgZHVyYXRpb24gPSBkYXRhLmR1ciAqIDEwMDA7XG4gICAgICAgIH1cblxuICAgICAgICBzaG93TWVzc2FnZShkYXRhKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfTtcbn1dKTtcbiIsIi8qKlxuICogZmFkZUluXG4gKiBBIGRpcmVjdGl2ZSBmb3IgYW5pbWF0aW5nIGluIGVsZW1lbnRzXG4gKi9cbk1VRy5kaXJlY3RpdmUoJ2ZhZGVJbicsIFtmdW5jdGlvbigpIHtcbiAgcmV0dXJuIHtcbiAgICByZXN0cmljdDogJ0EnLFxuICAgIGxpbms6IGZ1bmN0aW9uKHNjb3BlLCBlbGVtLCBhdHRycykge1xuICAgICAgdmFyIG9mZnNldCA9IHBhcnNlSW50KGF0dHJzLmZhZGVJbikgfHwgMTA7XG4gICAgICBlbGVtLmFkZENsYXNzKCdmYWRlLWluJyk7XG5cbiAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgIGVsZW0uY3NzKCdvcGFjaXR5JywgJzEnKTtcbiAgICAgIH0sIG9mZnNldCk7XG4gICAgfVxuICB9O1xuXG59XSk7XG4iLCIvKipcbiAqIE1vZGFsXG4gKiBCdWlsZHMgYSBtb2RhbCBmb3IgaW1hZ2Ugdmlld2luZyBhbmQgY29tcGFyaW5nXG4gKlxuICogQHVzYWdlXG4gKiA8bW9kYWw+PC9tb2RhbD5cbiAqL1xuTVVHLmRpcmVjdGl2ZSgnbW9kYWwnLFxuWyckdGltZW91dCcsICckY29tcGlsZScsICckcm9vdFNjb3BlJyxcbmZ1bmN0aW9uKCR0aW1lb3V0LCAkY29tcGlsZSwgJHJvb3RTY29wZSkge1xuICByZXR1cm4ge1xuICAgIHJlc3RyaWN0OiAnRScsXG4gICAgcmVwbGFjZTogdHJ1ZSxcbiAgICB0ZW1wbGF0ZVVybDogJ21vZGFsLmh0bWwnLFxuICAgIHNjb3BlOiB7fSxcbiAgICBsaW5rOiBmdW5jdGlvbigkc2NvcGUsICRlbGVtZW50LCAkYXR0cikge1xuICAgICAgdmFyIG1vZGFsQWN0aXZlID0gJ21vZGFsLW9wZW4nO1xuICAgICAgdmFyIG1vZGFsVmlzaWJsZSA9ICdtb2RhbC12aXNpYmxlJztcblxuICAgICAgJHNjb3BlLnByb2plY3QgPSBhbmd1bGFyLmNvcHkoJHJvb3RTY29wZS5wcm9qZWN0KTtcbiAgICAgICRzY29wZS5hY3RpdmVPcHRpb24gPSAnc2lkZXMnO1xuICAgICAgJHNjb3BlLm9wYWNpdHlSYW5nZSA9IHt9O1xuICAgICAgJHNjb3BlLmN1cnJlbnRJbmRleCA9IDA7XG4gICAgICAkc2NvcGUuYWN0aXZlSXRlbSA9IHt9O1xuICAgICAgJHNjb3BlLmNvbXBhcmVJdGVtID0ge1xuICAgICAgICBhOiAnJyxcbiAgICAgICAgYjogJycsXG4gICAgICAgIGM6ICcnXG4gICAgICB9O1xuICAgICAgJHNjb3BlLnZpZXdlciA9IHtcbiAgICAgICAgaXRlbXM6IFtdXG4gICAgICB9O1xuICAgICAgJHNjb3BlLm9wYWNpdHlSYW5nZSA9IHtcbiAgICAgICAgYW1vdW50OiAwLjgsXG4gICAgICAgIGludmVyc2U6IDAuMixcbiAgICAgICAgcGVyY2VudDogJzgwJSdcbiAgICAgIH07XG5cbiAgICAgICRzY29wZS4kd2F0Y2goJ29wYWNpdHlSYW5nZS5hbW91bnQnLCBmdW5jdGlvbihudiwgb3YpIHtcbiAgICAgICAgaWYgKG52ID09PSBvdikge3JldHVybjt9XG5cbiAgICAgICAgLy8gdXBkYXRlIHRoZSBvdGhlciB2YWx1ZXNcbiAgICAgICAgJHNjb3BlLm9wYWNpdHlSYW5nZS5pbnZlcnNlID0gKDEgLSBudikudG9GaXhlZCgyKTtcbiAgICAgICAgJHNjb3BlLm9wYWNpdHlSYW5nZS5wZXJjZW50ID0gTWF0aC5yb3VuZChudiAqIDEwMCkgKyAnJSc7XG4gICAgICB9KTtcblxuICAgICAgLy8gc2V0IHRoZSBhY3RpdmUgaXRlbSB3aXRoIGNvcnJlY3QgcGF0aHNcbiAgICAgIGZ1bmN0aW9uIHNldEFjdGl2ZUl0ZW0oZGF0YSkge1xuICAgICAgICB2YXIgaW1hZ2VTcmMgPSAoIWRhdGEucmVtb3RlU291cmNlKSA/IGRhdGEuc291cmNlIDogZGF0YS5yZW1vdGVTb3VyY2U7XG4gICAgICAgICRzY29wZS5jb21wYXJlSXRlbS5hID0gKCFkYXRhLnJlbW90ZVNvdXJjZSkgPyAnc2NyZWVucy9yZWZlcmVuY2UvJyArICRyb290U2NvcGUucHJvamVjdC5pZCArICcvJyArIGltYWdlU3JjLnJlcGxhY2UoJHJvb3RTY29wZS5wcm9qZWN0LmN1cnJlbnRCYXRjaCArICcucG5nJywgJHJvb3RTY29wZS5wcm9qZWN0LmN1cnJlbnRSZWZlcmVuY2UgKyAnLnBuZycpIDogaW1hZ2VTcmM7XG4gICAgICAgICRzY29wZS5jb21wYXJlSXRlbS5iID0gKCFkYXRhLnJlbW90ZVNvdXJjZSkgPyAnc2NyZWVucy9jb21wYXJlLycgKyAkcm9vdFNjb3BlLnByb2plY3QuaWQgKyAnLycgKyBpbWFnZVNyYyA6IGltYWdlU3JjO1xuICAgICAgICAkc2NvcGUuY29tcGFyZUl0ZW0uYyA9ICghZGF0YS5yZW1vdGVTb3VyY2UpID8gJ3NjcmVlbnMvY29tcGFyZS8nICsgJHJvb3RTY29wZS5wcm9qZWN0LmlkICsgJy8nICsgaW1hZ2VTcmMucmVwbGFjZSgnLnBuZycsICdfZGlmZi5wbmcnKSA6IGltYWdlU3JjO1xuICAgICAgfVxuXG4gICAgICAvLyBDaG9vc2UgdGhlIHZpZXdlciBsYXlvdXRcbiAgICAgICRzY29wZS5vcHRpb25Nb2RlID0gZnVuY3Rpb24odHlwZSkge1xuICAgICAgICAkc2NvcGUuYWN0aXZlT3B0aW9uID0gdHlwZTtcbiAgICAgIH07XG5cbiAgICAgICRyb290U2NvcGUuJG9uKCdNT0RBTDpDTE9TRScsIGZ1bmN0aW9uKGUsIGFyZ3MpIHtcbiAgICAgICAgJHNjb3BlLmNsb3NlKCk7XG4gICAgICB9KTtcblxuICAgICAgJHJvb3RTY29wZS4kb24oJ01PREFMOk9QRU4nLCBmdW5jdGlvbihlLCBhcmdzKSB7XG4gICAgICAgIGlmICghYXJncyB8fCAhYXJncy50eXBlKSB7IHJldHVybjsgfVxuXG4gICAgICAgIC8vIE1ha2Ugc3VyZSB0byByZXNldCBjdXJyZW50IEluZGV4XG4gICAgICAgICRzY29wZS5jdXJyZW50SW5kZXggPSAwO1xuICAgICAgICAkc2NvcGUucHJvamVjdCA9IGFuZ3VsYXIuY29weSgkcm9vdFNjb3BlLnByb2plY3QpO1xuXG4gICAgICAgIC8vIFNob3cgYSBzaW5nbGUgaXRlbVxuICAgICAgICBpZiAoYXJncy50eXBlID09PSAncHJldmlldycpIHtcbiAgICAgICAgICAkc2NvcGUuYWN0aXZlSXRlbSA9IGFyZ3MuaXRlbTtcbiAgICAgICAgICAkc2NvcGUudmlld2VyID0gYXJncy5wcm9qZWN0IHx8IHt9O1xuICAgICAgICAgICRzY29wZS52aWV3ZXIuaXRlbXMgPSBudWxsO1xuXG4gICAgICAgICAgaWYgKCRzY29wZS5hY3RpdmVJdGVtLnJlbW90ZVNvdXJjZSkge1xuICAgICAgICAgICAgJHNjb3BlLmNvbXBhcmVJdGVtLmEgPSAkc2NvcGUuYWN0aXZlSXRlbS5yZW1vdGVTb3VyY2U7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICRzY29wZS5jb21wYXJlSXRlbS5hID0gJ3NjcmVlbnMvJyArICRzY29wZS5hY3RpdmVJdGVtLnR5cGUgKyAnLycgKyAkcm9vdFNjb3BlLnByb2plY3QuaWQgKyAnLycgKyAkc2NvcGUuYWN0aXZlSXRlbS5zb3VyY2U7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gU2hvdyBtdWx0aXBsZSBpdGVtc1xuICAgICAgICBpZiAoYXJncy50eXBlID09PSAnYmF0Y2gnICYmIGFyZ3MuaXRlbXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICRzY29wZS5hY3RpdmVJdGVtID0gYXJncy5pdGVtc1skc2NvcGUuY3VycmVudEluZGV4XTtcbiAgICAgICAgICAkc2NvcGUudmlld2VyID0gYXJncy5wcm9qZWN0IHx8IHt9O1xuICAgICAgICAgICRzY29wZS52aWV3ZXIuaXRlbXMgPSBhcmdzLml0ZW1zO1xuICAgICAgICAgIHNldEFjdGl2ZUl0ZW0oJHNjb3BlLmFjdGl2ZUl0ZW0pO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gbWFrZSB0aGUgbW9kYWwgYWN0aXZlIHdpdGggZGF0YVxuICAgICAgICAkZWxlbWVudC5hZGRDbGFzcyhtb2RhbEFjdGl2ZSk7XG5cbiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgICAkZWxlbWVudC5hZGRDbGFzcyhtb2RhbFZpc2libGUpO1xuICAgICAgICB9LCAzMCk7XG4gICAgICB9KTtcblxuICAgICAgJHNjb3BlLmNsb3NlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICRlbGVtZW50LnJlbW92ZUNsYXNzKG1vZGFsVmlzaWJsZSk7XG5cbiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgICAkZWxlbWVudC5yZW1vdmVDbGFzcyhtb2RhbEFjdGl2ZSk7XG4gICAgICAgIH0sIDIzMCk7XG4gICAgICB9O1xuXG4gICAgICAvLyBTZXR1cCBvZiBsZWZ0L3JpZ2h0IG5hdmlnYXRpb25cbiAgICAgICRzY29wZS5tb2RhbEFjdGlvbk5hdiA9IGZ1bmN0aW9uKHR5cGUpIHtcbiAgICAgICAgaWYgKCRzY29wZS52aWV3ZXIuaXRlbXMubGVuZ3RoIDwgMSkgeyByZXR1cm47IH1cblxuICAgICAgICB2YXIgdG90YWwgPSAkc2NvcGUudmlld2VyLml0ZW1zLmxlbmd0aCAtIDE7XG4gICAgICAgIHZhciBuZXh0SWR4O1xuXG4gICAgICAgIGlmICh0eXBlID09PSAncmlnaHQnKSB7XG4gICAgICAgICAgbmV4dElkeCA9ICgkc2NvcGUuY3VycmVudEluZGV4ID09PSB0b3RhbCkgPyAwIDogJHNjb3BlLmN1cnJlbnRJbmRleCArIDE7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgbmV4dElkeCA9ICgkc2NvcGUuY3VycmVudEluZGV4ID09PSAwKSA/IHRvdGFsIDogJHNjb3BlLmN1cnJlbnRJbmRleCAtIDE7XG4gICAgICAgIH1cblxuICAgICAgICAkc2NvcGUuYWN0aXZlSXRlbSA9ICRzY29wZS52aWV3ZXIuaXRlbXNbbmV4dElkeF07XG4gICAgICAgICRzY29wZS5jdXJyZW50SW5kZXggPSBuZXh0SWR4O1xuICAgICAgICBzZXRBY3RpdmVJdGVtKCRzY29wZS5hY3RpdmVJdGVtKTtcbiAgICAgIH07XG5cbiAgICAgIC8vIEdvIGRpcmVjdGx5IHRvIGFuIGl0ZW1cbiAgICAgICRzY29wZS5nb1RvSW5kZXggPSBmdW5jdGlvbihpZHgpIHtcbiAgICAgICAgaWYgKCRzY29wZS5jdXJyZW50SW5kZXggPT09IGlkeCkge3JldHVybjt9XG5cbiAgICAgICAgJHNjb3BlLmFjdGl2ZUl0ZW0gPSAkc2NvcGUudmlld2VyLml0ZW1zW2lkeF07XG4gICAgICAgICRzY29wZS5jdXJyZW50SW5kZXggPSBpZHg7XG4gICAgICAgIHNldEFjdGl2ZUl0ZW0oJHNjb3BlLmFjdGl2ZUl0ZW0pO1xuICAgICAgfTtcblxuICAgIH1cbiAgfTtcbn1dKTtcbiIsIi8qKlxuICogbXNnQ2VudGVyXG4gKiBhIGRpcmVjdGl2ZSBmb3IgaGFuZGxpbmcgYWxsIG1lc3NhZ2UgcmVsYXkgZm9yIGEgdXNlclxuICpcbiAqIFVTRTpcbiAqICRyb290U2NvcGUuJGJyb2FkY2FzdCgnTVNHQ0VOVEVSOkZJUkUnLCB7IG1zZzogXCJIZXkgdGhlcmUsIEltIGEgbWVzc2FnZSEhXCIsIGR1cjogNSwgdHlwZTogXCJpbmZvXCIsIGljb246IFwiaW5mb1wiLCBjYWxsYmFjazogZnVuY3Rpb24oKXt9IH0pO1xuICpcbiAqIFRZUEVTOlxuICogLSBERUZBVUxULCBzaG93cyBncmVlbiBtZXNzYWdlLCB1c2VkIGZvciBzdWNjZXNzXG4gKiAtIFdhcm5pbmc6IFwid2FyblwiIC0gc2hvd3Mgb3JhbmdlIG1lc3NhZ2UsIHVzZWQgZm9yIGVycm9ycyBvciB3YXJuaW5nc1xuICogLSBJbmZvOiBcImluZm9cIiAtIHNob3dzIGRhcmsgYmx1ZSBtZXNzYWdlLCB1c2VkIGZvciBnZW5lcmFsIHRoaW5nc1xuICpcbiAqIE9QVElPTlM6XG4gKiAtIG1zZzogdGhlIGNvbnRlbnRzIG9mIHRoZSBtZXNzYWdlLCAoVE9ETzogY2FuIGJlIGh0bWwgb3Igc2ltcGxlIHRleHQpXG4gKiAtIGNhbGxiYWNrOiBhIGZ1bmN0aW9uIHRvIGZpcmUgb24gYWN0aW9uIHRha2VuIG9uIG1lc3NhZ2VcbiAqIC0gZHVyOiB0aGUgdGltZW91dCBvZiB0aGUgbWVzc2FnZVxuICogLSB0eXBlOiBzZWUgYWJvdmUgdHlwZXNcbiAqIC0gaWNvbjogZGVmYXVsdCBpcyBnbG9iZSwgY2FuIGJlIHNldCB0byBBTlkgaS1zcHJpdGVzIChzcHJpdGVzLmxlc3MpXG4gKi9cbk1VRy5kaXJlY3RpdmUoJ21zZ0NlbnRlcicsXG5bIFwiJHJvb3RTY29wZVwiLCBcIiR0aW1lb3V0XCIsIFwiJGNvbXBpbGVcIixcbmZ1bmN0aW9uICgkcm9vdFNjb3BlLCAkdGltZW91dCwgJGNvbXBpbGUpIHtcbiAgcmV0dXJuIHtcbiAgICBzY29wZToge30sXG4gICAgbGluazogZnVuY3Rpb24gKHNjb3BlLCBlbCwgYXR0cnMsIGN0cmwpIHtcbiAgICAgIHZhciBtc2dUZW1wbGF0ZSA9ICc8ZGl2IGNsYXNzPVwibXNnXCIgbmctY2xpY2s9XCJhY3Rpb24oKVwiPicrXG4gICAgICAgICAgJzxkaXYgY2xhc3M9XCJtc2ctaWNuXCI+PGkgY2xhc3M9XCJpdyBpLUlDT05cIj48L2k+PC9kaXY+JytcbiAgICAgICAgICAnPGRpdiBjbGFzcz1cIm1zZy1jb250XCI+Qk9EWTwvZGl2PicrXG4gICAgICAgICAgJzxkaXYgY2xhc3M9XCJtc2ctYWN0aW9uXCI+PGkgY2xhc3M9XCJpYiBpLXItYXJyb3dcIj48L2k+PC9kaXY+JytcbiAgICAgICAgJzwvZGl2Pic7XG5cbiAgICAgIHZhciBfZWwgPSBhbmd1bGFyLmVsZW1lbnQoZWwpO1xuICAgICAgdmFyIHRpbWVyO1xuICAgICAgdmFyIGR1cmF0aW9uID0gNTAwMDtcbiAgICAgIHZhciBwcmV2aW91c0lkID0gXCJcIjtcbiAgICAgIHZhciBkZWZhdWx0SWNvbiA9IFwiaW5mb1wiO1xuXG4gICAgICBzY29wZS5ib2R5ID0gXCJcIjtcbiAgICAgIHNjb3BlLmNhbGxiYWNrID0gbnVsbDtcbiAgICAgIHNjb3BlLmljb24gPSBkZWZhdWx0SWNvbjtcbiAgICAgIHNjb3BlLmFjdGlvbiA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIHZhciBhY3Rpb25FbCA9IF9lbC5maW5kKFwiI1wiICsgdGhpcy5pZCk7XG4gICAgICAgIHNjb3BlLmNhbGxiYWNrKCk7XG4gICAgICAgIGNsZWFyRWwoIGFjdGlvbkVsICk7XG4gICAgICB9O1xuXG4gICAgICBmdW5jdGlvbiBzaG93TWVzc2FnZSAoIGRhdGEgKXtcbiAgICAgICAgdmFyIF9pZCA9ICgrbmV3IERhdGUoKSk7XG4gICAgICAgIHZhciBuZXdCb2R5ID0gZGF0YS5tc2c7XG4gICAgICAgIHZhciBuZXdJY24gPSAoZGF0YS5pY29uKT8gZGF0YS5pY29uIDogZGVmYXVsdEljb247XG5cbiAgICAgICAgdmFyIHRlbXBsYXRlID0gbXNnVGVtcGxhdGUucmVwbGFjZShcIkJPRFlcIiwgbmV3Qm9keSkucmVwbGFjZShcIklDT05cIiwgbmV3SWNuKTtcbiAgICAgICAgdmFyIG5ld01lc3NhZ2UgPSAkY29tcGlsZSh0ZW1wbGF0ZSkoc2NvcGUpO1xuXG4gICAgICAgIC8vIHNldCBhIHVuaXF1ZSBpZFxuICAgICAgICBuZXdNZXNzYWdlWzBdLmlkID0gX2lkO1xuICAgICAgICBwcmV2aW91c0lkID0gX2lkO1xuXG4gICAgICAgIC8vIHRocm93IGludG8gZG9tLCB0aGVuIHNob3cgaW4gdmlldywgc3RhcnQgdGltZXJcbiAgICAgICAgX2VsLmFwcGVuZCggbmV3TWVzc2FnZSApO1xuXG4gICAgICAgIC8vIHJlbWVtYmVyIHRoZSBuZXcgZWwgZm9yIGxhdGVyXG4gICAgICAgIHZhciBtc2dFbCA9IF9lbC5maW5kKFwiI1wiICsgX2lkKTtcbiAgICAgICAgY2hhbmdlVHlwZSggbXNnRWwsIGRhdGEudHlwZSApO1xuXG4gICAgICAgIGlmKGRhdGEuY2FsbGJhY2spe1xuICAgICAgICAgIG1zZ0VsLmZpbmQoXCIubXNnLWFjdGlvblwiKS5hZGRDbGFzcyhcInNob3dcIik7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBzaG93XG4gICAgICAgICR0aW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICAgIG1zZ0VsLmFkZENsYXNzKCdhZGQnKTtcbiAgICAgICAgfSwgMjApO1xuXG4gICAgICAgIHRpbWVyID0gJHRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBjbGVhckVsKCBtc2dFbCApO1xuICAgICAgICB9LCBkdXJhdGlvbik7XG4gICAgICB9XG5cbiAgICAgIGZ1bmN0aW9uIGNsZWFyRWwgKCBlbGVtICkge1xuICAgICAgICBpZighZWxlbSAmJiBwcmV2aW91c0lkKXtcbiAgICAgICAgICBlbGVtID0gX2VsLmZpbmQoXCIjXCIgKyBwcmV2aW91c0lkKTtcbiAgICAgICAgfSBlbHNlIGlmKCFlbGVtKSB7IHJldHVybjsgfVxuXG4gICAgICAgIGVsZW0ucmVtb3ZlQ2xhc3MoJ2FkZCcpO1xuICAgICAgICBlbGVtLmFkZENsYXNzKCdyZW1vdmUnKTtcbiAgICAgICAgJHRpbWVvdXQoZnVuY3Rpb24oKXtcbiAgICAgICAgICBhbmd1bGFyLmVsZW1lbnQoZWxlbSkucmVtb3ZlKCk7XG4gICAgICAgIH0sIDMwMCk7XG4gICAgICB9XG5cbiAgICAgIC8vIHNldCB0aGUgdHlwZSBieSBhIGNsYXNzXG4gICAgICBmdW5jdGlvbiBjaGFuZ2VUeXBlICggZWxlbSwgdHlwZSApIHtcbiAgICAgICAgZWxlbS5yZW1vdmVDbGFzcygnbXNnLWluZm8nKTtcbiAgICAgICAgZWxlbS5yZW1vdmVDbGFzcygnbXNnLXdhcm4nKTtcblxuICAgICAgICBpZih0eXBlKXtcbiAgICAgICAgICBlbGVtLmFkZENsYXNzKCdtc2ctJyArIHR5cGUpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgICRyb290U2NvcGUuJG9uKCdNU0dDRU5URVI6RklSRScsIGZ1bmN0aW9uKGUsIGRhdGEpe1xuICAgICAgICBpZighZGF0YS5tc2cpeyByZXR1cm47IH1cbiAgICAgICAgd2luZG93LmNsZWFyVGltZW91dCh0aW1lcik7XG4gICAgICAgIGNsZWFyRWwoKTtcblxuICAgICAgICBpZihkYXRhLmR1cil7XG4gICAgICAgICAgZHVyYXRpb24gPSBkYXRhLmR1ciAqIDEwMDA7XG4gICAgICAgIH1cblxuICAgICAgICBpZihkYXRhLmNhbGxiYWNrKXtcbiAgICAgICAgICBzY29wZS5jYWxsYmFjayA9IGRhdGEuY2FsbGJhY2s7XG4gICAgICAgIH1cblxuICAgICAgICBzaG93TWVzc2FnZSggZGF0YSApO1xuICAgICAgfSk7XG4gICAgfVxuICB9O1xufV0pO1xuIiwiLyoqXG4gKiBwcmVsb2FkZXJcbiAqIGEgZGlyZWN0aXZlIGZvciBzaG93aW5nIGEgcHJlbG9hZGVyIGFuaW1hdGlvbiBkdXJpbmcgYSBwcm9jZXNzaW5nIHBlcmlvZFxuICpcbiAqIFVTRTpcbiAqIDxwcmVsb2FkZXI+PC9wcmVsb2FkZXI+XG4gKlxuICogJHJvb3RTY29wZS4kYnJvYWRjYXN0KCdQUkVMT0FERVI6T04nKTtcbiAqICRyb290U2NvcGUuJGJyb2FkY2FzdCgnUFJFTE9BREVSOk9GRicpO1xuICpcbiAqL1xudmFyIFAgPSByZXF1aXJlKCcuL3ZlbmRvci9jb3JlL3ByZWxvYWRlcicpO1xuXG5NVUcuZGlyZWN0aXZlKCdwcmVsb2FkZXInLFxuWyckcm9vdFNjb3BlJywgJyR0aW1lb3V0JyxcbmZ1bmN0aW9uKCRyb290U2NvcGUsICR0aW1lb3V0KSB7XG4gIHJldHVybiB7XG4gICAgcmVwbGFjZTogdHJ1ZSxcbiAgICByZXN0cmljdDogJ0UnLFxuICAgIHNjb3BlOiB7fSxcbiAgICB0ZW1wbGF0ZTogJzxkaXYgY2xhc3M9XCJwcmVsb2FkZXJcIj48L2Rpdj4nLFxuICAgIGxpbms6IGZ1bmN0aW9uKHNjb3BlLCBlbGVtLCBhdHRycywgY3RybCkge1xuICAgICAgdmFyIEI7XG4gICAgICB2YXIgZWw7XG4gICAgICB2YXIgdGltZXI7XG4gICAgICB2YXIgdGl0bGU7XG4gICAgICB2YXIgcHJldmlvdXNUaXRsZTtcbiAgICAgIHZhciBkdXJhdGlvbiA9IDUwMDA7XG4gICAgICB2YXIgbG9hZGluZyA9ICdsb2FkaW5nJztcblxuICAgICAgLy8gSU5JVCFcbiAgICAgIC8vIGF2b2lkIHRoZSBoaWRlL3Nob3cgdGltZWxpbmVcbiAgICAgICR0aW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICBCID0gbmV3IFAuQnJvd3NlcigpO1xuICAgICAgICBCLmluaXQoKTtcblxuICAgICAgICAvLyBzZXR1cCBvbmUgaW5zdGFuY2Ugb2YgdGhlIGNhbnZhc1xuICAgICAgICBlbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcmVsb2FkZXInKTtcbiAgICAgICAgZWwuYXBwZW5kQ2hpbGQoQi5pbnN0YW5jZSk7XG5cbiAgICAgICAgLy8gZHJhdyBicm93c2VyXG4gICAgICAgIEIuZHJhd0Jyb3dzZXIoKTtcbiAgICAgIH0sIDMwKTtcblxuICAgICAgLy8gZnVuY3Rpb24gc2hvd1ByZWxvYWRlcigpIHtcbiAgICAgIC8vXG4gICAgICAvLyAgIC8vIGF2b2lkIHRoZSBoaWRlL3Nob3cgdGltZWxpbmVcbiAgICAgIC8vICAgJHRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAvL1xuICAgICAgLy8gICAgIC8vIFN0YXJ0IGFuaW1hdGlvblxuICAgICAgLy8gICAgIEIuYW5pbWF0ZSgwLCAzMCk7XG4gICAgICAvLyAgIH0sIDMwKTtcbiAgICAgIC8vXG4gICAgICAvLyAgICR0aW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgLy9cbiAgICAgIC8vICAgICAvLyAvLyBkcmF3IGJyb3dzZXJcbiAgICAgIC8vICAgICAvLyBCLmRyYXdCcm93c2VyKCk7XG4gICAgICAvL1xuICAgICAgLy8gICAgIC8vIFN0YXJ0IGFuaW1hdGlvblxuICAgICAgLy8gICAgIEIuYW5pbWF0ZSgxLCAxNTApO1xuICAgICAgLy9cbiAgICAgIC8vICAgICAvLyBlbC5hZGRDbGFzcyhsb2FkaW5nKTtcbiAgICAgIC8vICAgfSwgMzAwMCk7XG4gICAgICAvLyB9XG5cbiAgICAgIGZ1bmN0aW9uIHVwZGF0ZVByZWxvYWRlcihlLCBhcmdzKSB7XG4gICAgICAgIGlmICghYXJncyB8fCAhYXJncy5tc2cpIHsgcmV0dXJuOyB9XG5cbiAgICAgICAgdGl0bGUgPSBhcmdzLm1zZztcblxuICAgICAgICB2YXIgdHlwZTtcblxuICAgICAgICBzd2l0Y2ggKHRpdGxlKSB7XG4gICAgICAgICAgLy8gY2FzZSAnU3RhcnRpbmcgY29tcGFyZSBjYXB0dXJlJzpcbiAgICAgICAgICAvLyAgIHR5cGUgPSAwO1xuICAgICAgICAgIC8vICAgYnJlYWs7XG4gICAgICAgICAgY2FzZSAnT3BlbmluZyBCcm93c2VyIFNlc3Npb24nOlxuICAgICAgICAgICAgdHlwZSA9IDA7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICBjYXNlICdDYXB0dXJpbmcgU2NyZWVucyc6XG4gICAgICAgICAgICB0eXBlID0gMTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIC8vIGNhc2UgJ1VwZGF0ZWQgUHJvamVjdCBIaXN0b3J5JzpcbiAgICAgICAgICAvLyAgIHR5cGUgPSAyO1xuICAgICAgICAgIC8vICAgYnJlYWs7XG4gICAgICAgICAgLy8gY2FzZSAnQ29tcGFyaW5nIENhcHR1cmUgRGF0YSc6XG4gICAgICAgICAgLy8gICB0eXBlID0gMjtcbiAgICAgICAgICAvLyAgIGJyZWFrO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gY2hlY2sgdGhhdCB0aGUgdGl0bGUgaGFzIGNoYW5nZWRcbiAgICAgICAgaWYgKHRpdGxlICE9PSBwcmV2aW91c1RpdGxlICYmIEIgJiYgQi5hbmltYXRlKSB7XG5cbiAgICAgICAgICAvLyBTdGFydCBhbmltYXRpb25cbiAgICAgICAgICBCLmFuaW1hdGUodHlwZSwgMzAsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcHJldmlvdXNUaXRsZSA9IHRpdGxlO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGZ1bmN0aW9uIHJlc2V0UHJlbG9hZGVyKCkge1xuICAgICAgICBlbC5hZGRDbGFzcyhsb2FkaW5nKTtcbiAgICAgIH1cblxuICAgICAgLy8gJHJvb3RTY29wZS4kb24oJ1BSRUxPQURFUjpPTicsIHNob3dQcmVsb2FkZXIpO1xuICAgICAgJHJvb3RTY29wZS4kb24oJ1BSRUxPQURFUjpVUERBVEUnLCB1cGRhdGVQcmVsb2FkZXIpO1xuICAgICAgJHJvb3RTY29wZS4kb24oJ1BSRUxPQURFUjpPRkYnLCByZXNldFByZWxvYWRlcik7XG4gICAgfVxuICB9O1xufV0pO1xuIiwiTVVHLmZhY3RvcnkoJ3RpbWVBZ28nLCBmdW5jdGlvbiAoKSB7XG4gIHZhciBzZXJ2aWNlID0ge307XG5cbiAgc2VydmljZS5zZXR0aW5ncyA9IHtcbiAgICByZWZyZXNoTWlsbGlzOiA2MDAwMCxcbiAgICBhbGxvd0Z1dHVyZTogZmFsc2UsXG4gICAgc3RyaW5nczoge1xuICAgICAgcHJlZml4QWdvOiBudWxsLFxuICAgICAgcHJlZml4RnJvbU5vdzogbnVsbCxcbiAgICAgIHN1ZmZpeEFnbzogJ2FnbycsXG4gICAgICBzdWZmaXhGcm9tTm93OiAnZnJvbSBub3cnLFxuICAgICAgc2Vjb25kczogJ2xlc3MgdGhhbiBhIG1pbnV0ZScsXG4gICAgICBtaW51dGU6ICdhYm91dCBhIG1pbnV0ZScsXG4gICAgICBtaW51dGVzOiAnJWQgbWludXRlcycsXG4gICAgICBob3VyOiAnYWJvdXQgYW4gaG91cicsXG4gICAgICBob3VyczogJyVkIGhvdXJzJyxcbiAgICAgIGRheTogJ2EgZGF5JyxcbiAgICAgIGRheXM6ICclZCBkYXlzJyxcbiAgICAgIG1vbnRoOiAnYWJvdXQgYSBtb250aCcsXG4gICAgICBtb250aHM6ICclZCBtb250aHMnLFxuICAgICAgeWVhcjogJ2Fib3V0IGEgeWVhcicsXG4gICAgICB5ZWFyczogJyVkIHllYXJzJyxcbiAgICAgIG51bWJlcnM6IFtdXG4gICAgfVxuICB9O1xuXG4gIGZ1bmN0aW9uIHRyaW1EaWdpdHMgKCBudW0gKSB7XG4gICAgICB2YXIgbSA9IG51bS50b1N0cmluZygpLnNsaWNlKDAsMTMpO1xuICAgICAgcmV0dXJuIChtLmxlbmd0aCA9PSAxMyk/IHBhcnNlSW50KG0pIDogbnVtO1xuICB9XG5cbiAgc2VydmljZS5pbldvcmRzID0gZnVuY3Rpb24gKGRpc3RhbmNlTWlsbGlzKSB7XG4gICAgdmFyICRsID0gc2VydmljZS5zZXR0aW5ncy5zdHJpbmdzO1xuICAgIHZhciBwcmVmaXggPSAkbC5wcmVmaXhBZ287XG4gICAgdmFyIHN1ZmZpeCA9ICRsLnN1ZmZpeEFnbztcbiAgICBpZiAoc2VydmljZS5zZXR0aW5ncy5hbGxvd0Z1dHVyZSkge1xuICAgICAgaWYgKGRpc3RhbmNlTWlsbGlzIDwgMCkge1xuICAgICAgICBwcmVmaXggPSAkbC5wcmVmaXhGcm9tTm93O1xuICAgICAgICBzdWZmaXggPSAkbC5zdWZmaXhGcm9tTm93O1xuICAgICAgfVxuICAgIH1cblxuICAgIHZhciBzZWNvbmRzID0gTWF0aC5hYnMoZGlzdGFuY2VNaWxsaXMpIC8gMTAwMDtcbiAgICB2YXIgbWludXRlcyA9IHNlY29uZHMgLyA2MDtcbiAgICB2YXIgaG91cnMgPSBtaW51dGVzIC8gNjA7XG4gICAgdmFyIGRheXMgPSBob3VycyAvIDI0O1xuICAgIHZhciB5ZWFycyA9IGRheXMgLyAzNjU7XG5cbiAgICBmdW5jdGlvbiBzdWJzdGl0dXRlKHN0cmluZ09yRnVuY3Rpb24sIG51bWJlcikge1xuICAgICAgdmFyIHN0cmluZyA9IGFuZ3VsYXIuaXNGdW5jdGlvbihzdHJpbmdPckZ1bmN0aW9uKSA/XG4gICAgICBzdHJpbmdPckZ1bmN0aW9uKG51bWJlciwgZGlzdGFuY2VNaWxsaXMpIDogc3RyaW5nT3JGdW5jdGlvbjtcbiAgICAgIHZhciB2YWx1ZSA9ICgkbC5udW1iZXJzICYmICRsLm51bWJlcnNbbnVtYmVyXSkgfHwgbnVtYmVyO1xuICAgICAgcmV0dXJuIHN0cmluZy5yZXBsYWNlKC8lZC9pLCB2YWx1ZSk7XG4gICAgfVxuXG4gICAgdmFyIHdvcmRzID0gc2Vjb25kcyA8IDQ1ICYmIHN1YnN0aXR1dGUoJGwuc2Vjb25kcywgTWF0aC5yb3VuZChzZWNvbmRzKSkgfHxcbiAgICAgICAgc2Vjb25kcyA8IDkwICYmIHN1YnN0aXR1dGUoJGwubWludXRlLCAxKSB8fFxuICAgICAgICBtaW51dGVzIDwgNDUgJiYgc3Vic3RpdHV0ZSgkbC5taW51dGVzLCBNYXRoLnJvdW5kKG1pbnV0ZXMpKSB8fFxuICAgICAgICBtaW51dGVzIDwgOTAgJiYgc3Vic3RpdHV0ZSgkbC5ob3VyLCAxKSB8fFxuICAgICAgICBob3VycyA8IDI0ICYmIHN1YnN0aXR1dGUoJGwuaG91cnMsIE1hdGgucm91bmQoaG91cnMpKSB8fFxuICAgICAgICBob3VycyA8IDQyICYmIHN1YnN0aXR1dGUoJGwuZGF5LCAxKSB8fFxuICAgICAgICBkYXlzIDwgMzAgJiYgc3Vic3RpdHV0ZSgkbC5kYXlzLCBNYXRoLnJvdW5kKGRheXMpKSB8fFxuICAgICAgICBkYXlzIDwgNDUgJiYgc3Vic3RpdHV0ZSgkbC5tb250aCwgMSkgfHxcbiAgICAgICAgZGF5cyA8IDM2NSAmJiBzdWJzdGl0dXRlKCRsLm1vbnRocywgTWF0aC5yb3VuZChkYXlzIC8gMzApKSB8fFxuICAgICAgICB5ZWFycyA8IDEuNSAmJiBzdWJzdGl0dXRlKCRsLnllYXIsIDEpIHx8XG4gICAgICAgIHN1YnN0aXR1dGUoJGwueWVhcnMsIE1hdGgucm91bmQoeWVhcnMpKTtcblxuICAgIHZhciBzZXBhcmF0b3IgPSAkbC53b3JkU2VwYXJhdG9yID09PSB1bmRlZmluZWQgPyAnICcgOiAkbC53b3JkU2VwYXJhdG9yO1xuICAgIHJldHVybiBbcHJlZml4LCB3b3Jkcywgc3VmZml4XS5qb2luKHNlcGFyYXRvcikudHJpbSgpO1xuICB9O1xuXG4gIHNlcnZpY2UucGFyc2UgPSBmdW5jdGlvbiAoaXNvODYwMSkge1xuICAgIGlmIChhbmd1bGFyLmlzTnVtYmVyKGlzbzg2MDEpKSB7XG4gICAgICBpc284NjAxID0gaXNvODYwMSArIFwiXCI7XG4gICAgICAvLyBmb3JtYXQgZm9yIGNvcnJlY3QgbGVuZ3RoXG4gICAgICB2YXIgb3JpZ2luYWxUaW1lc3RhbXAgPSB0cmltRGlnaXRzKCBpc284NjAxICk7XG4gICAgICByZXR1cm4gcGFyc2VJbnQob3JpZ2luYWxUaW1lc3RhbXAsIDEwKTtcbiAgICB9XG4gICAgdmFyIHMgPSAoaXNvODYwMSB8fCAnJykudHJpbSgpO1xuICAgIHMgPSBzLnJlcGxhY2UoL1xcLlxcZCsvLCAnJyk7IC8vIHJlbW92ZSBtaWxsaXNlY29uZHNcbiAgICBzID0gcy5yZXBsYWNlKC8tLywgJy8nKS5yZXBsYWNlKC8tLywgJy8nKTtcbiAgICBzID0gcy5yZXBsYWNlKC9ULywgJyAnKS5yZXBsYWNlKC9aLywgJyBVVEMnKTtcbiAgICBzID0gcy5yZXBsYWNlKC8oW1xcK1xcLV1cXGRcXGQpXFw6PyhcXGRcXGQpLywgJyAkMSQyJyk7IC8vIC0wNDowMCAtPiAtMDQwMFxuICAgIHJldHVybiBuZXcgRGF0ZShzKTtcbiAgfTtcblxuICByZXR1cm4gc2VydmljZTtcbn0pO1xuIiwidmFyIGZzID0gcmVxdWlyZSgnZnMnKTtcbnZhciBhc3luYyA9IHJlcXVpcmUoJ2FzeW5jJyk7XG5cbk1VRy5mYWN0b3J5KCdDb21wYXJlJyxcblsnJHEnLCAnQ29uZmlnJyxcbmZ1bmN0aW9uKCRxLCBDb25maWcpIHtcbiAgLy8gQ29uZmlnIHZhcnNcbiAgdmFyIGZpbGVEaXJQcmVmaXggPSBfX2Rpcm5hbWUgKyAnLyc7XG4gIHZhciBpbWFnZVByZWZpeCA9ICdkYXRhOmltYWdlL3BuZztiYXNlNjQsJztcbiAgdmFyIHN0YXR1c1R5cGVzID0gWydwYXNzZWQnLCAnd2FybmluZycsICdmYWlsZWQnXTtcblxuICAvLyBhc3luYyBoZWxwZXJcbiAgZnVuY3Rpb24gcmVhZEFzeW5jKGZpbGUsIGNhbGxiYWNrKSB7XG4gICAgZnMucmVhZEZpbGUoZmlsZURpclByZWZpeCArIGZpbGUsICdiYXNlNjQnLCBjYWxsYmFjayk7XG4gIH1cblxuICAvLyBUT0RPOiBsZXQgdGhlIGJhY2tlbmQgcHJvY2VzcyBoYW5kbGUgdGhpcyFcbiAgZnVuY3Rpb24gY29tcGFyZVNpbmdsZShhLCBiKSB7XG4gICAgdmFyIGRmZCA9ICRxLmRlZmVyKCk7XG4gICAgdmFyIG91dHB1dCA9IHt9O1xuXG4gICAgLy8gQXBwbHkgTWFpbiBDb21wYXJlIENvbmZpZ1xuICAgIHJlc2VtYmxlLm91dHB1dFNldHRpbmdzKENvbmZpZy5Db21wYXJlKTtcblxuICAgIC8vIE9wZW4gYm90aCBmaWxlcywgYmVmb3JlIHdlIGFyZSByZWFkeSB0byBwcm9jZXNzXG4gICAgYXN5bmMubWFwKFthLCBiXSwgcmVhZEFzeW5jLCBmdW5jdGlvbihlcnIsIHJlc3VsdHMpIHtcbiAgICAgIHZhciBhRGF0YSA9IGltYWdlUHJlZml4ICsgcmVzdWx0c1swXTtcbiAgICAgIHZhciBiRGF0YSA9IGltYWdlUHJlZml4ICsgcmVzdWx0c1sxXTtcblxuICAgICAgLy8gSGFuZGxlcyBlcnJvcnNcbiAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgZGZkLnJlamVjdChlcnIpO1xuICAgICAgfVxuXG4gICAgICAvLyBSdW4gdGhlIGNvbXBhcmUgZnVuY3Rpb24sIHJldHVybiB0aGUgZGlmZiBkYXRhXG4gICAgICByZXNlbWJsZShhRGF0YSlcbiAgICAgICAgLmNvbXBhcmVUbyhiRGF0YSlcbiAgICAgICAgLmlnbm9yZUNvbG9ycygpXG4gICAgICAgIC5vbkNvbXBsZXRlKGZ1bmN0aW9uKGRpZmZEYXRhKSB7XG4gICAgICAgICAgb3V0cHV0LnJlcG9ydCA9IGRpZmZEYXRhO1xuICAgICAgICAgIG91dHB1dC5zcmMgPSBkaWZmRGF0YS5nZXRJbWFnZURhdGFVcmwoKTtcblxuICAgICAgICAgIGRmZC5yZXNvbHZlKG91dHB1dCk7XG4gICAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgcmV0dXJuIGRmZC5wcm9taXNlO1xuICB9O1xuXG4gIHJldHVybiB7XG5cbiAgICAvKipcbiAgICAgKiBDb21wYXJlcyB0d28gaW1hZ2VzIGFuZCByZXR1cm5zIGFsbCBkYXRhIHdpdGggYW4gaW1hZ2Ugb2YgY2hhbmdlc1xuICAgICAqL1xuICAgIHJ1blNpbmdsZTogY29tcGFyZVNpbmdsZSxcblxuICAgIC8qKlxuICAgICAqIHJldHVybnMgdGhlIHR5cGUgb2YgcGFzcy93YXJuL2ZhaWwgc3RhdHVzXG4gICAgICovXG4gICAgZ2V0U3RhdHVzOiBmdW5jdGlvbihkYXRhKSB7XG4gICAgICB2YXIgbWlzTWF0Y2hWYWx1ZSA9IHBhcnNlRmxvYXQoZGF0YS5taXNNYXRjaFBlcmNlbnRhZ2UpO1xuXG4gICAgICAvLyBsb3dlc3QgdG9sZXJhbmNlXG4gICAgICBpZiAobWlzTWF0Y2hWYWx1ZSA8IDAuMSkge1xuXG4gICAgICAgIC8vIFdhcm4gdGhhdCBkaW1lbnNpb25zIGFyZSBkaWZmZXJlbmNlXG4gICAgICAgIGlmIChkYXRhLmlzU2FtZURpbWVuc2lvbnMgPT09IGZhbHNlKSB7XG4gICAgICAgICAgcmV0dXJuIHN0YXR1c1R5cGVzWzFdO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJldHVybiBzdGF0dXNUeXBlc1swXTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyB3YXJuaW5nIHRvbGVyYW5jZVxuICAgICAgaWYgKG1pc01hdGNoVmFsdWUgPiAwLjEgJiYgbWlzTWF0Y2hWYWx1ZSA8IDIpIHtcbiAgICAgICAgcmV0dXJuIHN0YXR1c1R5cGVzWzFdO1xuICAgICAgfVxuXG4gICAgICAvLyBlcnJvciB0b2xlcmFuY2UgcmVhY2hlZFxuICAgICAgcmV0dXJuIHN0YXR1c1R5cGVzWzJdO1xuICAgIH1cblxuICB9O1xufV0pO1xuIiwiTVVHLmZhY3RvcnkoJ25vd1RpbWUnLFxuWyckdGltZW91dCcsXG5mdW5jdGlvbigkdGltZW91dCkge1xuICB2YXIgbm93VGltZSA9IERhdGUubm93KCk7XG4gIHZhciB1cGRhdGVUaW1lID0gZnVuY3Rpb24oKSB7XG4gICAgJHRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICBub3dUaW1lID0gRGF0ZS5ub3coKTtcbiAgICAgIHVwZGF0ZVRpbWUoKTtcbiAgICB9LCAxMDAwKTtcbiAgfTtcblxuICB1cGRhdGVUaW1lKCk7XG4gIHJldHVybiB7XG4gICAgZ2V0VGltZTogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gbm93VGltZTtcbiAgICB9XG4gIH07XG59XSk7XG4iLCJ2YXIgZnMgPSByZXF1aXJlKCdmcycpO1xudmFyIHBhdGggPSByZXF1aXJlKCdwYXRoJyk7XG52YXIgQVdTID0gcmVxdWlyZSgnLi92ZW5kb3IvY29yZS9hd3MnKTtcblxuTVVHLmZhY3RvcnkoJ1Byb2plY3RzJyxcblsnJHEnLFxuZnVuY3Rpb24oJHEpIHtcbiAgLy8gQ29uZmlnIHRoZSBtYWluIHBhdGhzXG4gIHZhciBwcm9qZWN0c1BhdGggPSBfX2Rpcm5hbWUgKyAnL3Byb2plY3RzLmpzb24nO1xuICB2YXIgcHJvamVjdEZpbGVzUGF0aCA9IF9fZGlybmFtZSArICcvcHJvamVjdHMvJztcblxuICAvLyBDcmVhdGVzIGEgVVVJRCBvZiB0aGUgc3BlY2lmaWVkIGxlbmd0aFxuICBmdW5jdGlvbiBjcmVhdGVVVUlEKHMpIHtcbiAgICB2YXIgbjtcbiAgICBpZiAodHlwZW9mIHMgPT0gJ251bWJlcicgJiYgcyA9PT0gcGFyc2VJbnQocywgMTApKSB7XG4gICAgICBzID0gQXJyYXkocyArIDEpLmpvaW4oJ3gnKTtcbiAgICB9XG5cbiAgICByZXR1cm4gcy5yZXBsYWNlKC94L2csIGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIG4gPSBNYXRoLnJvdW5kKE1hdGgucmFuZG9tKCkgKiA2MSkgKyA0ODtcbiAgICAgIG4gPSBuID4gNTcgPyAobiArIDcgPiA5MCA/IG4gKyAxMyA6IG4gKyA3KSA6IG47XG4gICAgICByZXR1cm4gU3RyaW5nLmZyb21DaGFyQ29kZShuKTtcbiAgICB9KTtcbiAgfVxuXG4gIC8vIENyZWF0ZXMgYSBKU09OIG9iamVjdCBmb3IgYSBiYXNlbGluZSBuZXcgcHJvamVjdFxuICBmdW5jdGlvbiBjcmVhdGVEdW1teVByb2plY3QodG90YWwpIHtcbiAgICB0b3RhbCA9IHRvdGFsIHx8IDA7XG4gICAgdmFyIHByb2plY3RJZCA9IGNyZWF0ZVVVSUQoMTIpO1xuICAgIHJldHVybiB7XG4gICAgICBpZDogcHJvamVjdElkLFxuICAgICAgdGl0bGU6ICdQcm9qZWN0ICcgKyAocGFyc2VJbnQodG90YWwsIDEwKSArIDEpLFxuICAgICAgdGltZXN0YW1wOiAoK25ldyBEYXRlKSxcbiAgICAgIHRvdGFsczoge1xuICAgICAgICBzdWNjZXNzOiBudWxsLFxuICAgICAgICB3YXJuaW5nOiBudWxsLFxuICAgICAgICBlcnJvcjogbnVsbCxcbiAgICAgICAgdmlld3M6IDBcbiAgICAgIH1cbiAgICB9O1xuICB9XG5cbiAgLy8gU2V0cyB1cCB0aGUgbmVlZGVkIGJhc2UgZGF0YSBmb3Igc3RvcmluZyBhbiBpbmRpdmlkdWFsIHByb2plY3RcbiAgZnVuY3Rpb24gY3JlYXRlRHVtbXlQcm9qZWN0RmlsZShvcHRpb25zKSB7XG4gICAgdmFyIHByb2plY3RJZCA9IGNyZWF0ZVVVSUQoMTIpO1xuICAgIHJldHVybiB7XG4gICAgICBiYXRjaEhpc3Rvcnk6IHt9LFxuICAgICAgY3VycmVudEJhdGNoOiBudWxsLFxuICAgICAgY3VycmVudFJlZmVyZW5jZTogbnVsbCxcbiAgICAgIGlkOiBvcHRpb25zLmlkLFxuICAgICAgdGl0bGU6IG9wdGlvbnMudGl0bGUsXG4gICAgICB0aW1lc3RhbXA6IG9wdGlvbnMudGltZXN0YW1wLFxuICAgICAgdmlld3BvcnRzOiBbXSxcbiAgICAgIHNlbGVjdG9yczogW10sXG4gICAgICBjb29raWVzOiBbXSxcbiAgICAgIG1ldGE6IHtcbiAgICAgICAgdXJsOiBudWxsLFxuICAgICAgICByZWFkeUV2ZW50OiBudWxsLFxuICAgICAgICBkZWxheTogbnVsbCxcbiAgICAgICAgbWlzTWF0Y2hUaHJlc2hvbGQ6IG51bGxcbiAgICAgIH1cbiAgICB9O1xuICB9XG5cbiAgLy8gR3JhYnMgSlNPTiBmaWxlIGFuZCBhcHByb3ByaWF0ZWx5IGhhbmRsZXMgZXJyb3JzXG4gIGZ1bmN0aW9uIGdldEpzb25GaWxlKHBhdGgsIHR5cGUpIHtcbiAgICB2YXIgZmlsZTtcblxuICAgIHRyeSB7XG4gICAgICBmaWxlID0gZnMucmVhZEZpbGVTeW5jKHBhdGgsICd1dGY4Jyk7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgLy8gY291bGRuJ3QgZmluZCBmaWxlXG4gICAgICBpZiAoZS5jb2RlID09PSAnRU5PRU5UJykge1xuICAgICAgICByZXR1cm4gdHlwZSB8fCB7fTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRocm93IGU7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIEpTT04ucGFyc2UoZmlsZSk7XG4gIH1cblxuICAvLyByZW1vdmUgYWxsIGZpbGVzIGluIGRpcmVjdG9yeVxuICBmdW5jdGlvbiByZW1vdmVBbGxJbkRpcmVjdG9yeShkaXJQYXRoKSB7XG4gICAgdHJ5IHtcbiAgICAgIHZhciBmaWxlcyA9IGZzLnJlYWRkaXJTeW5jKGRpclBhdGgpO1xuICAgIH0gY2F0Y2ggKGUpIHsgcmV0dXJuOyB9XG5cbiAgICBpZiAoZmlsZXMubGVuZ3RoID4gMClcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZmlsZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdmFyIGZpbGVQYXRoID0gcGF0aC5qb2luKGRpclBhdGgsIGZpbGVzW2ldKTtcblxuICAgICAgICBpZiAoZnMuc3RhdFN5bmMoZmlsZVBhdGgpLmlzRmlsZSgpKSB7XG4gICAgICAgICAgZnMudW5saW5rU3luYyhmaWxlUGF0aCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcm1EaXIoZmlsZVBhdGgpO1xuICAgICAgICB9XG4gICAgICB9XG4gIH07XG5cbiAgLy8gc2V0cyB1cCBhIHByb21pc2UgZHJpdmVuIGZpbGUgd3JpdGVcbiAgZnVuY3Rpb24gcHJvbWlzZVdyaXRlKGZpbGVQYXRoLCBkYXRhKSB7XG4gICAgdmFyIF9xID0gJHEuZGVmZXIoKTtcblxuICAgIGZzLndyaXRlRmlsZShmaWxlUGF0aCwgSlNPTi5zdHJpbmdpZnkoZGF0YSksIGZ1bmN0aW9uKGVycikge1xuICAgICAgaWYgKGVycikge1xuICAgICAgICBfcS5yZWplY3QoZXJyKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgX3EucmVzb2x2ZSgpO1xuICAgIH0pO1xuXG4gICAgcmV0dXJuIF9xLnByb21pc2U7XG4gIH1cblxuICAvLyBzZXRzIHVwIGEgcHJvbWlzZSBkcml2ZW4gZmlsZSBkZWxldGVcbiAgZnVuY3Rpb24gcHJvbWlzZVJlbW92ZShwYXRoKSB7XG4gICAgdmFyIF96ID0gJHEuZGVmZXIoKTtcblxuICAgIC8vIGZzLnVubGlua1xuICAgIGZzLnVubGluayhwYXRoLCBmdW5jdGlvbihlcnIpIHtcbiAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgX3oucmVqZWN0KGVycik7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIF96LnJlc29sdmUoKTtcbiAgICB9KTtcblxuICAgIHJldHVybiBfei5wcm9taXNlO1xuICB9XG5cbiAgcmV0dXJuIHtcblxuICAgIGdldDogZnVuY3Rpb24ocGF0aCwgdHlwZSkge1xuICAgICAgcmV0dXJuIGdldEpzb25GaWxlKF9fZGlybmFtZSArIHBhdGgsIHR5cGUpO1xuICAgIH0sXG5cbiAgICBnZXRBbGw6IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIGdldEpzb25GaWxlKHByb2plY3RzUGF0aCwgW10pO1xuICAgIH0sXG5cbiAgICBnZXRCeUlkOiBmdW5jdGlvbihpZCkge1xuICAgICAgcmV0dXJuIGdldEpzb25GaWxlKHByb2plY3RGaWxlc1BhdGggKyBpZCArICcuanNvbicpO1xuICAgIH0sXG5cbiAgICBnZXRUeXBlQnlJZDogZnVuY3Rpb24oaWQsIHR5cGUpIHtcbiAgICAgIHZhciBhZGRpdGlvbiA9ICh0eXBlKSA/ICdfJyArIHR5cGUgOiAnJztcbiAgICAgIHJldHVybiBnZXRKc29uRmlsZShwcm9qZWN0RmlsZXNQYXRoICsgaWQgKyBhZGRpdGlvbiArICcuanNvbicsIFtdKTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogdmFsaWRhdGVzIHRoZSBwcm9qZWN0LCBtYWtlcyBzdXJlIGFsbCBzZXR0aW5ncyBhcmUgc2V0dXAgYW5kIHZhbGlkXG4gICAgICovXG4gICAgdmFsaWRhdGU6IGZ1bmN0aW9uKHByb2plY3QpIHtcbiAgICAgIHZhciBjb29raWVzID0gcHJvamVjdC5jb29raWVzO1xuICAgICAgdmFyIHZpZXdwb3J0cyA9IHByb2plY3Qudmlld3BvcnRzO1xuICAgICAgdmFyIHNlbGVjdG9ycyA9IHByb2plY3Quc2VsZWN0b3JzO1xuICAgICAgdmFyIHRpdGxlID0gcHJvamVjdC50aXRsZTtcbiAgICAgIHZhciB1cmwgPSBwcm9qZWN0Lm1ldGEudXJsO1xuICAgICAgdmFyIGJvb2wgPSB0cnVlO1xuXG4gICAgICAvLyB2ZXJpZnkgYWxsIGRlZmF1bHRzIGFyZSBzZXR1cFxuICAgICAgaWYgKCF2aWV3cG9ydHMgfHwgIXNlbGVjdG9ycyB8fCAhdGl0bGUgfHwgIXVybCB8fCB2aWV3cG9ydHMubGVuZ3RoIDwgMSB8fCBzZWxlY3RvcnMubGVuZ3RoIDwgMSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG5cbiAgICAgIC8vIElmIHdlIGhhdmUgdmlld3BvcnRzLCB2ZXJpZnkgdGhleSdyZSBzZXR1cCByaWdodFxuICAgICAgaWYgKHZpZXdwb3J0cykge1xuICAgICAgICB2aWV3cG9ydHMubWFwKGZ1bmN0aW9uKG9iaiwgaWR4KSB7XG4gICAgICAgICAgaWYgKCFvYmoud2lkdGggfHwgIW9iai5oZWlnaHQgfHwgIW9iai5uYW1lKSB7XG4gICAgICAgICAgICBib29sID0gZmFsc2U7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgLy8gSWYgd2UgaGF2ZSBzZWxlY3RvcnMsIHZlcmlmeSB0aGV5J3JlIHNldHVwIHJpZ2h0XG4gICAgICBpZiAoc2VsZWN0b3JzKSB7XG4gICAgICAgIHNlbGVjdG9ycy5tYXAoZnVuY3Rpb24ob2JqLCBpZHgpIHtcbiAgICAgICAgICBpZiAoIW9iai5xdWVyeSB8fCAhb2JqLnR5cGUpIHtcbiAgICAgICAgICAgIGJvb2wgPSBmYWxzZTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICAvLyBJZiB3ZSBoYXZlIGNvb2tpZXMsIHZlcmlmeSB0aGV5J3JlIHNldHVwIHJpZ2h0XG4gICAgICBpZiAoY29va2llcykge1xuICAgICAgICBjb29raWVzLm1hcChmdW5jdGlvbihvYmosIGlkeCkge1xuICAgICAgICAgIGlmICghb2JqLm5hbWUgfHwgIW9iai5wYXRoIHx8ICFvYmoudmFsdWUpIHtcbiAgICAgICAgICAgIGJvb2wgPSBmYWxzZTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICAvLyBkZWZhdWx0IHRvIHRydWVcbiAgICAgIHJldHVybiBib29sO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBjcmVhdGVzIGEgbmV3IHByb2plY3QsIGFuZCByZXR1cm5zIHRoZSBkYXRhIGluIGEgcHJvbWlzZVxuICAgICAqL1xuICAgIGNyZWF0ZU5ldzogZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgZGZkID0gJHEuZGVmZXIoKTtcbiAgICAgIHZhciBhbGxQcm9qZWN0cyA9IEpTT04ucGFyc2UoZnMucmVhZEZpbGVTeW5jKHByb2plY3RzUGF0aCwgJ3V0ZjgnKSk7XG4gICAgICB2YXIgbmV3UHJvamVjdERhdGEgPSBjcmVhdGVEdW1teVByb2plY3QoYWxsUHJvamVjdHMubGVuZ3RoKTtcbiAgICAgIHZhciBuZXdQcm9qZWN0RmlsZSA9IGNyZWF0ZUR1bW15UHJvamVjdEZpbGUobmV3UHJvamVjdERhdGEpO1xuXG4gICAgICBhbGxQcm9qZWN0cy51bnNoaWZ0KG5ld1Byb2plY3REYXRhKTtcblxuICAgICAgLy8gc2F2ZSB0aGUgZGF0YSB0byB0aGUgcHJvamVjdHMgbGlzdFxuICAgICAgZnMud3JpdGVGaWxlKHByb2plY3RzUGF0aCwgSlNPTi5zdHJpbmdpZnkoYWxsUHJvamVjdHMpLCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgaWYgKGVycikge1xuICAgICAgICAgIGRmZC5yZWplY3QoZXJyKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICAvLyBzYXZlIGFzIGFuIGluZGl2aWR1YWwgZmlsZVxuICAgICAgICBmcy53cml0ZUZpbGUocHJvamVjdEZpbGVzUGF0aCArIG5ld1Byb2plY3REYXRhLmlkICsgJy5qc29uJywgSlNPTi5zdHJpbmdpZnkobmV3UHJvamVjdEZpbGUpLCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICBpZiAoZXJyKSB7XG4gICAgICAgICAgICBkZmQucmVqZWN0KGVycik7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgLy8gc2F2ZSBhcyBhbiBpbmRpdmlkdWFsIGZpbGVcbiAgICAgICAgICBmcy53cml0ZUZpbGUocHJvamVjdEZpbGVzUGF0aCArIG5ld1Byb2plY3REYXRhLmlkICsgJ19oaXN0b3J5Lmpzb24nLCBKU09OLnN0cmluZ2lmeShbXSksIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgaWYgKGVycikge1xuICAgICAgICAgICAgICBkZmQucmVqZWN0KGVycik7XG4gICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gcmVkaXJlY3QgdXNlciB0byB0aGUgc2V0dGluZ3MgcGFnZVxuICAgICAgICAgICAgZGZkLnJlc29sdmUobmV3UHJvamVjdERhdGEpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4gZGZkLnByb21pc2U7XG4gICAgfSxcblxuICAgIC8vIHNhdmUgdG8gZmlsZSBhbmQgbGlzdHMsIHJldHVybiBsaXN0IGRhdGFcbiAgICBzYXZlOiBmdW5jdGlvbihwcm9qZWN0RGF0YSkge1xuICAgICAgdmFyIGRmZCA9ICRxLmRlZmVyKCk7XG4gICAgICB2YXIgYWxsUHJvamVjdHMgPSBKU09OLnBhcnNlKGZzLnJlYWRGaWxlU3luYyhwcm9qZWN0c1BhdGgsICd1dGY4JykpO1xuXG4gICAgICAvLyBVcGRhdGUgdGhlIGxpc3RpbmcgZGF0YVxuICAgICAgYWxsUHJvamVjdHMubWFwKGZ1bmN0aW9uKG9iaiwgaWR4KSB7XG4gICAgICAgIGlmIChvYmouaWQgPT09IHByb2plY3REYXRhLmlkKSB7XG4gICAgICAgICAgYWxsUHJvamVjdHNbaWR4XS50aXRsZSA9IHByb2plY3REYXRhLnRpdGxlO1xuICAgICAgICAgIGFsbFByb2plY3RzW2lkeF0udGltZXN0YW1wID0gKCtuZXcgRGF0ZSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICAvLyBzYXZlIGFzIGFuIGluZGl2aWR1YWwgZmlsZVxuICAgICAgZnMud3JpdGVGaWxlKHByb2plY3RGaWxlc1BhdGggKyBwcm9qZWN0RGF0YS5pZCArICcuanNvbicsIEpTT04uc3RyaW5naWZ5KHByb2plY3REYXRhKSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgICBkZmQucmVqZWN0KGVycik7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gdXBkYXRlIHRoZSBsaXN0aW5nIGRhdGFcbiAgICAgICAgZnMud3JpdGVGaWxlKHByb2plY3RzUGF0aCwgSlNPTi5zdHJpbmdpZnkoYWxsUHJvamVjdHMpLCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICBpZiAoZXJyKSB7XG4gICAgICAgICAgICBkZmQucmVqZWN0KGVycik7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgLy8gcmV0dXJuIHRoZSBsaXN0aW5nIGRhdGEsIHNvIHdlIGNhbiB1cGRhdGUgdGhlIHNpZGVwYW5lbFxuICAgICAgICAgIGRmZC5yZXNvbHZlKHByb2plY3REYXRhKTtcbiAgICAgICAgfSk7XG4gICAgICB9KTtcblxuICAgICAgcmV0dXJuIGRmZC5wcm9taXNlO1xuICAgIH0sXG5cbiAgICAvLyBUT0RPOiBzaG91bGQgcmVtb3ZlIGltYWdlcyB1cG9uIGRlbGV0ZT9cbiAgICAvLyBSZW1vdmVzIGEgc2luZ2xlIHByb2plY3QgYnkgSURcbiAgICByZW1vdmU6IGZ1bmN0aW9uKGlkKSB7XG4gICAgICB2YXIgZGZkID0gJHEuZGVmZXIoKTtcbiAgICAgIHZhciBhbGxQcm9qZWN0cyA9IEpTT04ucGFyc2UoZnMucmVhZEZpbGVTeW5jKHByb2plY3RzUGF0aCwgJ3V0ZjgnKSk7XG5cbiAgICAgIC8vIFVwZGF0ZSB0aGUgbGlzdGluZyBkYXRhXG4gICAgICBhbGxQcm9qZWN0cy5tYXAoZnVuY3Rpb24ob2JqLCBpZHgpIHtcbiAgICAgICAgaWYgKG9iai5pZCA9PT0gaWQpIHtcbiAgICAgICAgICBhbGxQcm9qZWN0cy5zcGxpY2UoaWR4LCAxKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIC8vIFJlbW92ZSB0aGUgcHJvamVjdCBmaWxlXG4gICAgICBmcy51bmxpbmsocHJvamVjdEZpbGVzUGF0aCArIGlkICsgJy5qc29uJywgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgICBkZmQucmVqZWN0KGVycik7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gUmVtb3ZlIHRoZSBwcm9qZWN0IGhpc3RvcnkgZmlsZVxuICAgICAgICBmcy51bmxpbmsocHJvamVjdEZpbGVzUGF0aCArIGlkICsgJ19oaXN0b3J5Lmpzb24nLCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICBpZiAoZXJyKSB7XG4gICAgICAgICAgICBkZmQucmVqZWN0KGVycik7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgLy8gdXBkYXRlIHRoZSBsaXN0aW5nIGRhdGFcbiAgICAgICAgICBmcy53cml0ZUZpbGUocHJvamVjdHNQYXRoLCBKU09OLnN0cmluZ2lmeShhbGxQcm9qZWN0cyksIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgICAgaWYgKGVycikge1xuICAgICAgICAgICAgICBkZmQucmVqZWN0KGVycik7XG4gICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gcmV0dXJuXG4gICAgICAgICAgICBkZmQucmVzb2x2ZSgpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4gZGZkLnByb21pc2U7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIHJlbW92ZXMgYWxsIHN0b3JlZCBoaXN0b3J5IGZvciBhIHByb2plY3RcbiAgICAgKi9cbiAgICBjbGVhckhpc3Rvcnk6IGZ1bmN0aW9uKHByb2plY3QpIHtcbiAgICAgIHZhciBkZmQgPSAkcS5kZWZlcigpO1xuICAgICAgdmFyIG1haW5Qcm9qZWN0cyA9IGdldEpzb25GaWxlKHByb2plY3RzUGF0aCwgW10pO1xuXG4gICAgICAvLyBVcGRhdGUgdGhlIHByb2plY3QgZGF0YSB0byByZWZsZWN0IG5vIGhpc3RvcnlcbiAgICAgIHByb2plY3QuY3VycmVudEJhdGNoID0gbnVsbDtcbiAgICAgIHByb2plY3QuY3VycmVudFJlZmVyZW5jZSA9IG51bGw7XG4gICAgICBwcm9qZWN0LmJhdGNoSGlzdG9yeSA9IHt9O1xuXG4gICAgICAvLyB1cGRhdGUgdGhlIGN1cnJlbnQgcHJvamVjdCB0byBoYXZlIG5vIGJhdGNoSGlzdG9yeVxuICAgICAgbWFpblByb2plY3RzLm1hcChmdW5jdGlvbihvYmosIGlkeCkge1xuICAgICAgICBpZiAob2JqLmlkID09PSBwcm9qZWN0LmlkKSB7XG4gICAgICAgICAgbWFpblByb2plY3RzW2lkeF0udG90YWxzLnN1Y2Nlc3MgPSAwO1xuICAgICAgICAgIG1haW5Qcm9qZWN0c1tpZHhdLnRvdGFscy53YXJuaW5nID0gMDtcbiAgICAgICAgICBtYWluUHJvamVjdHNbaWR4XS50b3RhbHMuZXJyb3IgPSAwO1xuICAgICAgICAgIG1haW5Qcm9qZWN0c1tpZHhdLnRvdGFscy52aWV3cyA9IDA7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICAvLyByZW1vdmUgYWxsIGxvY2FsIGltYWdlc1xuICAgICAgdGhpcy5jbGVhbkltYWdlRmlsZXMocHJvamVjdCk7XG5cbiAgICAgIC8vIHNhdmUgdGhlIGRhdGEgdG8gdGhlIHByb2plY3RzIGxpc3RcbiAgICAgIGZzLndyaXRlRmlsZShwcm9qZWN0RmlsZXNQYXRoICsgcHJvamVjdC5pZCArICdfaGlzdG9yeS5qc29uJywgSlNPTi5zdHJpbmdpZnkoW10pLCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgaWYgKGVycikge1xuICAgICAgICAgIGRmZC5yZWplY3QoZXJyKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICAvLyBzYXZlIHRoZSBkYXRhIHRvIHRoZSBpZCBwcm9qZWN0XG4gICAgICAgIGZzLndyaXRlRmlsZShwcm9qZWN0RmlsZXNQYXRoICsgcHJvamVjdC5pZCArICcuanNvbicsIEpTT04uc3RyaW5naWZ5KHByb2plY3QpLCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICBpZiAoZXJyKSB7XG4gICAgICAgICAgICBkZmQucmVqZWN0KGVycik7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgLy8gdXBkYXRlIHRoZSBkYXRhIG9uIHRoZSBwcm9qZWN0cyBsaXN0XG4gICAgICAgICAgZnMud3JpdGVGaWxlKHByb2plY3RzUGF0aCwgSlNPTi5zdHJpbmdpZnkobWFpblByb2plY3RzKSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICBpZiAoZXJyKSB7XG4gICAgICAgICAgICAgIGRmZC5yZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyByZWRpcmVjdCB1c2VyIHRvIHRoZSBzZXR0aW5ncyBwYWdlXG4gICAgICAgICAgICBkZmQucmVzb2x2ZSgpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4gZGZkLnByb21pc2U7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIHBhc3MgaW4gYSBwcm9qZWN0SWQsIHRoZW4gaXQgd2lsbCByZWFkIHRoZSBwcm9qZWN0IGFuZCBpdHMgY3VycmVudCBiYXRjaCBvZiBmaWxlcyB0byB1cGxvYWRcbiAgICAgKiBvbmNlIGNvbXBsZXRlLCBpdCB3aWxsIGNsZWFuIG91dCBhbnkgbG9jYWwgc2NyZWVucyBhbmQgcmVwbGFjZSB3aXRoIGF3cyByZXNvdXJjZXNcbiAgICAgKi9cbiAgICBzeW5jOiBmdW5jdGlvbihpZCkge1xuICAgICAgaWYgKCFpZCkge3JldHVybjt9XG5cbiAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICB2YXIgZCA9ICRxLmRlZmVyKCk7XG4gICAgICB2YXIgcHJvamVjdCA9IHRoaXMuZ2V0QnlJZChpZCk7XG4gICAgICB2YXIgcHJvamVjdEZpbGVzID0gdGhpcy5nZXRUeXBlQnlJZChpZCwgJ2hpc3RvcnknKTtcbiAgICAgIHZhciByZWFkeUZpbGVzID0gW107XG5cbiAgICAgIC8vIHB1bGwgb3V0IGZpbGVzIHRoYXQgYXJlIGFscmVhZHkgaW5zaWRlIGF3cywgcHJlcCBmb3IgdXBsb2FkXG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHByb2plY3RGaWxlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICB2YXIgdG1wRmlsZSA9IHByb2plY3RGaWxlc1tpXTtcbiAgICAgICAgaWYgKHRtcEZpbGUuc291cmNlICYmIHRtcEZpbGUuc291cmNlLnNlYXJjaCgnYW1hem9uJykgPT09IC0xKSB7XG4gICAgICAgICAgdmFyIHNyYyA9IHRtcEZpbGUuc291cmNlO1xuICAgICAgICAgIHZhciB0eXBlID0gdG1wRmlsZS50eXBlO1xuICAgICAgICAgIHZhciBwYXRoID0gX19kaXJuYW1lICsgJy9zY3JlZW5zLycgKyB0eXBlICsgJy8nICsgcHJvamVjdC5pZCArICcvJyArIHNyYztcbiAgICAgICAgICByZWFkeUZpbGVzLnB1c2goeyBrZXk6IHR5cGUgKyAnLycgKyBzcmMsIHBhdGg6IHBhdGggfSk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gdXBsb2FkIGZpbGVzXG4gICAgICBBV1MuaW5pdCgpXG4gICAgICAgIC51cGxvYWQocmVhZHlGaWxlcywgcHJvamVjdC5pZClcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24ocmVzKSB7XG5cbiAgICAgICAgICAvLyBkbyBwb3N0LXByb2Nlc3MgYWN0aW9uXG4gICAgICAgICAgX3RoaXMuY2xlYW5BZnRlclN5bmMocHJvamVjdCwgcmVzKS50aGVuKGQucmVzb2x2ZSwgZC5yZWplY3QpO1xuICAgICAgICB9LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICBkLnJlamVjdChlcnIpO1xuICAgICAgICB9KTtcblxuICAgICAgcmV0dXJuIGQucHJvbWlzZTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogY2xlYW4gbG9jYWwgaW1hZ2VzLCB1cGRhdGUgaGlzdG9yeSB3aXRoIGF3cyByZXNvdXJjZXMsIHJldHVybnMgdGhlIHVwZGF0ZXNcbiAgICAgKi9cbiAgICBjbGVhbkFmdGVyU3luYzogZnVuY3Rpb24gKHByb2plY3QsIG5ld1JlZnMpIHtcbiAgICAgIHZhciBkZmRkID0gJHEuZGVmZXIoKTtcbiAgICAgIHZhciBoaXN0b3J5RGF0YSA9IGdldEpzb25GaWxlKHByb2plY3RGaWxlc1BhdGggKyBwcm9qZWN0LmlkICsgJ19oaXN0b3J5Lmpzb24nLCBbXSk7XG4gICAgICB2YXIgdXBkYXRlZFJlbW90ZUZpbGVzID0gW107XG4gICAgICB2YXIgcXVldWVQcm9taXNlcyA9IFtdO1xuICAgICAgcHJvamVjdC51cGRhdGVkQXQgPSAoK25ldyBEYXRlKCkpO1xuXG4gICAgICAvLyBsb29wIHRocm91Z2ggbmV3IGZpbGVzXG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG5ld1JlZnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdmFyIHRtcFNyYyA9IG5ld1JlZnNbaV07XG4gICAgICAgIHZhciB0bXBSZWYgPSB0bXBTcmMuc3BsaXQoJy8nKTtcbiAgICAgICAgdmFyIHRtcFR5cGUgPSB0bXBSZWZbdG1wUmVmLmxlbmd0aCAtIDJdO1xuICAgICAgICB2YXIgdG1wQWxpYXMgPSB0bXBSZWZbdG1wUmVmLmxlbmd0aCAtIDFdO1xuXG4gICAgICAgIGhpc3RvcnlEYXRhLm1hcChmdW5jdGlvbihpdGVtLCBpZHgpIHtcblxuICAgICAgICAgIC8vIHVwZGF0ZSBoaXN0b3J5IHJlZlxuICAgICAgICAgIGlmIChpdGVtLnNvdXJjZSA9PT0gdG1wQWxpYXMgJiYgdG1wVHlwZSA9PT0gJ2NvbXBhcmUnKSB7XG4gICAgICAgICAgICAvLyBtYWtlIHN1cmUgdG8gcmVtb3ZlIHRoZSBkaWZmIGFsc29cbiAgICAgICAgICAgIHZhciByZW1SZWZQYXRoID0gX19kaXJuYW1lICsgJy9zY3JlZW5zLycgKyB0bXBUeXBlICsgJy8nICsgcHJvamVjdC5pZCArICcvJyArIHRtcEFsaWFzO1xuICAgICAgICAgICAgdmFyIHJlbVJlZiA9IHByb21pc2VSZW1vdmUocmVtUmVmUGF0aCk7XG4gICAgICAgICAgICB2YXIgcmVtUmVmRGlmZiA9IHByb21pc2VSZW1vdmUocmVtUmVmUGF0aC5yZXBsYWNlKCcuJywgJ19kaWZmLicpKTtcblxuICAgICAgICAgICAgLy8gdXBkYXRlIGhpc3RvcnlcbiAgICAgICAgICAgIGRlbGV0ZSBoaXN0b3J5RGF0YVtpZHhdLnNvdXJjZTtcbiAgICAgICAgICAgIGhpc3RvcnlEYXRhW2lkeF0ucmVtb3RlU291cmNlID0gbmV3UmVmc1tpXTtcblxuICAgICAgICAgICAgLy8gYWRkIHRvIHByb21pc2UgbGlzdFxuICAgICAgICAgICAgcXVldWVQcm9taXNlcy5wdXNoKHJlbVJlZik7XG4gICAgICAgICAgICBxdWV1ZVByb21pc2VzLnB1c2gocmVtUmVmRGlmZik7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgLy8gc2F2ZSBoaXN0b3J5ICYgcHJvamVjdFxuICAgICAgdmFyIHByb2plY3RGaWxlID0gX19kaXJuYW1lICsgJy9wcm9qZWN0cy8nICsgcHJvamVjdC5pZCArICcuanNvbic7XG4gICAgICB2YXIgcHJvamVjdEhpc3RvcnlGaWxlID0gcHJvamVjdEZpbGUucmVwbGFjZSgnLmpzb24nLCAnX2hpc3RvcnkuanNvbicpO1xuICAgICAgdmFyIHByb2plY3RXcml0ZSA9IHByb21pc2VXcml0ZShwcm9qZWN0RmlsZSwgcHJvamVjdCk7XG4gICAgICB2YXIgcHJvamVjdEhpc3RvcnlXcml0ZSA9IHByb21pc2VXcml0ZShwcm9qZWN0SGlzdG9yeUZpbGUsIGhpc3RvcnlEYXRhKTtcbiAgICAgIHF1ZXVlUHJvbWlzZXMudW5zaGlmdChwcm9qZWN0V3JpdGUpO1xuICAgICAgcXVldWVQcm9taXNlcy51bnNoaWZ0KHByb2plY3RIaXN0b3J5V3JpdGUpO1xuXG4gICAgICAvLyBhZGQgcHJvamVjdCBmaWxlcyB0byB0aGUgdXBsb2FkIHJlYWRpbmVzc1xuICAgICAgdXBkYXRlZFJlbW90ZUZpbGVzLnB1c2goeyBrZXk6IHByb2plY3QuaWQsIHBhdGg6IHByb2plY3RGaWxlIH0pO1xuICAgICAgdXBkYXRlZFJlbW90ZUZpbGVzLnB1c2goeyBrZXk6IHByb2plY3QuaWQgKyAnX2hpc3RvcnknLCBwYXRoOiBwcm9qZWN0SGlzdG9yeUZpbGUgfSk7XG5cbiAgICAgIC8vIHVwbG9hZCB1cGRhdGVkIGhpc3RvcnkgJiBwcm9qZWN0XG4gICAgICB2YXIgYXdzVXBsb2FkID0gQVdTLmluaXQoKS51cGxvYWQodXBkYXRlZFJlbW90ZUZpbGVzLCBwcm9qZWN0LmlkKTtcbiAgICAgIHF1ZXVlUHJvbWlzZXMudW5zaGlmdChhd3NVcGxvYWQpO1xuXG4gICAgICAvLyBkbyBhbGwgcHJvbWlzZSBvcGVyYXRpb25zXG4gICAgICAkcS5hbGwocXVldWVQcm9taXNlcykudGhlbihkZmRkLnJlc29sdmUsIGRmZGQucmVqZWN0KTtcblxuICAgICAgcmV0dXJuIGRmZGQucHJvbWlzZTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogY2xlYW4gbG9jYWwgaW1hZ2VzLCB1cGRhdGUgaGlzdG9yeSB3aXRoIGF3cyByZXNvdXJjZXMsIHJldHVybnMgdGhlIHVwZGF0ZXNcbiAgICAgKi9cbiAgICBjbGVhbkltYWdlRmlsZXM6IGZ1bmN0aW9uIChwcm9qZWN0KSB7XG4gICAgICB2YXIgYmFzZSA9IF9fZGlybmFtZSArICcvc2NyZWVucy9CQVNFLycgKyBwcm9qZWN0LmlkO1xuICAgICAgdmFyIGNvbXBzID0gYmFzZS5yZXBsYWNlKCdCQVNFJywgJ2NvbXBhcmUnKTtcbiAgICAgIHZhciByZWZzID0gYmFzZS5yZXBsYWNlKCdCQVNFJywgJ3JlZmVyZW5jZScpO1xuXG4gICAgICByZW1vdmVBbGxJbkRpcmVjdG9yeShjb21wcyk7XG4gICAgICByZW1vdmVBbGxJbkRpcmVjdG9yeShyZWZzKTtcbiAgICB9XG5cbiAgfTtcbn1dKTtcbiIsIk1VRy5maWx0ZXIoJ3RpbWVBZ28nLFxuWydub3dUaW1lJywgJ3RpbWVBZ28nLFxuZnVuY3Rpb24gKG5vd1RpbWUsIHRpbWVBZ28pIHtcbiAgcmV0dXJuIGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgIHZhciBmcm9tVGltZSA9IHRpbWVBZ28ucGFyc2UodmFsdWUpO1xuICAgIHZhciBkaWZmID0gbm93VGltZS5nZXRUaW1lKCkgLSBmcm9tVGltZTtcbiAgICByZXR1cm4gdGltZUFnby5pbldvcmRzKGRpZmYpO1xuICB9O1xufV0pO1xuIiwidmFyIGlwYyA9IHJlcXVpcmUoJ2lwYycpO1xuXG5NVUcuY29udHJvbGxlcignTWFpbkN0cmwnLFxuWyckcm9vdFNjb3BlJywgJyRzY29wZScsICckc3RhdGUnLCAnQ29uZmlnJywgJ1Byb2plY3RzJyxcbmZ1bmN0aW9uKCRyb290U2NvcGUsICRzY29wZSwgJHN0YXRlLCBDb25maWcsIFByb2plY3RzKSB7XG4gICRyb290U2NvcGUuY3VycmVudFByb2plY3RJZCA9ICcnO1xuXG4gICRzY29wZS5jcmVhdGVOZXdQcm9qZWN0ID0gZnVuY3Rpb24oKSB7XG4gICAgUHJvamVjdHMuY3JlYXRlTmV3KCkudGhlbihmdW5jdGlvbihyZXMpIHtcbiAgICAgICRyb290U2NvcGUuJGJyb2FkY2FzdCgnU0lERVBBTkVMOk5FV1BST0pFQ1QnLCByZXMpO1xuICAgICAgJHN0YXRlLmdvKCdwcm9qZWN0cy5zZXR0aW5ncycsIHsgaWQ6IHJlcy5pZCB9KTtcbiAgICB9LFxuXG4gICAgZnVuY3Rpb24oZXJyKSB7XG4gICAgICBjb25zb2xlLmxvZygnZXJyJywgZXJyKTtcbiAgICB9KTtcbiAgfTtcblxuICBpcGMub24oJ05BVklHQVRFOlRPJywgZnVuY3Rpb24oYXJncykge1xuICAgIGlmICghYXJncyB8fCAhYXJncy5sb2NhdGlvbikge3JldHVybjt9XG5cbiAgICBjb25zb2xlLmxvZygnTkFWSUdBVEU6VE8nLCBhcmdzKTtcbiAgICAkc3RhdGUuZ28oYXJncy5sb2NhdGlvbik7XG4gIH0pO1xuXG4gIC8vIFVTRSBUSElTIGluc3RlYWQgb2YgJHNjb3BlLiRhcHBseSgpOyBJdCB3aWxsIG1ha2UgdGhlICRkaWdlc3QgZXJyb3JzIG5vdCBoYXBwZW4uXG4gICRyb290U2NvcGUuU2FmZUFwcGx5ID0gZnVuY3Rpb24oc2NvcGUsIGZuKSB7XG4gICAgaWYgKHNjb3BlLiQkcGhhc2UgfHwgc2NvcGUuJHJvb3QuJCRwaGFzZSkge1xuICAgICAgaWYgKHR5cGVvZiBmbiAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgZm4oKTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgc2NvcGUuJGFwcGx5KGZuKTtcbiAgICB9XG4gIH07XG5cbn1dKTtcbiIsInZhciBmcyA9IHJlcXVpcmUoJ2ZzJyk7XG52YXIgQVdTID0gcmVxdWlyZSgnLi92ZW5kb3IvY29yZS9hd3MnKTtcblxuTVVHLmNvbnRyb2xsZXIoJ1ByZWZlcmVuY2VzQ3RybCcsXG5bJyRyb290U2NvcGUnLCAnJHNjb3BlJywgJyRzdGF0ZScsXG5mdW5jdGlvbigkcm9vdFNjb3BlLCAkc2NvcGUsICRzdGF0ZSkge1xuICAkc2NvcGUuYXdzQ29uZmlnID0ge1xuICAgIGJ1Y2tldDogJycsXG4gICAgYWNjZXNzS2V5SWQ6ICcnLFxuICAgIHNlY3JldEFjY2Vzc0tleTogJydcbiAgfTtcblxuICAvLyBncmFiIHNldHRpbmdzIHJlYWwgcXVpY2tcbiAgJHNjb3BlLmF3c0NvbmZpZyA9IEFXUy5nZXRDb25maWcoKTtcblxuICAkc2NvcGUuc2F2ZSA9IGZ1bmN0aW9uKCkge1xuICAgIC8vIHNhdmUgdGhlIEFXUyBjb25maWdcbiAgICBBV1Muc2V0Q29uZmlnKCRzY29wZS5hd3NDb25maWcpO1xuICB9O1xuXG59XSk7XG4iLCJNVUcuY29udHJvbGxlcignUHJvamVjdEN0cmwnLFxuWyckcm9vdFNjb3BlJywgJyRzY29wZScsICckc3RhdGVQYXJhbXMnLCAnUHJvamVjdHMnLFxuZnVuY3Rpb24oJHJvb3RTY29wZSwgJHNjb3BlLCAkc3RhdGVQYXJhbXMsIFByb2plY3RzKSB7XG5cbiAgLy8gQWxsb3cgdGhlIGNoaWxkIHZpZXdzIHRvIGJpbmQgdG8gc2FtZSBzY29wZVxuICAkcm9vdFNjb3BlLnByb2plY3QgPSBQcm9qZWN0cy5nZXRCeUlkKCRzdGF0ZVBhcmFtcy5pZCk7XG5cbn1dKTtcbiIsIk1VRy5jb250cm9sbGVyKCdQcm9qZWN0SGlzdG9yeUN0cmwnLFxuWyckcm9vdFNjb3BlJywgJyRzY29wZScsICckc3RhdGVQYXJhbXMnLCAnUHJvamVjdHMnLFxuZnVuY3Rpb24oJHJvb3RTY29wZSwgJHNjb3BlLCAkc3RhdGVQYXJhbXMsIFByb2plY3RzKSB7XG4gICRzY29wZS5hY3RpdmVGaWx0ZXIgPSAnQWxsJztcbiAgJHNjb3BlLmFjdGl2ZUZpbHRlclF1ZXJ5ID0gJyc7XG5cbiAgLy8gZ3JhYiBhbGwgdGhlIGhpc3RvcnkgZGF0YVxuICAkc2NvcGUuaGlzdG9yeUl0ZW1zID0gUHJvamVjdHMuZ2V0VHlwZUJ5SWQoJHN0YXRlUGFyYW1zLmlkLCAnaGlzdG9yeScpO1xuXG4gICRzY29wZS5jaGFuZ2VGaWx0ZXIgPSBmdW5jdGlvbih0eXBlKSB7XG4gICAgJHNjb3BlLmFjdGl2ZUZpbHRlciA9IHR5cGU7XG4gICAgJHNjb3BlLmFjdGl2ZUZpbHRlclF1ZXJ5ID0gKHR5cGUgPT0gJ0FsbCcpID8gJycgOiB0eXBlO1xuICB9O1xuXG4gICRzY29wZS5wcmV2aWV3SXRlbSA9IGZ1bmN0aW9uKGl0ZW0pIHtcbiAgICAkcm9vdFNjb3BlLiRlbWl0KCdNT0RBTDpPUEVOJywgeyB0eXBlOiAncHJldmlldycsIGl0ZW06IGl0ZW0sIHByb2plY3Q6ICRyb290U2NvcGUucHJvamVjdCB9KTtcbiAgfTtcblxufV0pO1xuIiwidmFyIGlwYyA9IHJlcXVpcmUoJ2lwYycpO1xuXG5NVUcuY29udHJvbGxlcignUHJvamVjdFJ1bm5lckN0cmwnLFxuWyckcm9vdFNjb3BlJywgJyRzY29wZScsICckdGltZW91dCcsICckc3RhdGVQYXJhbXMnLCAnUHJvamVjdHMnLFxuZnVuY3Rpb24oJHJvb3RTY29wZSwgJHNjb3BlLCAkdGltZW91dCwgJHN0YXRlUGFyYW1zLCBQcm9qZWN0cykge1xuICB2YXIgZGVmYXVsdEZvcm1hdCA9IFt7IHR5cGU6ICdzdWNjZXNzJywgaXRlbXM6IFtdfSwgeyB0eXBlOiAnd2FybmluZycsIGl0ZW1zOiBbXX0sIHsgdHlwZTogJ2Vycm9yJywgaXRlbXM6IFtdfV07XG5cbiAgJHNjb3BlLnByb2Nlc3NpbmcgPSBmYWxzZTtcbiAgJHNjb3BlLmhhc1NldHRpbmdzID0gZmFsc2U7XG4gICRzY29wZS5oYXNSZWZlcmVuY2UgPSBmYWxzZTtcbiAgJHNjb3BlLmhhc0NvbXBhcmUgPSBmYWxzZTtcbiAgJHNjb3BlLnJ1bm5pbmdUeXBlID0gJ3JlZmVyZW5jZSc7XG4gICRzY29wZS5iYXRjaEl0ZW1zID0gZGVmYXVsdEZvcm1hdDtcbiAgJHNjb3BlLmFjdGl2ZURhdGEgPSB7fTtcbiAgJHNjb3BlLmN1cnJlbnRCYXRjaCA9ICRyb290U2NvcGUucHJvamVjdC5jdXJyZW50QmF0Y2ggfHwgMDtcbiAgJHNjb3BlLnByb2dyZXNzID0ge1xuICAgIHBlcmNlbnQ6IDAsXG4gICAgdGl0bGU6ICdTdGFydGluZydcbiAgfTtcblxuICAvLyBQdXRzIGRhdGEgaW50byBzb3J0ZWQgc2VjdGlvbnNcbiAgZnVuY3Rpb24gcHJvY2Vzc0JhdGNoKGFsbERhdGEpIHtcbiAgICBpZiAoIWFsbERhdGEgfHwgYWxsRGF0YS5sZW5ndGggPCAxKSB7XG4gICAgICAkc2NvcGUuaGFzUmVmZXJlbmNlID0gZmFsc2U7XG4gICAgICByZXR1cm4gW107XG4gICAgfVxuXG4gICAgLy8gcmVzZXQganVzdCB0aGUgc3RhdHNcbiAgICAkc2NvcGUuYWN0aXZlRGF0YSA9IHt9O1xuICAgICRzY29wZS5hY3RpdmVEYXRhLnN1Y2Nlc3MgPSAwO1xuICAgICRzY29wZS5hY3RpdmVEYXRhLndhcm5pbmcgPSAwO1xuICAgICRzY29wZS5hY3RpdmVEYXRhLmVycm9yID0gMDtcbiAgICB2YXIgZm9ybWF0dGVkID0gW3sgdHlwZTogJ3N1Y2Nlc3MnLCBpdGVtczogW119LCB7IHR5cGU6ICd3YXJuaW5nJywgaXRlbXM6IFtdfSwgeyB0eXBlOiAnZXJyb3InLCBpdGVtczogW119XTtcblxuICAgIGZ1bmN0aW9uIHBsYWNlSXRlbShpdGVtKSB7XG5cbiAgICAgIC8vIEtlZXAgdGhpbmdzIG9yZ2FuaXplcyB3aXRoIHByZXNldCBwcmlvcml0eVxuICAgICAgaWYgKGl0ZW0uc3RhdHVzKSB7XG4gICAgICAgIHZhciB0YXJnZXQgPSAwO1xuXG4gICAgICAgIHN3aXRjaCAoaXRlbS5zdGF0dXMpIHtcbiAgICAgICAgICBjYXNlICd3YXJuaW5nJzpcbiAgICAgICAgICAgIHRhcmdldCA9IDE7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICBjYXNlICdmYWlsZWQnOlxuICAgICAgICAgICAgdGFyZ2V0ID0gMjtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG5cbiAgICAgICAgZm9ybWF0dGVkW3RhcmdldF0uaXRlbXMudW5zaGlmdChpdGVtKTtcbiAgICAgICAgJHNjb3BlLmFjdGl2ZURhdGFbZm9ybWF0dGVkW3RhcmdldF0udHlwZV0gPSAkc2NvcGUuYWN0aXZlRGF0YVtmb3JtYXR0ZWRbdGFyZ2V0XS50eXBlXSArIDE7XG4gICAgICB9XG4gICAgfVxuXG4gICAgYWxsRGF0YS5tYXAoZnVuY3Rpb24ob2JqLCBpZHgpIHtcbiAgICAgIGlmIChvYmouYmF0Y2ggPT09ICRzY29wZS5jdXJyZW50QmF0Y2gpIHtcbiAgICAgICAgcGxhY2VJdGVtKG9iaik7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICAkc2NvcGUuaGFzUmVmZXJlbmNlID0gdHJ1ZTtcbiAgICByZXR1cm4gZm9ybWF0dGVkO1xuICB9XG5cbiAgZnVuY3Rpb24gc2V0dXBDdXJyZW50QmF0Y2goKSB7XG4gICAgaWYgKCRyb290U2NvcGUucHJvamVjdC5jdXJyZW50QmF0Y2ggPT09IG51bGwpIHtyZXR1cm47fVxuXG4gICAgLy8gZ3JhYiBhbGwgdGhlIHJ1bm5lciB0ZXN0IGRhdGFcbiAgICB2YXIgaGlzdG9yeURhdGEgPSBQcm9qZWN0cy5nZXRUeXBlQnlJZCgkcm9vdFNjb3BlLnByb2plY3QuaWQsICdoaXN0b3J5Jyk7XG5cbiAgICAvLyBTdG9yZSB0aGUgcHJvY2Vzc2VkIGRhdGEgaW50byB0aGUgYmF0Y2ggZGF0YVxuICAgICRzY29wZS5iYXRjaEl0ZW1zID0gcHJvY2Vzc0JhdGNoKGhpc3RvcnlEYXRhKTtcblxuICAgIC8vIHNldHVwIHdoaWNoIHZpZXcgdG8gc2hvdyBiYXNlZCBvbiBoaXN0b3J5XG4gICAgJHNjb3BlLnJ1bm5pbmdUeXBlID0gKCRyb290U2NvcGUucHJvamVjdC5jdXJyZW50UmVmZXJlbmNlID49ICRyb290U2NvcGUucHJvamVjdC5jdXJyZW50QmF0Y2gpID8gJ3JlZmVyZW5jZScgOiAnY29tcGFyZSc7XG4gIH1cblxuICAvLyB2YWxpZGF0aW9uIG9mIHByb2plY3RcbiAgZnVuY3Rpb24gdmFsaWRhdGVQcm9qZWN0KCkge1xuICAgIC8vIHZlcmlmeSBpZiBpdHMgdmFsaWRcbiAgICB2YXIgaXNWYWxpZCA9IFByb2plY3RzLnZhbGlkYXRlKCRyb290U2NvcGUucHJvamVjdCk7XG5cbiAgICAvLyBhbGVydCBvZiBpbnZhbGlkaXR5XG4gICAgaWYgKCFpc1ZhbGlkKSB7XG4gICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoJ0FMRVJUOkZJUkUnLCB7IHRpdGxlOiAnUGxlYXNlIGZpbmlzaCBjb25maWd1cmluZyBzZXR0aW5ncyEnLCBkdXI6IDUsIHR5cGU6ICdlcnJvcicsIGljb246ICdzdG9wJyB9KTtcbiAgICB9XG5cbiAgICByZXR1cm4gaXNWYWxpZDtcbiAgfVxuXG4gIC8vIGNoZWNrcyBmb3IgY2hhbmdlcyBhbmQgdXBkYXRlcyBVSSBhY2NvdXJkaW5nbHlcbiAgZnVuY3Rpb24gY2hlY2tTdGF0ZSgpIHtcbiAgICAkc2NvcGUuaGFzU2V0dGluZ3MgPSB2YWxpZGF0ZVByb2plY3QoKTtcbiAgICAkc2NvcGUuaGFzUmVmZXJlbmNlID0gKCRyb290U2NvcGUucHJvamVjdC5jdXJyZW50UmVmZXJlbmNlICE9PSBudWxsKTtcblxuICAgIGlmICgkc2NvcGUucnVubmluZ1R5cGUgPT09ICdyZWZlcmVuY2UnKSB7XG4gICAgICAkc2NvcGUuaGFzQ29tcGFyZSA9IGZhbHNlO1xuICAgIH0gZWxzZSB7XG4gICAgICAkc2NvcGUuaGFzQ29tcGFyZSA9ICgkcm9vdFNjb3BlLnByb2plY3QuY3VycmVudEJhdGNoICE9PSBudWxsICYmICRyb290U2NvcGUucHJvamVjdC5jdXJyZW50QmF0Y2ggIT09IDApO1xuICAgICAgJHNjb3BlLmhhc0NvbXBhcmUgPSAoJHJvb3RTY29wZS5wcm9qZWN0LmN1cnJlbnRSZWZlcmVuY2UgPD0gJHJvb3RTY29wZS5wcm9qZWN0LmN1cnJlbnRCYXRjaCk7XG4gICAgfVxuICB9XG5cbiAgLy8gZ3JhYiB0aGUgbGF0ZXN0IGRhdGEgZm9yIHRoZSBwcm9qZWN0XG4gIGZ1bmN0aW9uIGdyYWJMYXRlc3REYXRhKCkge1xuICAgICRyb290U2NvcGUucHJvamVjdCA9IFByb2plY3RzLmdldEJ5SWQoJHJvb3RTY29wZS5wcm9qZWN0LmlkKTtcbiAgICAkc2NvcGUuY3VycmVudEJhdGNoID0gJHJvb3RTY29wZS5wcm9qZWN0LmN1cnJlbnRCYXRjaDtcblxuICAgIC8vIFNldCB0aGUgYWN0aXZlIGRhdGEgYmFzZWQgb24gY3VycmVudEJhdGNoXG4gICAgJHNjb3BlLmFjdGl2ZURhdGEgPSAoJHJvb3RTY29wZS5wcm9qZWN0ICYmICRyb290U2NvcGUucHJvamVjdC5iYXRjaEhpc3RvcnkpID8gJHJvb3RTY29wZS5wcm9qZWN0LmJhdGNoSGlzdG9yeVskc2NvcGUuY3VycmVudEJhdGNoXSA6IG51bGw7XG5cbiAgICAkcm9vdFNjb3BlLiRlbWl0KCdTSURFUEFORUw6VVBEQVRFJywgJHJvb3RTY29wZS5wcm9qZWN0KTtcbiAgfVxuXG4gIC8vIHN5bmMgYWxsIHByb2plY3QgZmlsZXMgYW5kIHNldHRpbmdzIHRvIEFXU1xuICB2YXIgc3luY2luZyA9IGZhbHNlO1xuXG4gIGZ1bmN0aW9uIHN5bmNQcm9qZWN0KCkge1xuICAgIGlmICh0eXBlb2YgJHJvb3RTY29wZS5wcm9qZWN0Lm1ldGEuYXV0b1N5bmNBd3MgIT09IHVuZGVmaW5lZCAmJiAkcm9vdFNjb3BlLnByb2plY3QubWV0YS5hdXRvU3luY0F3cyA9PT0gdHJ1ZSAmJiAhc3luY2luZykge1xuICAgICAgJHJvb3RTY29wZS4kYnJvYWRjYXN0KCdBTEVSVDpGSVJFJywgeyB0aXRsZTogJ1N5bmMgU3RhcnRpbmcnLCBkdXI6IDMsIHR5cGU6ICdpbmZvJyB9KTtcbiAgICAgIHN5bmNpbmcgPSB0cnVlO1xuXG4gICAgICBQcm9qZWN0cy5zeW5jKCRyb290U2NvcGUucHJvamVjdC5pZClcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICAgc3luY2luZyA9IGZhbHNlO1xuICAgICAgICAgICRyb290U2NvcGUuJGJyb2FkY2FzdCgnQUxFUlQ6RklSRScsIHsgdGl0bGU6ICdTeW5jIENvbXBsZXRlJywgZHVyOiAzLCB0eXBlOiAnc3VjY2VzcycsIGljb246ICdjaGVjaycgfSk7XG4gICAgICAgIH1cblxuICAgICAgICAsIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgIGNvbnNvbGUubG9nKCdzeW5jTm93IGVycicsIGVycik7XG4gICAgICAgICAgc3luY2luZyA9IGZhbHNlO1xuICAgICAgICAgICRyb290U2NvcGUuJGJyb2FkY2FzdCgnQUxFUlQ6RklSRScsIHsgdGl0bGU6ICdTeW5jIEZhaWxlZCcsIGR1cjogNSwgdHlwZTogJ2Vycm9yJywgaWNvbjogJ3N0b3BlJyB9KTtcbiAgICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgZ3JhYkxhdGVzdERhdGEoKTtcbiAgc2V0dXBDdXJyZW50QmF0Y2goKTtcbiAgY2hlY2tTdGF0ZSgpO1xuXG4gIC8vIEZpcmUgb2ZmIHRoZSB2aWV3ZXJcbiAgJHNjb3BlLnByZXZpZXdCYXRjaCA9IGZ1bmN0aW9uKGl0ZW1zKSB7XG4gICAgJHJvb3RTY29wZS4kZW1pdCgnTU9EQUw6T1BFTicsIHsgdHlwZTogJ2JhdGNoJywgaXRlbXM6IGl0ZW1zLCBwcm9qZWN0OiAkcm9vdFNjb3BlLnByb2plY3QgfSk7XG4gIH07XG5cbiAgLy8gRmlyZSBvZmYgYSBuZXcgdGVzdCEhXG4gICRzY29wZS5uZXdDb21wYXJlID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIHZhbGlkID0gdmFsaWRhdGVQcm9qZWN0KCk7XG5cbiAgICAvLyB2YWxpZGF0aW9uIHBhdXNlXG4gICAgaWYgKCF2YWxpZCkge3JldHVybjt9XG5cbiAgICAkc2NvcGUucnVubmluZ1R5cGUgPSAnY29tcGFyZSc7XG4gICAgJHNjb3BlLnByb2Nlc3NpbmcgPSB0cnVlO1xuXG4gICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICRyb290U2NvcGUuJGVtaXQoJ1BSRUxPQURFUjpPTicpO1xuICAgIH0sIDEwKTtcblxuICAgIGlwYy5zZW5kKCdSVU5ORVI6RklSRScsIHsgdHlwZTogJ2NvbXBhcmUnLCBwcm9qZWN0SWQ6ICRyb290U2NvcGUucHJvamVjdC5pZCB9KTtcbiAgfTtcblxuICAvLyBzZXR1cCBuZXcgcmVmZXJlbmNlXG4gICRzY29wZS5uZXdSZWZlcmVuY2UgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgdmFsaWQgPSB2YWxpZGF0ZVByb2plY3QoKTtcblxuICAgIC8vIHZhbGlkYXRpb24gcGF1c2VcbiAgICBpZiAoIXZhbGlkKSB7cmV0dXJuO31cblxuICAgICRzY29wZS5wcm9jZXNzaW5nID0gdHJ1ZTtcbiAgICAkc2NvcGUucnVubmluZ1R5cGUgPSAncmVmZXJlbmNlJztcbiAgICAkc2NvcGUuaGFzQ29tcGFyZSA9IGZhbHNlO1xuXG4gICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICRyb290U2NvcGUuJGVtaXQoJ1BSRUxPQURFUjpPTicpO1xuICAgIH0sIDEwKTtcblxuICAgIGlwYy5zZW5kKCdSVU5ORVI6RklSRScsIHsgdHlwZTogJ3JlZmVyZW5jZScsIHByb2plY3RJZDogJHJvb3RTY29wZS5wcm9qZWN0LmlkIH0pO1xuICB9O1xuXG4gIGZ1bmN0aW9uIHJ1bm5lckV2ZW50cyhhcmdzKSB7XG4gICAgaWYgKCFhcmdzIHx8ICFhcmdzLm1zZyB8fCAhYXJncy5wZXJjZW50KSB7cmV0dXJuO31cblxuICAgIC8vIFdyaXRlIHRoZSBwcm9ncmVzcyB0byBVSVxuICAgICRzY29wZS5wcm9ncmVzcy5wZXJjZW50ID0gcGFyc2VJbnQoYXJncy5wZXJjZW50LCAxMCk7XG4gICAgJHNjb3BlLnByb2dyZXNzLnRpdGxlID0gKGFyZ3MubXNnKSA/IGFyZ3MubXNnIDogJHNjb3BlLnByb2dyZXNzLnRpdGxlO1xuXG4gICAgJHJvb3RTY29wZS4kZW1pdCgnUFJFTE9BREVSOlVQREFURScsIGFyZ3MpO1xuICB9XG5cbiAgLy8gc2lnbmFsIFVJIG9mIGNoYW5nZXNcbiAgZnVuY3Rpb24gcnVubmVyQ29tcGxldGUoKSB7XG4gICAgJHRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICBncmFiTGF0ZXN0RGF0YSgpO1xuICAgICAgc2V0dXBDdXJyZW50QmF0Y2goKTtcbiAgICAgIGNoZWNrU3RhdGUoKTtcbiAgICAgIHN5bmNQcm9qZWN0KCk7XG4gICAgICAkc2NvcGUucHJvY2Vzc2luZyA9IGZhbHNlO1xuICAgIH0sIDMpO1xuICB9XG5cbiAgZnVuY3Rpb24gcnVubmVyRmFpbGVkKHJlYXNvbikge1xuICAgIGNvbnNvbGUubG9nKCdSVU5ORVI6RkFJTEVEIHJlYXNvbicsIHJlYXNvbik7XG4gICAgJHNjb3BlLnByb2Nlc3NpbmcgPSBmYWxzZTtcbiAgfVxuXG4gIGlwYy5vbignUlVOTkVSOlBST0dSRVNTJywgcnVubmVyRXZlbnRzKTtcbiAgaXBjLm9uKCdSVU5ORVI6Q09NUExFVEUnLCBydW5uZXJDb21wbGV0ZSk7XG4gIGlwYy5vbignUlVOTkVSOkZBSUxFRCcsIHJ1bm5lckZhaWxlZCk7XG5cbn1dKTtcbiIsInZhciBmcyA9IHJlcXVpcmUoJ2ZzJyk7XG5cbk1VRy5jb250cm9sbGVyKCdQcm9qZWN0U2V0dGluZ3NDdHJsJyxcblsnJHJvb3RTY29wZScsICckc2NvcGUnLCAnJHN0YXRlJywgJ1Byb2plY3RzJyxcbmZ1bmN0aW9uKCRyb290U2NvcGUsICRzY29wZSwgJHN0YXRlLCBQcm9qZWN0cykge1xuICB2YXIgc2F2ZVRpbWVyO1xuXG4gICRzY29wZS5zeW5jaW5nID0gZmFsc2U7XG4gICRzY29wZS5zZWxlY3RvclR5cGVzID0gWydjb250YWluZXInLCAnaGlkZScsICdyZW1vdmUnXTtcbiAgJHNjb3BlLmhhc0NoYW5nZXMgPSBmYWxzZTtcbiAgJHNjb3BlLmhhc0F3c1NldHRpbmdzID0gZmFsc2U7XG4gICRzY29wZS5tYXN0ZXIgPSB7fTtcbiAgYW5ndWxhci5jb3B5KCRyb290U2NvcGUucHJvamVjdCwgJHNjb3BlLm1hc3Rlcik7XG5cbiAgZnVuY3Rpb24gYWRkTmV3VHlwZSh0eXBlLCBkYXRhKSB7XG4gICAgJHJvb3RTY29wZS5wcm9qZWN0W3R5cGVdLnB1c2goZGF0YSk7XG4gIH1cblxuICBmdW5jdGlvbiBjaGVja0F3c1NldHRpbmdzKCkge1xuICAgIC8vIHJlYWQgaWYgYXdzIHNldHRpbmdzIGFuZCBpZiB0aGV5IGFyZSBjb3JyZWN0XG4gICAgdmFyIGZpbGUgPSBQcm9qZWN0cy5nZXQoJy9jb25maWcvYXdzLmpzb24nLCB7fSk7XG5cbiAgICBpZiAoIWZpbGUgfHwgIWZpbGUuYnVja2V0IHx8ICFmaWxlLmFjY2Vzc0tleUlkIHx8ICFmaWxlLnNlY3JldEFjY2Vzc0tleSkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIHJldHVybiB0cnVlO1xuICB9XG5cbiAgLy8gaW5pdGlhbCBhd3MgY3JlZCBjaGVja1xuICAkc2NvcGUuaGFzQXdzU2V0dGluZ3MgPSBjaGVja0F3c1NldHRpbmdzKCk7XG5cbiAgLy8gV2F0Y2ggZm9yIGNoYW5nZXMsIHNvIHdlIGNhbiBzYXZlXG4gICRzY29wZS4kd2F0Y2goJ3Byb2plY3QnLCBmdW5jdGlvbihuViwgb1YpIHtcbiAgICBpZiAoblYgIT0gb1YpIHtcbiAgICAgICRzY29wZS5oYXNDaGFuZ2VzID0gdHJ1ZTtcblxuICAgICAgLy8gc2F2ZSB0aGUgZmlsZSBmb3IgY29udmVuaWVuY2VcbiAgICAgICRzY29wZS5zYXZlKCk7XG4gICAgfVxuICB9LCB0cnVlKTtcblxuICAvLyBUT0RPOiBzZXR1cCB2YWxpZGF0aW9uc1xuICAvLyBzYXZlIHRoZSBjdXJyZW50IHByb2plY3RcbiAgJHNjb3BlLnNhdmUgPSBmdW5jdGlvbigpIHtcbiAgICBpZiAoc2F2ZVRpbWVyKSB7XG4gICAgICB3aW5kb3cuY2xlYXJUaW1lb3V0KHNhdmVUaW1lcik7XG4gICAgfVxuXG4gICAgLy8gdGhyb3R0bGUgdGhlIHNhdmVzLCBzaW5jZSB3ZSBzYXZlIG9uIGFueSBjaGFuZ2VzXG4gICAgc2F2ZVRpbWVyID0gc2V0VGltZW91dChmdW5jdGlvbigpIHtcblxuICAgICAgLy8gU2F2ZSB0ZWggcHJvamVjdG9pZFxuICAgICAgUHJvamVjdHMuc2F2ZSgkcm9vdFNjb3BlLnByb2plY3QpXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgIC8vIFVwZGF0ZSB0aGUgc2lkZWJhciB3aXRoIGNoYW5nZXNcbiAgICAgICAgICAkcm9vdFNjb3BlLiRlbWl0KCdTSURFUEFORUw6VVBEQVRFJywgcmVzKTtcblxuICAgICAgICAgIC8vIFVwZGF0ZSB0aGUgcmV2ZXJ0IG1vZGVsXG4gICAgICAgICAgYW5ndWxhci5jb3B5KCRyb290U2NvcGUucHJvamVjdCwgJHNjb3BlLm1hc3Rlcik7XG4gICAgICAgICAgJHNjb3BlLmhhc0NoYW5nZXMgPSBmYWxzZTtcbiAgICAgICAgfSxcblxuICAgICAgICBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgICBjb25zb2xlLmxvZygnZXJyJywgZXJyKTtcbiAgICAgICAgfSk7XG4gICAgfSwgMjAwKTtcbiAgfTtcblxuICAvLyBzeW5jIHRoaXMgcHJvamVjdCB0byBBV1NcbiAgJHNjb3BlLnN5bmNOb3cgPSBmdW5jdGlvbigpIHtcbiAgICAkc2NvcGUuc3luY2luZyA9IHRydWU7XG4gICAgJHJvb3RTY29wZS4kYnJvYWRjYXN0KCdBTEVSVDpGSVJFJywgeyB0aXRsZTogJ1N5bmMgU3RhcnRpbmcnLCBkdXI6IDUsIHR5cGU6ICdpbmZvJyB9KTtcblxuICAgIFByb2plY3RzLnN5bmMoJHJvb3RTY29wZS5wcm9qZWN0LmlkKVxuICAgICAgLnRoZW4oZnVuY3Rpb24ocmVzKSB7XG4gICAgICAgICRzY29wZS5zeW5jaW5nID0gZmFsc2U7XG4gICAgICAgICRyb290U2NvcGUuJGJyb2FkY2FzdCgnQUxFUlQ6RklSRScsIHsgdGl0bGU6ICdTeW5jIENvbXBsZXRlJywgZHVyOiA1LCB0eXBlOiAnc3VjY2VzcycsIGljb246ICdjaGVjaycgfSk7XG4gICAgICB9XG5cbiAgICAgICwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICRzY29wZS5zeW5jaW5nID0gZmFsc2U7XG4gICAgICAgIGNvbnNvbGUubG9nKCdzeW5jTm93IGVycicsIGVycik7XG4gICAgICAgICRyb290U2NvcGUuJGJyb2FkY2FzdCgnQUxFUlQ6RklSRScsIHsgdGl0bGU6ICdTeW5jIEZhaWxlZCcsIGR1cjogNSwgdHlwZTogJ2Vycm9yJywgaWNvbjogJ3N0b3BlJyB9KTtcbiAgICAgIH0pO1xuICB9O1xuXG4gIC8vIHJldmVydCB0aGUgY3VycmVudCBwcm9qZWN0XG4gICRzY29wZS5jYW5jZWxTYXZlID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIHN1cmUgPSBjb25maXJtKCdBcmUgeW91IHN1cmUgeW91IHdhbnQgdG8gY2xlYXIgYWxsIHlvdXIgY2hhbmdlcz8nKTtcbiAgICBpZiAoc3VyZSkge1xuICAgICAgLy8gcHV0IHJldmVydCBtb2RlbCBpbnRvIHRoZSBwcm9qZWN0IG1vZGVsXG4gICAgICBhbmd1bGFyLmNvcHkoJHNjb3BlLm1hc3RlciwgJHJvb3RTY29wZS5wcm9qZWN0KTtcbiAgICAgICRzY29wZS5oYXNDaGFuZ2VzID0gZmFsc2U7XG4gICAgfVxuICB9O1xuXG4gIC8vIGRlbGV0ZSB0aGUgcHJvamVjdCwgYW5kIHJlbW92ZSBmcm9tIHByb2plY3QgbGlzdHMsIHRoZW4gcmVkaXJlY3QgdG8gbWFpblxuICAkc2NvcGUuZGVsZXRlUHJvamVjdCA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBzdXJlID0gY29uZmlybSgnQXJlIHlvdSBzdXJlIHlvdSB3YW50IHRvIGRlbGV0ZSB0aGlzIHByb2plY3Q/Jyk7XG4gICAgaWYgKHN1cmUpIHtcbiAgICAgIHZhciBwcm9qZWN0SUQgPSAkcm9vdFNjb3BlLnByb2plY3QuaWQ7XG5cbiAgICAgIFByb2plY3RzLnJlbW92ZShwcm9qZWN0SUQpXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAgICRyb290U2NvcGUuJGVtaXQoJ1NJREVQQU5FTDpSRU1PVkUnLCB7IGlkOiBwcm9qZWN0SUQgfSk7XG4gICAgICAgICAgJHN0YXRlLmdvKCdtYWluJyk7XG4gICAgICAgICAgJHJvb3RTY29wZS5wcm9qZWN0ID0ge307XG4gICAgICAgICAgJHNjb3BlLmhhc0NoYW5nZXMgPSBmYWxzZTtcbiAgICAgICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoJ0FMRVJUOkZJUkUnLCB7IHRpdGxlOiAnUHJvamVjdCBSZW1vdmVkIFN1Y2Nlc3NmdWxseScsIGR1cjogNSwgdHlwZTogJ3N1Y2Nlc3MnIH0pO1xuICAgICAgICB9LFxuXG4gICAgICAgIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAgIGNvbnNvbGUubG9nKCdlcnInLCBlcnIpO1xuICAgICAgICAgICRyb290U2NvcGUuJGVtaXQoJ1NJREVQQU5FTDpSRU1PVkUnLCB7IGlkOiBwcm9qZWN0SUQgfSk7XG4gICAgICAgICAgJHN0YXRlLmdvKCdtYWluJyk7XG4gICAgICAgICAgJHJvb3RTY29wZS5wcm9qZWN0ID0ge307XG4gICAgICAgICAgJHNjb3BlLmhhc0NoYW5nZXMgPSBmYWxzZTtcbiAgICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgLy8gQWRkcyBhIG5ldyB2aWV3cG9ydCBpdGVtXG4gICRzY29wZS5hZGRWaWV3cG9ydCA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBuZXdWaWV3cG9ydCA9IHtcbiAgICAgIGFjdGl2ZTogdHJ1ZSxcbiAgICAgIG5hbWU6IG51bGwsXG4gICAgICB3aWR0aDogbnVsbCxcbiAgICAgIGhlaWdodDogbnVsbFxuICAgIH07XG5cbiAgICBhZGROZXdUeXBlKCd2aWV3cG9ydHMnLCBuZXdWaWV3cG9ydCk7XG4gIH07XG5cbiAgLy8gQWRkcyBhIG5ldyBzZWxlY3RvciBpdGVtXG4gICRzY29wZS5hZGRTZWxlY3RvciA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBuZXdTZWxlY3RvciA9IHtcbiAgICAgIGFjdGl2ZTogdHJ1ZSxcbiAgICAgIHR5cGU6ICdjb250YWluZXInLFxuICAgICAgcXVlcnk6IG51bGxcbiAgICB9O1xuXG4gICAgYWRkTmV3VHlwZSgnc2VsZWN0b3JzJywgbmV3U2VsZWN0b3IpO1xuICB9O1xuXG4gIC8vIEFkZHMgYSBuZXcgY29va2llIGl0ZW1cbiAgJHNjb3BlLmFkZENvb2tpZSA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBuZXdDb29raWUgPSB7XG4gICAgICBhY3RpdmU6IHRydWUsXG4gICAgICBuYW1lOiBudWxsLFxuICAgICAgdmFsdWU6IG51bGwsXG4gICAgICBwYXRoOiBudWxsXG4gICAgfTtcblxuICAgIGFkZE5ld1R5cGUoJ2Nvb2tpZXMnLCBuZXdDb29raWUpO1xuICB9O1xuXG4gIC8vIGFjdGl2YXRlIGEgY29va2llL3ZpZXcvc2VsZWN0XG4gICRzY29wZS5hY3RpdmF0ZVR5cGUgPSBmdW5jdGlvbih0eXBlLCBpZCkge1xuICAgICRyb290U2NvcGUucHJvamVjdFt0eXBlXVtpZF0uYWN0aXZlID0gKCRyb290U2NvcGUucHJvamVjdFt0eXBlXVtpZF0uYWN0aXZlID09PSB0cnVlIHx8ICRyb290U2NvcGUucHJvamVjdFt0eXBlXVtpZF0uYWN0aXZlID09PSAndHJ1ZScpID8gZmFsc2UgOiB0cnVlO1xuXG4gICAgLy8gc2F2ZSB0aGUgZmlsZSBmb3IgY29udmVuaWVuY2VcbiAgICAkc2NvcGUuc2F2ZSgpO1xuICB9O1xuXG4gIC8vIFJlbW92ZSBhIGNvb2tpZS92aWV3L3NlbGVjdFxuICAkc2NvcGUuZGVsZXRlVHlwZUl0ZW0gPSBmdW5jdGlvbih0eXBlLCBpZCkge1xuICAgICRyb290U2NvcGUucHJvamVjdFt0eXBlXS5zcGxpY2UoaWQsIDEpO1xuXG4gICAgLy8gc2F2ZSB0aGUgZmlsZSBmb3IgY29udmVuaWVuY2VcbiAgICAkc2NvcGUuc2F2ZSgpO1xuICB9O1xuXG4gIC8vIFJlbW92ZXMgYWxsIGhpc3RvcnkgZGF0YVxuICAkc2NvcGUuY2xlYXJIaXN0b3J5ID0gZnVuY3Rpb24oKSB7XG4gICAgUHJvamVjdHMuY2xlYXJIaXN0b3J5KCRyb290U2NvcGUucHJvamVjdClcbiAgICAgIC50aGVuKGZ1bmN0aW9uKHJlcykge1xuICAgICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoJ0FMRVJUOkZJUkUnLCB7IHRpdGxlOiAnQ2xlYXJlZCBBbGwgSGlzdG9yeSEnLCBkdXI6IDUsIHR5cGU6ICdzdWNjZXNzJywgaWNvbjogJ2hpc3RvcnknIH0pO1xuICAgICAgfVxuXG4gICAgICAsIGZ1bmN0aW9uKGVycikge1xuICAgICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoJ0FMRVJUOkZJUkUnLCB7IHRpdGxlOiAnRXJyb3IgT2NjdXJyZWQhIFBsZWFzZSB0cnkgYWdhaW4uJywgZHVyOiA1LCB0eXBlOiAnZXJyb3InLCBpY29uOiAnc3RvcCcgfSk7XG4gICAgICB9KTtcbiAgfTtcblxufV0pO1xuIiwidmFyIGZzID0gcmVxdWlyZSgnZnMnKTtcblxuTVVHLmNvbnRyb2xsZXIoJ1NpZGVQYW5lbEN0cmwnLFxuWyckcm9vdFNjb3BlJywgJyRzY29wZScsICckc3RhdGUnLCAnUHJvamVjdHMnLFxuZnVuY3Rpb24oJHJvb3RTY29wZSwgJHNjb3BlLCAkc3RhdGUsIFByb2plY3RzKSB7XG4gICRzY29wZS5wcm9qZWN0cyA9IFtdO1xuXG4gIC8vIGdyYWIgYWxsIHByb2plY3RzIGxpc3RcbiAgJHNjb3BlLnByb2plY3RzID0gUHJvamVjdHMuZ2V0QWxsKCk7XG5cbiAgLy8gYWRkIG5ldyBwcm9qZWN0IHRvIHRoZSBwcm9qZWN0cyBsaXN0XG4gICRyb290U2NvcGUuJG9uKCdTSURFUEFORUw6TkVXUFJPSkVDVCcsIGZ1bmN0aW9uKGUsIGFyZ3MpIHtcbiAgICBpZiAoIWFyZ3MgfHwgIWFyZ3MuaWQpIHsgcmV0dXJuOyB9XG5cbiAgICAkc2NvcGUucHJvamVjdHMudW5zaGlmdChhcmdzKTtcbiAgfSk7XG5cbiAgLy8gdXBkYXRlIHRoZSBwcm9qZWN0cyBsaXN0XG4gICRyb290U2NvcGUuJG9uKCdTSURFUEFORUw6VVBEQVRFJywgZnVuY3Rpb24oZSwgYXJncykge1xuICAgIGlmICghYXJncyB8fCAhYXJncy5pZCkgeyByZXR1cm47IH1cblxuICAgICRzY29wZS5wcm9qZWN0cy5tYXAoZnVuY3Rpb24ob2JqLCBpZHgpIHtcbiAgICAgIGlmIChvYmouaWQgPT09IGFyZ3MuaWQpIHtcbiAgICAgICAgJHNjb3BlLnByb2plY3RzW2lkeF0udGl0bGUgPSBhcmdzLnRpdGxlO1xuICAgICAgICAkc2NvcGUucHJvamVjdHNbaWR4XS50aW1lc3RhbXAgPSBhcmdzLnRpbWVzdGFtcDtcblxuICAgICAgICBpZiAoYXJncy5iYXRjaEhpc3RvcnlbYXJncy5jdXJyZW50QmF0Y2hdKSB7XG4gICAgICAgICAgLy8gb25seSB1cGRhdGUgdG90YWxzIGlmIHdlIGhhdmUgdGhlbVxuICAgICAgICAgIGlmIChhcmdzLmJhdGNoSGlzdG9yeVthcmdzLmN1cnJlbnRCYXRjaF0uc3VjY2Vzcykge1xuICAgICAgICAgICAgJHNjb3BlLnByb2plY3RzW2lkeF0udG90YWxzLnN1Y2Nlc3MgPSBhcmdzLmJhdGNoSGlzdG9yeVthcmdzLmN1cnJlbnRCYXRjaF0uc3VjY2VzcztcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpZiAoYXJncy5iYXRjaEhpc3RvcnlbYXJncy5jdXJyZW50QmF0Y2hdLndhcm5pbmcpIHtcbiAgICAgICAgICAgICRzY29wZS5wcm9qZWN0c1tpZHhdLnRvdGFscy53YXJuaW5nID0gYXJncy5iYXRjaEhpc3RvcnlbYXJncy5jdXJyZW50QmF0Y2hdLndhcm5pbmc7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKGFyZ3MuYmF0Y2hIaXN0b3J5W2FyZ3MuY3VycmVudEJhdGNoXS5lcnJvcikge1xuICAgICAgICAgICAgJHNjb3BlLnByb2plY3RzW2lkeF0udG90YWxzLmVycm9yID0gYXJncy5iYXRjaEhpc3RvcnlbYXJncy5jdXJyZW50QmF0Y2hdLmVycm9yO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGlmIChhcmdzLmJhdGNoSGlzdG9yeVthcmdzLmN1cnJlbnRCYXRjaF0udmlld3MpIHtcbiAgICAgICAgICAgICRzY29wZS5wcm9qZWN0c1tpZHhdLnRvdGFscy52aWV3cyA9IGFyZ3MuYmF0Y2hIaXN0b3J5W2FyZ3MuY3VycmVudEJhdGNoXS52aWV3cztcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcbiAgfSk7XG5cbiAgLy8gdXBkYXRlIHRoZSBwcm9qZWN0cyBsaXN0XG4gICRyb290U2NvcGUuJG9uKCdTSURFUEFORUw6UkVNT1ZFJywgZnVuY3Rpb24oZSwgYXJncykge1xuICAgIGlmICghYXJncyB8fCAhYXJncy5pZCkgeyByZXR1cm47IH1cblxuICAgICRzY29wZS5wcm9qZWN0cy5tYXAoZnVuY3Rpb24ob2JqLCBpZHgpIHtcbiAgICAgIGlmIChvYmouaWQgPT09IGFyZ3MuaWQpIHtcbiAgICAgICAgJHNjb3BlLnByb2plY3RzLnNwbGljZShpZHgsIDEpO1xuICAgICAgfVxuICAgIH0pO1xuICB9KTtcblxuICAkc2NvcGUuZ29Ub1Byb2plY3QgPSBmdW5jdGlvbihpZCkge1xuICAgIC8vIFRPRE86IGZpeCB0aGlzXG4gICAgLy8gdmFyIHR5cGUgPSAnc2V0dGluZ3MnO1xuICAgIHZhciB0eXBlID0gJ3J1bm5lcic7XG5cbiAgICAvLyBUT0RPOiBzZXR1cCB0byBmaWd1cmUgb3V0IGlmIHdlIG5lZWQgdG8gZ28gdG8gc2V0dGluZ3MsIG90aGVyd2lzZSBnbyB0byBydW5uZXJcbiAgICAkc3RhdGUuZ28oJ3Byb2plY3RzLicgKyB0eXBlLCB7IGlkOiBpZCB9KTtcbiAgICAkcm9vdFNjb3BlLmN1cnJlbnRQcm9qZWN0SWQgPSBpZDtcbiAgfVxuXG59XSk7XG4iLCIvKipcbiAqIENvbmZpZ1xuICovXG5NVUcuY29uc3RhbnQoJ0NvbmZpZycsIHtcbiAgRU5WOiAnU1RBR0UnLFxuICBTVEFHRToge1xuICB9LFxuICBQUk9EOiB7XG4gIH0sXG4gIENvbXBhcmU6IHtcbiAgICBlcnJvckNvbG9yOiB7XG4gICAgICByZWQ6IDI1NSxcbiAgICAgIGdyZWVuOiAwLFxuICAgICAgYmx1ZTogMjU1XG4gICAgfSxcbiAgICBlcnJvclR5cGU6ICdmbGF0JyxcbiAgICB0cmFuc3BhcmVuY3k6IDEsXG4gICAgbGFyZ2VJbWFnZVRocmVzaG9sZDogMFxuICB9XG59KTtcbiIsIk1VRy5jb25maWcoXG5bJyRzdGF0ZVByb3ZpZGVyJywgJyR1cmxSb3V0ZXJQcm92aWRlcicsXG5mdW5jdGlvbigkc3RhdGVQcm92aWRlciwgJHVybFJvdXRlclByb3ZpZGVyKSB7XG5cbiAgLy8gUm91dGVzXG4gIC8vIC9cbiAgLy8gL3Byb2plY3RzXG4gIC8vIC9wcm9qZWN0cy86aWQvcnVubmVyXG4gIC8vIC9wcm9qZWN0cy86aWQvaGlzdG9yeVxuICAvLyAvcHJvamVjdHMvOmlkL3NldHRpbmdzXG5cbiAgJHN0YXRlUHJvdmlkZXJcblxuICAvKipcbiAgICogQmFzZSBSb3V0ZVxuICAgKi9cbiAgLnN0YXRlKCdtYWluJywge1xuICAgIHVybDogJy8nLFxuICAgIHRlbXBsYXRlVXJsOiAnbWFpbi5odG1sJ1xuICB9KVxuICAuc3RhdGUoJ3ByZWZlcmVuY2VzJywge1xuICAgIHVybDogJy9wcmVmZXJlbmNlcycsXG4gICAgdGVtcGxhdGVVcmw6ICdwcmVmZXJlbmNlcy5odG1sJyxcbiAgICBjb250cm9sbGVyOiAnUHJlZmVyZW5jZXNDdHJsJ1xuICB9KVxuXG4gIC8qKlxuICAgKiBQcm9qZWN0IFJvdXRlc1xuICAgKi9cbiAgLnN0YXRlKCdwcm9qZWN0cycsIHtcbiAgICB1cmw6ICcvcHJvamVjdHMvOmlkJyxcbiAgICB0ZW1wbGF0ZVVybDogJ3Byb2plY3RzLmh0bWwnLFxuICAgIGNvbnRyb2xsZXI6ICdQcm9qZWN0Q3RybCdcbiAgfSlcbiAgLnN0YXRlKCdwcm9qZWN0cy5zZXR0aW5ncycsIHtcbiAgICB1cmw6ICcvc2V0dGluZ3MnLFxuICAgIHRlbXBsYXRlVXJsOiAncHJvamVjdHMuc2V0dGluZ3MuaHRtbCcsXG4gICAgY29udHJvbGxlcjogJ1Byb2plY3RTZXR0aW5nc0N0cmwnXG4gIH0pXG4gIC5zdGF0ZSgncHJvamVjdHMucnVubmVyJywge1xuICAgIHVybDogJy9ydW5uZXInLFxuICAgIHRlbXBsYXRlVXJsOiAncHJvamVjdHMucnVubmVyLmh0bWwnLFxuICAgIGNvbnRyb2xsZXI6ICdQcm9qZWN0UnVubmVyQ3RybCdcbiAgfSlcbiAgLnN0YXRlKCdwcm9qZWN0cy5oaXN0b3J5Jywge1xuICAgIHVybDogJy9oaXN0b3J5JyxcbiAgICB0ZW1wbGF0ZVVybDogJ3Byb2plY3RzLmhpc3RvcnkuaHRtbCcsXG4gICAgY29udHJvbGxlcjogJ1Byb2plY3RIaXN0b3J5Q3RybCdcbiAgfSlcblxuICAvKipcbiAgICogU3RhdGljIFJvdXRlc1xuICAgKi9cblxuICAvLyAuc3RhdGUoJ21haW4uNDA0Jywge1xuICAvLyAgICAgdXJsOiBcIi80MDRcIixcbiAgLy8gICAgIHRlbXBsYXRlVXJsOiBcInRlbXBsYXRlcy80MDQuaHRtbFwiLFxuICAvLyAgICAgaXNFeHRlcm5hbDogdHJ1ZVxuICAvLyB9KVxuXG4gIC8vIEVuZCBvZiB0aGUgd29ybGRcbiAgO1xuXG4gIC8vIHVybCByZS1yb3V0aW5nXG4gIC8vICR1cmxSb3V0ZXJQcm92aWRlclxuICAvLyAgIC53aGVuKCcvcHJvamVjdHMnLCAnLycpXG4gIC8vICAgLndoZW4oJy9wcm9qZWN0cy8nLCAnLycpO1xuXG4gIC8vIGlmIG5vbmUgb2YgdGhlIGFib3ZlIHN0YXRlcyBhcmUgbWF0Y2hlZCwgdXNlIHRoaXMgYXMgdGhlIGZhbGxiYWNrXG4gICR1cmxSb3V0ZXJQcm92aWRlci5vdGhlcndpc2UoJy8nKTtcblxufV0pO1xuIiwiTVVHLnJ1bihbJyRyb290U2NvcGUnLCAnJGh0dHAnLFxuZnVuY3Rpb24oJHJvb3RTY29wZSwgJGh0dHApIHtcblxuICAvLyBoZWFkZXJzXG4gIHZhciAkY29tbW9uID0gJGh0dHAuZGVmYXVsdHMuaGVhZGVycy5jb21tb247XG4gICRjb21tb25bJ0NvbnRlbnQtVHlwZSddID0gJ2FwcGxpY2F0aW9uL2pzb24nO1xuXG4gICRyb290U2NvcGUuJG9uKCckc3RhdGVDaGFuZ2VFcnJvcicsIGZ1bmN0aW9uKGV2ZW50LCB0b1N0YXRlLCB0b1BhcmFtcywgZnJvbVN0YXRlLCBmcm9tUGFyYW1zLCBlcnJvcikge1xuICAgIGNvbnNvbGUubG9nKCckc3RhdGVDaGFuZ2VFcnJvcicsIGVycm9yKTtcbiAgfSk7XG5cbn1dKTtcbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==